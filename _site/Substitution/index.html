<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Substitution in the untyped lambda calculus | Programming Language Foundations in Agda
</title><!-- Begin Jekyll SEO tag v2.5.0 -->
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Substitution in the untyped lambda calculus" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Programming Language Foundations in Agda" />
<meta property="og:description" content="Programming Language Foundations in Agda" />
<link rel="canonical" href="https://plfa.github.io/Substitution/" />
<meta property="og:url" content="https://plfa.github.io/Substitution/" />
<meta property="og:site_name" content="Programming Language Foundations in Agda" />
<script type="application/ld+json">
{"description":"Programming Language Foundations in Agda","@type":"WebPage","headline":"Substitution in the untyped lambda calculus","url":"https://plfa.github.io/Substitution/","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"></head>
<body><header class="site-header" role="banner">

    <div class="wrapper">

        <a class="site-title" href="/">Programming Language Foundations in Agda
</a>

        <nav class="site-nav">
            <span class="menu-icon">
                <svg viewBox="0 0 18 15" width="18px" height="15px">
                    <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
                    <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
                    <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
                </svg>
            </span>

            <div class="trigger">
                <a class="page-link" href="/">The Book</a>
                <!--!>
                <a class="page-link" href="/Announcements/">Announcements</a>
                <---->
                <a class="page-link" href="/GettingStarted/">Getting Started</a>
                <a class="page-link" href="/Citing/">Citing</a>
                <a class="page-link" href="https://agda-zh.github.io/PLFA-zh/">中文</a>
            </div>
        </nav>

    </div>

</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
      <h1 class="post-title">Substitution in the untyped lambda calculus</h1>
  </header>

  <p style="text-align:center;">
    
    <a alt="Previous chapter" href="/Untyped/">Prev</a>
    &bullet;
    
    
    <a alt="Source code" href="https://github.com/plfa/plfa.github.io/blob/dev/src/plfa/Substitution.lagda">Source</a>
    
    
    &bullet;
    <a alt="Next chapter" href="/LambdaReduction/">Next</a>
    
</p>


  <div class="post-content">
    <pre class="Agda"><a id="178" class="Keyword">module</a> <a id="185" href="/Substitution/" class="Module">plfa.Substitution</a> <a id="203" class="Keyword">where</a></pre>

<h2 id="introduction">Introduction</h2>

<p>The primary purpose of this chapter is to prove that substitution
commutes with itself. Barendgredt (1984) refers to this
as the substitution lemma:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>M [x:=N] [y:=L] = M [y:=L] [x:= N[y:=L] ]
</code></pre></div></div>

<p>In our setting, with de Bruijn indices for variables, the statement of
the lemma becomes:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>M [ N ] [ L ] ≡  M〔 L 〕[ N [ L ] ]                     (substitution)
</code></pre></div></div>

<p>where the notation <code class="highlighter-rouge">M 〔 L 〕</code> is for substituting L for index 1 inside
M.  In addition, because we define substitution in terms of parallel
substitution, we have the following generalization, replacing the
substitution of L with an arbitrary parallel substitution σ.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>subst σ (M [ N ]) ≡ (subst (exts σ) M) [ subst σ N ]    (subst-commute)
</code></pre></div></div>

<p>The special case for renamings is also useful.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ (M [ N ]) ≡ (rename (ext ρ) M) [ rename ρ N ]
                                                 (rename-subst-commute)
</code></pre></div></div>

<p>The secondary purpose of this chapter is to define the σ algebra of
parallel substitution due to Abadi, Cardelli, Curien, and Levy
(1991). The equations of this algebra not only help us prove the
substitution lemma, but they are generally useful. Furthermore, when
the equations are applied from left to right, they form a rewrite
system that <em>decides</em> whether any two substitutions are equal.</p>

<h2 id="imports">Imports</h2>

<pre class="Agda"><a id="1549" class="Keyword">open</a> <a id="1554" class="Keyword">import</a> <a id="1561" href="/Untyped/" class="Module">plfa.Untyped</a>
  <a id="1576" class="Keyword">using</a> <a id="1582" class="Symbol">(</a><a id="1583" href="/Untyped/#2675" class="Datatype">Type</a><a id="1587" class="Symbol">;</a> <a id="1589" href="/Untyped/#2980" class="Datatype">Context</a><a id="1596" class="Symbol">;</a> <a id="1598" href="/Untyped/#4150" class="Datatype Operator">_⊢_</a><a id="1601" class="Symbol">;</a> <a id="1603" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="1604" class="Symbol">;</a> <a id="1606" href="/Untyped/#3365" class="Datatype Operator">_∋_</a><a id="1609" class="Symbol">;</a> <a id="1611" href="/Untyped/#3002" class="InductiveConstructor">∅</a><a id="1612" class="Symbol">;</a> <a id="1614" href="/Untyped/#3018" class="InductiveConstructor Operator">_,_</a><a id="1617" class="Symbol">;</a> <a id="1619" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="1620" class="Symbol">;</a> <a id="1622" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="1624" class="Symbol">;</a> <a id="1626" href="/Untyped/#4186" class="InductiveConstructor Operator">`_</a><a id="1628" class="Symbol">;</a> <a id="1630" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a><a id="1632" class="Symbol">;</a> <a id="1634" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a><a id="1637" class="Symbol">;</a>
         <a id="1648" href="/Untyped/#6171" class="Function">rename</a><a id="1654" class="Symbol">;</a> <a id="1656" href="/Untyped/#6931" class="Function">subst</a><a id="1661" class="Symbol">;</a> <a id="1663" href="/Untyped/#5845" class="Function">ext</a><a id="1666" class="Symbol">;</a> <a id="1668" href="/Untyped/#6623" class="Function">exts</a><a id="1672" class="Symbol">;</a> <a id="1674" href="/Untyped/#7475" class="Function Operator">_[_]</a><a id="1678" class="Symbol">;</a> <a id="1680" href="/Untyped/#7359" class="Function">subst-zero</a><a id="1690" class="Symbol">)</a>
<a id="1692" class="Keyword">import</a> <a id="1699" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1737" class="Symbol">as</a> <a id="1740" class="Module">Eq</a>
<a id="1743" class="Keyword">open</a> <a id="1748" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="1751" class="Keyword">using</a> <a id="1757" class="Symbol">(</a><a id="1758" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a><a id="1761" class="Symbol">;</a> <a id="1763" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="1767" class="Symbol">;</a> <a id="1769" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a><a id="1772" class="Symbol">;</a> <a id="1774" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a><a id="1778" class="Symbol">;</a> <a id="1780" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a><a id="1785" class="Symbol">;</a> <a id="1787" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a><a id="1795" class="Symbol">)</a>
<a id="1797" class="Keyword">open</a> <a id="1802" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#3975" class="Module">Eq.≡-Reasoning</a> <a id="1817" class="Keyword">using</a> <a id="1823" class="Symbol">(</a><a id="1824" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin_</a><a id="1830" class="Symbol">;</a> <a id="1832" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">_≡⟨⟩_</a><a id="1837" class="Symbol">;</a> <a id="1839" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">_≡⟨_⟩_</a><a id="1845" class="Symbol">;</a> <a id="1847" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">_∎</a><a id="1849" class="Symbol">)</a>
<a id="1851" class="Keyword">open</a> <a id="1856" class="Keyword">import</a> <a id="1863" href="https://agda.github.io/agda-stdlib/v0.17/Function.html" class="Module">Function</a> <a id="1872" class="Keyword">using</a> <a id="1878" class="Symbol">(</a><a id="1879" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">_∘_</a><a id="1882" class="Symbol">)</a>
<a id="1884" class="Comment">-- open import plfa.Isomorphism using (extensionality)  -- causes a bug!</a></pre>

<pre class="Agda"><a id="1982" class="Keyword">postulate</a>
  <a id="extensionality"></a><a id="1994" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="2009" class="Symbol">:</a> <a id="2011" class="Symbol">∀</a> <a id="2013" class="Symbol">{</a><a id="2014" href="/Substitution/#2014" class="Bound">A</a> <a id="2016" href="/Substitution/#2016" class="Bound">B</a> <a id="2018" class="Symbol">:</a> <a id="2020" class="PrimitiveType">Set</a><a id="2023" class="Symbol">}</a> <a id="2025" class="Symbol">{</a><a id="2026" href="/Substitution/#2026" class="Bound">f</a> <a id="2028" href="/Substitution/#2028" class="Bound">g</a> <a id="2030" class="Symbol">:</a> <a id="2032" href="/Substitution/#2014" class="Bound">A</a> <a id="2034" class="Symbol">→</a> <a id="2036" href="/Substitution/#2016" class="Bound">B</a><a id="2037" class="Symbol">}</a>
    <a id="2043" class="Symbol">→</a> <a id="2045" class="Symbol">(∀</a> <a id="2048" class="Symbol">(</a><a id="2049" href="/Substitution/#2049" class="Bound">x</a> <a id="2051" class="Symbol">:</a> <a id="2053" href="/Substitution/#2014" class="Bound">A</a><a id="2054" class="Symbol">)</a> <a id="2056" class="Symbol">→</a> <a id="2058" href="/Substitution/#2026" class="Bound">f</a> <a id="2060" href="/Substitution/#2049" class="Bound">x</a> <a id="2062" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="2064" href="/Substitution/#2028" class="Bound">g</a> <a id="2066" href="/Substitution/#2049" class="Bound">x</a><a id="2067" class="Symbol">)</a>
      <a id="2075" class="Comment">-----------------------</a>
    <a id="2103" class="Symbol">→</a> <a id="2105" href="/Substitution/#2026" class="Bound">f</a> <a id="2107" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="2109" href="/Substitution/#2028" class="Bound">g</a></pre>

<h2 id="notation">Notation</h2>

<p>We introduce the following shorthand for the type of a <em>renaming</em> from
variables in context <code class="highlighter-rouge">Γ</code> to variables in context <code class="highlighter-rouge">Δ</code>.</p>

<pre class="Agda"><a id="Rename"></a><a id="2275" href="/Substitution/#2275" class="Function">Rename</a> <a id="2282" class="Symbol">:</a> <a id="2284" href="/Untyped/#2980" class="Datatype">Context</a> <a id="2292" class="Symbol">→</a> <a id="2294" href="/Untyped/#2980" class="Datatype">Context</a> <a id="2302" class="Symbol">→</a> <a id="2304" class="PrimitiveType">Set</a>
<a id="2308" href="/Substitution/#2275" class="Function">Rename</a> <a id="2315" href="/Substitution/#2315" class="Bound">Γ</a> <a id="2317" href="/Substitution/#2317" class="Bound">Δ</a> <a id="2319" class="Symbol">=</a> <a id="2321" class="Symbol">∀{</a><a id="2323" href="/Substitution/#2323" class="Bound">A</a><a id="2324" class="Symbol">}</a> <a id="2326" class="Symbol">→</a> <a id="2328" href="/Substitution/#2315" class="Bound">Γ</a> <a id="2330" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="2332" href="/Substitution/#2323" class="Bound">A</a> <a id="2334" class="Symbol">→</a> <a id="2336" href="/Substitution/#2317" class="Bound">Δ</a> <a id="2338" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="2340" href="/Substitution/#2323" class="Bound">A</a></pre>

<p>Similarly, we introduce the following shorthand for the type of a
<em>substitution</em> from variables in context <code class="highlighter-rouge">Γ</code> to terms in context <code class="highlighter-rouge">Δ</code>.</p>

<pre class="Agda"><a id="Subst"></a><a id="2504" href="/Substitution/#2504" class="Function">Subst</a> <a id="2510" class="Symbol">:</a> <a id="2512" href="/Untyped/#2980" class="Datatype">Context</a> <a id="2520" class="Symbol">→</a> <a id="2522" href="/Untyped/#2980" class="Datatype">Context</a> <a id="2530" class="Symbol">→</a> <a id="2532" class="PrimitiveType">Set</a>
<a id="2536" href="/Substitution/#2504" class="Function">Subst</a> <a id="2542" href="/Substitution/#2542" class="Bound">Γ</a> <a id="2544" href="/Substitution/#2544" class="Bound">Δ</a> <a id="2546" class="Symbol">=</a> <a id="2548" class="Symbol">∀{</a><a id="2550" href="/Substitution/#2550" class="Bound">A</a><a id="2551" class="Symbol">}</a> <a id="2553" class="Symbol">→</a> <a id="2555" href="/Substitution/#2542" class="Bound">Γ</a> <a id="2557" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="2559" href="/Substitution/#2550" class="Bound">A</a> <a id="2561" class="Symbol">→</a> <a id="2563" href="/Substitution/#2544" class="Bound">Δ</a> <a id="2565" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="2567" href="/Substitution/#2550" class="Bound">A</a></pre>

<p>We use the following more succinct notation the <code class="highlighter-rouge">subst</code> function.</p>

<pre class="Agda"><a id="⟪_⟫"></a><a id="2661" href="/Substitution/#2661" class="Function Operator">⟪_⟫</a> <a id="2665" class="Symbol">:</a> <a id="2667" class="Symbol">∀{</a><a id="2669" href="/Substitution/#2669" class="Bound">Γ</a> <a id="2671" href="/Substitution/#2671" class="Bound">Δ</a> <a id="2673" href="/Substitution/#2673" class="Bound">A</a><a id="2674" class="Symbol">}</a> <a id="2676" class="Symbol">→</a> <a id="2678" href="/Substitution/#2504" class="Function">Subst</a> <a id="2684" href="/Substitution/#2669" class="Bound">Γ</a> <a id="2686" href="/Substitution/#2671" class="Bound">Δ</a> <a id="2688" class="Symbol">→</a> <a id="2690" href="/Substitution/#2669" class="Bound">Γ</a> <a id="2692" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="2694" href="/Substitution/#2673" class="Bound">A</a> <a id="2696" class="Symbol">→</a> <a id="2698" href="/Substitution/#2671" class="Bound">Δ</a> <a id="2700" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="2702" href="/Substitution/#2673" class="Bound">A</a>
<a id="2704" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="2706" href="/Substitution/#2706" class="Bound">σ</a> <a id="2708" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="2710" class="Symbol">=</a> <a id="2712" class="Symbol">λ</a> <a id="2714" href="/Substitution/#2714" class="Bound">M</a> <a id="2716" class="Symbol">→</a> <a id="2718" href="/Untyped/#6931" class="Function">subst</a> <a id="2724" href="/Substitution/#2706" class="Bound">σ</a> <a id="2726" href="/Substitution/#2714" class="Bound">M</a></pre>

<h2 id="the-σ-algebra-of-substitution">The σ algebra of substitution</h2>

<p>Substitutions map de Bruijn indices (natural numbers) to terms, so we
can view a substitution simply as a sequence of terms, or more
precisely, as an infinite sequence of terms. The σ algebra consists of
four operations for building such sequences: identity <code class="highlighter-rouge">ids</code>, shift
<code class="highlighter-rouge">↑</code>, cons <code class="highlighter-rouge">M • σ</code>, and sequencing <code class="highlighter-rouge">σ ⨟ τ</code>.  The sequence <code class="highlighter-rouge">0, 1, 2, ...</code>
is constructed by the identity substitution.</p>

<pre class="Agda"><a id="ids"></a><a id="3177" href="/Substitution/#3177" class="Function">ids</a> <a id="3181" class="Symbol">:</a> <a id="3183" class="Symbol">∀{</a><a id="3185" href="/Substitution/#3185" class="Bound">Γ</a><a id="3186" class="Symbol">}</a> <a id="3188" class="Symbol">→</a> <a id="3190" href="/Substitution/#2504" class="Function">Subst</a> <a id="3196" href="/Substitution/#3185" class="Bound">Γ</a> <a id="3198" href="/Substitution/#3185" class="Bound">Γ</a>
<a id="3200" href="/Substitution/#3177" class="Function">ids</a> <a id="3204" href="/Substitution/#3204" class="Bound">x</a> <a id="3206" class="Symbol">=</a> <a id="3208" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="3210" href="/Substitution/#3204" class="Bound">x</a></pre>

<p>The shift operation <code class="highlighter-rouge">↑</code> constructs the sequence</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1, 2, 3, ...
</code></pre></div></div>

<p>and is defined as follows.</p>

<pre class="Agda"><a id="↑"></a><a id="3332" href="/Substitution/#3332" class="Function">↑</a> <a id="3334" class="Symbol">:</a> <a id="3336" class="Symbol">∀{</a><a id="3338" href="/Substitution/#3338" class="Bound">Γ</a> <a id="3340" href="/Substitution/#3340" class="Bound">A</a><a id="3341" class="Symbol">}</a> <a id="3343" class="Symbol">→</a> <a id="3345" href="/Substitution/#2504" class="Function">Subst</a> <a id="3351" href="/Substitution/#3338" class="Bound">Γ</a> <a id="3353" class="Symbol">(</a><a id="3354" href="/Substitution/#3338" class="Bound">Γ</a> <a id="3356" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="3358" href="/Substitution/#3340" class="Bound">A</a><a id="3359" class="Symbol">)</a>
<a id="3361" href="/Substitution/#3332" class="Function">↑</a> <a id="3363" href="/Substitution/#3363" class="Bound">x</a> <a id="3365" class="Symbol">=</a> <a id="3367" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="3369" class="Symbol">(</a><a id="3370" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="3372" href="/Substitution/#3363" class="Bound">x</a><a id="3373" class="Symbol">)</a></pre>

<p>Given a term <code class="highlighter-rouge">M</code> and substitution <code class="highlighter-rouge">σ</code>, the operation
<code class="highlighter-rouge">M • σ</code> constructs the sequence</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>M , σ 0, σ 1, σ 2, ...
</code></pre></div></div>

<p>This operation is analogous to the <code class="highlighter-rouge">cons</code> operation of Lisp.</p>

<pre class="Agda"><a id="3576" class="Keyword">infixr</a> <a id="3583" class="Number">6</a> <a id="3585" href="/Substitution/#3590" class="Function Operator">_•_</a>

<a id="_•_"></a><a id="3590" href="/Substitution/#3590" class="Function Operator">_•_</a> <a id="3594" class="Symbol">:</a> <a id="3596" class="Symbol">∀{</a><a id="3598" href="/Substitution/#3598" class="Bound">Γ</a> <a id="3600" href="/Substitution/#3600" class="Bound">Δ</a> <a id="3602" href="/Substitution/#3602" class="Bound">A</a><a id="3603" class="Symbol">}</a> <a id="3605" class="Symbol">→</a> <a id="3607" class="Symbol">(</a><a id="3608" href="/Substitution/#3600" class="Bound">Δ</a> <a id="3610" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="3612" href="/Substitution/#3602" class="Bound">A</a><a id="3613" class="Symbol">)</a> <a id="3615" class="Symbol">→</a> <a id="3617" href="/Substitution/#2504" class="Function">Subst</a> <a id="3623" href="/Substitution/#3598" class="Bound">Γ</a> <a id="3625" href="/Substitution/#3600" class="Bound">Δ</a> <a id="3627" class="Symbol">→</a> <a id="3629" href="/Substitution/#2504" class="Function">Subst</a> <a id="3635" class="Symbol">(</a><a id="3636" href="/Substitution/#3598" class="Bound">Γ</a> <a id="3638" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="3640" href="/Substitution/#3602" class="Bound">A</a><a id="3641" class="Symbol">)</a> <a id="3643" href="/Substitution/#3600" class="Bound">Δ</a>
<a id="3645" class="Symbol">(</a><a id="3646" href="/Substitution/#3646" class="Bound">M</a> <a id="3648" href="/Substitution/#3590" class="Function Operator">•</a> <a id="3650" href="/Substitution/#3650" class="Bound">σ</a><a id="3651" class="Symbol">)</a> <a id="3653" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="3655" class="Symbol">=</a> <a id="3657" href="/Substitution/#3646" class="Bound">M</a>
<a id="3659" class="Symbol">(</a><a id="3660" href="/Substitution/#3660" class="Bound">M</a> <a id="3662" href="/Substitution/#3590" class="Function Operator">•</a> <a id="3664" href="/Substitution/#3664" class="Bound">σ</a><a id="3665" class="Symbol">)</a> <a id="3667" class="Symbol">(</a><a id="3668" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="3670" href="/Substitution/#3670" class="Bound">x</a><a id="3671" class="Symbol">)</a> <a id="3673" class="Symbol">=</a> <a id="3675" href="/Substitution/#3664" class="Bound">σ</a> <a id="3677" href="/Substitution/#3670" class="Bound">x</a></pre>

<p>Given two substitutions <code class="highlighter-rouge">σ</code> and <code class="highlighter-rouge">τ</code>, the sequencing operation <code class="highlighter-rouge">σ ⨟ τ</code>
produces the sequence</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪τ⟫(σ 0), ⟪τ⟫(σ 1), ⟪τ⟫(σ 2), ...
</code></pre></div></div>

<p>That is, it composes the two substitutions by first applying
<code class="highlighter-rouge">σ</code> and then applying <code class="highlighter-rouge">τ</code>.</p>

<pre class="Agda"><a id="3925" class="Keyword">infixr</a> <a id="3932" class="Number">5</a> <a id="3934" href="/Substitution/#3939" class="Function Operator">_⨟_</a>

<a id="_⨟_"></a><a id="3939" href="/Substitution/#3939" class="Function Operator">_⨟_</a> <a id="3943" class="Symbol">:</a> <a id="3945" class="Symbol">∀{</a><a id="3947" href="/Substitution/#3947" class="Bound">Γ</a> <a id="3949" href="/Substitution/#3949" class="Bound">Δ</a> <a id="3951" href="/Substitution/#3951" class="Bound">Σ</a><a id="3952" class="Symbol">}</a> <a id="3954" class="Symbol">→</a> <a id="3956" href="/Substitution/#2504" class="Function">Subst</a> <a id="3962" href="/Substitution/#3947" class="Bound">Γ</a> <a id="3964" href="/Substitution/#3949" class="Bound">Δ</a> <a id="3966" class="Symbol">→</a> <a id="3968" href="/Substitution/#2504" class="Function">Subst</a> <a id="3974" href="/Substitution/#3949" class="Bound">Δ</a> <a id="3976" href="/Substitution/#3951" class="Bound">Σ</a> <a id="3978" class="Symbol">→</a> <a id="3980" href="/Substitution/#2504" class="Function">Subst</a> <a id="3986" href="/Substitution/#3947" class="Bound">Γ</a> <a id="3988" href="/Substitution/#3951" class="Bound">Σ</a>
<a id="3990" href="/Substitution/#3990" class="Bound">σ</a> <a id="3992" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="3994" href="/Substitution/#3994" class="Bound">τ</a> <a id="3996" class="Symbol">=</a> <a id="3998" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="4000" href="/Substitution/#3994" class="Bound">τ</a> <a id="4002" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="4004" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="4006" href="/Substitution/#3990" class="Bound">σ</a></pre>

<p>For the sequencing operation, Abadi et al. use the notation of
function composition, writing <code class="highlighter-rouge">σ ∘ τ</code>, but still with <code class="highlighter-rouge">σ</code> applied
before <code class="highlighter-rouge">τ</code>, which is the opposite of standard mathematical
practice. We instead write <code class="highlighter-rouge">σ ⨟ τ</code>, because semicolon is
the standard notation for forward function composition.</p>

<h2 id="the-σ-algebra-equations">The σ algebra equations</h2>

<p>The σ algebra includes the following equations.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(sub-head)  ⟪ M • σ ⟫ (` Z) ≡ M
(sub-tail)  ↑ ⨟ (M • σ)    ≡ σ
(sub-η)     (⟪ σ ⟫ (` Z)) • (↑ ⨟ σ) ≡ σ
(Z-shift)   (` Z) • ↑      ≡ ids

(sub-id)    ⟪ ids ⟫ M      ≡ M
(sub-app)   ⟪ σ ⟫ (L · M)  ≡ (⟪ σ ⟫ L) · (⟪ σ ⟫ M)
(sub-abs)   ⟪ σ ⟫ (ƛ N)    ≡ ƛ ⟪ σ ⟫ N
(sub-sub)   ⟪ τ ⟫ ⟪ σ ⟫ M  ≡ ⟪ σ ⨟ τ ⟫ M

(sub-idL)   ids ⨟ σ        ≡ σ
(sub-idR)   σ ⨟ ids        ≡ σ
(sub-assoc) (σ ⨟ τ) ⨟ θ    ≡ σ ⨟ (τ ⨟ θ)
(sub-dist)  (M • σ) ⨟ τ    ≡ (⟪ τ ⟫ M) • (σ ⨟ τ)
</code></pre></div></div>

<p>The first group of equations describe how the <code class="highlighter-rouge">•</code> operator acts like cons.
The equation <code class="highlighter-rouge">sub-head</code> says that the variable zero <code class="highlighter-rouge">Z</code> returns the
head of the sequence (it acts like the <code class="highlighter-rouge">car</code> of Lisp).  Similarly,
<code class="highlighter-rouge">sub-tail</code> says that sequencing with shift <code class="highlighter-rouge">↑</code> returns the tail of the
sequence (it acts like <code class="highlighter-rouge">cdr</code> of Lisp).  The <code class="highlighter-rouge">sub-η</code> equation is the
η-expansion rule for sequences, saying that taking the head and tail
of a sequence, and then cons’ing them together yields the original
sequence. The <code class="highlighter-rouge">Z-shift</code> equation says that cons’ing zero onto the
shifted sequence produces the identity sequence.</p>

<p>The next four equations involve applying substitutions to terms.  The
equation <code class="highlighter-rouge">sub-id</code> says that the identity substitution returns the term
unchanged. The equations <code class="highlighter-rouge">sub-app</code> and <code class="highlighter-rouge">sub-abs</code> says that
substitution is a congruence for the lambda calculus. The <code class="highlighter-rouge">sub-sub</code>
equation says that the sequence operator <code class="highlighter-rouge">⨟</code> behaves as intended.</p>

<p>The last four equations concern the sequencing of substitutions.
The first two equations, <code class="highlighter-rouge">sub-idL</code> and <code class="highlighter-rouge">sub-idR</code>, say that
<code class="highlighter-rouge">ids</code> is the left and right unit of the sequencing operator.
The <code class="highlighter-rouge">sub-assoc</code> equation says that sequencing is associative.
Finally, <code class="highlighter-rouge">sub-dist</code> says that post-sequencing distributes through cons.</p>

<h2 id="relating-the-σ-algebra-and-substitution-functions">Relating the σ algebra and substitution functions</h2>

<p>The definitions of substitution <code class="highlighter-rouge">N [ M ]</code> and parallel substitution
<code class="highlighter-rouge">subst σ N</code> depend on several auxiliary functions: <code class="highlighter-rouge">rename</code>, <code class="highlighter-rouge">exts</code>,
<code class="highlighter-rouge">ext</code>, and <code class="highlighter-rouge">subst-zero</code>. We shall relate those functions to terms in
the σ algebra.</p>

<p>To begin with, renaming can be expressed in terms of substitution.
We have</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ M ≡ ⟪ ren ρ ⟫ M               (rename-subst-ren)
</code></pre></div></div>

<p>where <code class="highlighter-rouge">ren</code> turns a renaming <code class="highlighter-rouge">ρ</code> into a substitution by post-composing
<code class="highlighter-rouge">ρ</code> with the identity substitution.</p>

<pre class="Agda"><a id="ren"></a><a id="6693" href="/Substitution/#6693" class="Function">ren</a> <a id="6697" class="Symbol">:</a> <a id="6699" class="Symbol">∀{</a><a id="6701" href="/Substitution/#6701" class="Bound">Γ</a> <a id="6703" href="/Substitution/#6703" class="Bound">Δ</a><a id="6704" class="Symbol">}</a> <a id="6706" class="Symbol">→</a> <a id="6708" href="/Substitution/#2275" class="Function">Rename</a> <a id="6715" href="/Substitution/#6701" class="Bound">Γ</a> <a id="6717" href="/Substitution/#6703" class="Bound">Δ</a> <a id="6719" class="Symbol">→</a> <a id="6721" href="/Substitution/#2504" class="Function">Subst</a> <a id="6727" href="/Substitution/#6701" class="Bound">Γ</a> <a id="6729" href="/Substitution/#6703" class="Bound">Δ</a>
<a id="6731" href="/Substitution/#6693" class="Function">ren</a> <a id="6735" href="/Substitution/#6735" class="Bound">ρ</a> <a id="6737" class="Symbol">=</a> <a id="6739" href="/Substitution/#3177" class="Function">ids</a> <a id="6743" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="6745" href="/Substitution/#6735" class="Bound">ρ</a></pre>

<p>When the renaming is the increment function, then it is equivalent to
shift.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ren S_ ≡ ↑                             (ren-shift)

rename S_ M ≡ ⟪ ↑ ⟫ M                  (rename-shift)
</code></pre></div></div>

<p>Renaming with the identity renaming leaves the term unchanged.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename (λ {A} x → x) M ≡ M             (rename-id)
</code></pre></div></div>

<p>Next we relate the <code class="highlighter-rouge">exts</code> function to the σ algebra.  Recall that the
<code class="highlighter-rouge">exts</code> function extends a substitution as follows:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts σ = ` Z, rename S_ (σ 0), rename S_ (σ 1), rename S_ (σ 2), ...
</code></pre></div></div>

<p>So <code class="highlighter-rouge">exts</code> is equivalent to cons’ing Z onto the sequence formed
by applying <code class="highlighter-rouge">σ</code> and then shifting.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts σ ≡ ` Z • (σ ⨟ ↑)                (exts-cons-shift)
</code></pre></div></div>

<p>The <code class="highlighter-rouge">ext</code> function does the same job as <code class="highlighter-rouge">exts</code> but for renamings
instead of substitutions. So composing <code class="highlighter-rouge">ext</code> with <code class="highlighter-rouge">ren</code> is the same as
composing <code class="highlighter-rouge">ren</code> with <code class="highlighter-rouge">exts</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ren (ext ρ) ≡ exts (ren ρ)            (ren-ext)
</code></pre></div></div>

<p>Thus, we can recast the <code class="highlighter-rouge">exts-cons-shift</code> equation in terms of
renamings.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ren (ext ρ) ≡ ` Z • (ren ρ ⨟ ↑)       (ext-cons-Z-shift)
</code></pre></div></div>

<p>It is also useful to specialize the <code class="highlighter-rouge">sub-sub</code> equation of the σ
algebra to the situation where the first substitution is a renaming.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪ σ ⟫ (rename ρ M) ≡ ⟪ σ ∘ ρ ⟫ M       (rename-subst)
</code></pre></div></div>

<p>The <code class="highlighter-rouge">subst-zero M</code> substitution is equivalent to cons’ing
<code class="highlighter-rouge">M</code> onto the identity substitution.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>subst-zero M ≡ M • ids                (subst-Z-cons-ids)
</code></pre></div></div>

<p>Finally, sequencing <code class="highlighter-rouge">exts σ</code> with <code class="highlighter-rouge">subst-zero M</code> is equivalent to
cons’ing <code class="highlighter-rouge">M</code> onto <code class="highlighter-rouge">σ</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts σ ⨟ subst-zero M ≡ (M • σ)       (subst-zero-exts-cons)
</code></pre></div></div>

<h2 id="proofs-of-sub-head-sub-tail-sub-η-z-shift-sub-idl-sub-dist-and-sub-app">Proofs of sub-head, sub-tail, sub-η, Z-shift, sub-idL, sub-dist, and sub-app</h2>

<p>We start with the proofs that are immediate from the definitions of
the operators.</p>

<pre class="Agda"><a id="sub-head"></a><a id="8470" href="/Substitution/#8470" class="Function">sub-head</a> <a id="8479" class="Symbol">:</a> <a id="8481" class="Symbol">∀</a> <a id="8483" class="Symbol">{</a><a id="8484" href="/Substitution/#8484" class="Bound">Γ</a> <a id="8486" href="/Substitution/#8486" class="Bound">Δ</a><a id="8487" class="Symbol">}</a> <a id="8489" class="Symbol">{</a><a id="8490" href="/Substitution/#8490" class="Bound">A</a><a id="8491" class="Symbol">}</a> <a id="8493" class="Symbol">{</a><a id="8494" href="/Substitution/#8494" class="Bound">M</a> <a id="8496" class="Symbol">:</a> <a id="8498" href="/Substitution/#8486" class="Bound">Δ</a> <a id="8500" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="8502" href="/Substitution/#8490" class="Bound">A</a><a id="8503" class="Symbol">}{</a><a id="8505" href="/Substitution/#8505" class="Bound">σ</a> <a id="8507" class="Symbol">:</a> <a id="8509" href="/Substitution/#2504" class="Function">Subst</a> <a id="8515" href="/Substitution/#8484" class="Bound">Γ</a> <a id="8517" href="/Substitution/#8486" class="Bound">Δ</a><a id="8518" class="Symbol">}</a>
         <a id="8529" class="Symbol">→</a> <a id="8531" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="8533" href="/Substitution/#8494" class="Bound">M</a> <a id="8535" href="/Substitution/#3590" class="Function Operator">•</a> <a id="8537" href="/Substitution/#8505" class="Bound">σ</a> <a id="8539" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="8541" class="Symbol">(</a><a id="8542" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="8544" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8545" class="Symbol">)</a> <a id="8547" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8549" href="/Substitution/#8494" class="Bound">M</a>
<a id="8551" href="/Substitution/#8470" class="Function">sub-head</a> <a id="8560" class="Symbol">=</a> <a id="8562" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-tail"></a><a id="8592" href="/Substitution/#8592" class="Function">sub-tail</a> <a id="8601" class="Symbol">:</a> <a id="8603" class="Symbol">∀{</a><a id="8605" href="/Substitution/#8605" class="Bound">Γ</a> <a id="8607" href="/Substitution/#8607" class="Bound">Δ</a><a id="8608" class="Symbol">}</a> <a id="8610" class="Symbol">{</a><a id="8611" href="/Substitution/#8611" class="Bound">A</a> <a id="8613" href="/Substitution/#8613" class="Bound">B</a><a id="8614" class="Symbol">}</a> <a id="8616" class="Symbol">{</a><a id="8617" href="/Substitution/#8617" class="Bound">M</a> <a id="8619" class="Symbol">:</a> <a id="8621" href="/Substitution/#8607" class="Bound">Δ</a> <a id="8623" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="8625" href="/Substitution/#8611" class="Bound">A</a><a id="8626" class="Symbol">}</a> <a id="8628" class="Symbol">{</a><a id="8629" href="/Substitution/#8629" class="Bound">σ</a> <a id="8631" class="Symbol">:</a> <a id="8633" href="/Substitution/#2504" class="Function">Subst</a> <a id="8639" href="/Substitution/#8605" class="Bound">Γ</a> <a id="8641" href="/Substitution/#8607" class="Bound">Δ</a><a id="8642" class="Symbol">}</a>
         <a id="8653" class="Symbol">→</a> <a id="8655" class="Symbol">(</a><a id="8656" href="/Substitution/#3332" class="Function">↑</a> <a id="8658" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="8660" href="/Substitution/#8617" class="Bound">M</a> <a id="8662" href="/Substitution/#3590" class="Function Operator">•</a> <a id="8664" href="/Substitution/#8629" class="Bound">σ</a><a id="8665" class="Symbol">)</a> <a id="8667" class="Symbol">{</a><a id="8668" class="Argument">A</a> <a id="8670" class="Symbol">=</a> <a id="8672" href="/Substitution/#8613" class="Bound">B</a><a id="8673" class="Symbol">}</a> <a id="8675" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8677" href="/Substitution/#8629" class="Bound">σ</a>
<a id="8679" href="/Substitution/#8592" class="Function">sub-tail</a> <a id="8688" class="Symbol">=</a> <a id="8690" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="8705" class="Symbol">λ</a> <a id="8707" href="/Substitution/#8707" class="Bound">x</a> <a id="8709" class="Symbol">→</a> <a id="8711" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-η"></a><a id="8741" href="/Substitution/#8741" class="Function">sub-η</a> <a id="8747" class="Symbol">:</a> <a id="8749" class="Symbol">∀{</a><a id="8751" href="/Substitution/#8751" class="Bound">Γ</a> <a id="8753" href="/Substitution/#8753" class="Bound">Δ</a><a id="8754" class="Symbol">}</a> <a id="8756" class="Symbol">{</a><a id="8757" href="/Substitution/#8757" class="Bound">A</a> <a id="8759" href="/Substitution/#8759" class="Bound">B</a><a id="8760" class="Symbol">}</a> <a id="8762" class="Symbol">{</a><a id="8763" href="/Substitution/#8763" class="Bound">σ</a> <a id="8765" class="Symbol">:</a> <a id="8767" href="/Substitution/#2504" class="Function">Subst</a> <a id="8773" class="Symbol">(</a><a id="8774" href="/Substitution/#8751" class="Bound">Γ</a> <a id="8776" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="8778" href="/Substitution/#8757" class="Bound">A</a><a id="8779" class="Symbol">)</a> <a id="8781" href="/Substitution/#8753" class="Bound">Δ</a><a id="8782" class="Symbol">}</a>
      <a id="8790" class="Symbol">→</a> <a id="8792" class="Symbol">(</a><a id="8793" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="8795" href="/Substitution/#8763" class="Bound">σ</a> <a id="8797" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="8799" class="Symbol">(</a><a id="8800" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="8802" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8803" class="Symbol">)</a> <a id="8805" href="/Substitution/#3590" class="Function Operator">•</a> <a id="8807" class="Symbol">(</a><a id="8808" href="/Substitution/#3332" class="Function">↑</a> <a id="8810" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="8812" href="/Substitution/#8763" class="Bound">σ</a><a id="8813" class="Symbol">))</a> <a id="8816" class="Symbol">{</a><a id="8817" class="Argument">A</a> <a id="8819" class="Symbol">=</a> <a id="8821" href="/Substitution/#8759" class="Bound">B</a><a id="8822" class="Symbol">}</a> <a id="8824" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8826" href="/Substitution/#8763" class="Bound">σ</a>
<a id="8828" href="/Substitution/#8741" class="Function">sub-η</a> <a id="8834" class="Symbol">{</a><a id="8835" href="/Substitution/#8835" class="Bound">Γ</a><a id="8836" class="Symbol">}{</a><a id="8838" href="/Substitution/#8838" class="Bound">Δ</a><a id="8839" class="Symbol">}{</a><a id="8841" href="/Substitution/#8841" class="Bound">A</a><a id="8842" class="Symbol">}{</a><a id="8844" href="/Substitution/#8844" class="Bound">B</a><a id="8845" class="Symbol">}{</a><a id="8847" href="/Substitution/#8847" class="Bound">σ</a><a id="8848" class="Symbol">}</a> <a id="8850" class="Symbol">=</a> <a id="8852" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="8867" class="Symbol">λ</a> <a id="8869" href="/Substitution/#8869" class="Bound">x</a> <a id="8871" class="Symbol">→</a> <a id="8873" href="/Substitution/#8891" class="Function">lemma</a>
   <a id="8882" class="Keyword">where</a>
   <a id="8891" href="/Substitution/#8891" class="Function">lemma</a> <a id="8897" class="Symbol">:</a> <a id="8899" class="Symbol">∀</a> <a id="8901" class="Symbol">{</a><a id="8902" href="/Substitution/#8902" class="Bound">x</a><a id="8903" class="Symbol">}</a> <a id="8905" class="Symbol">→</a> <a id="8907" class="Symbol">((</a><a id="8909" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="8911" href="/Substitution/#8847" class="Bound">σ</a> <a id="8913" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="8915" class="Symbol">(</a><a id="8916" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="8918" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8919" class="Symbol">))</a> <a id="8922" href="/Substitution/#3590" class="Function Operator">•</a> <a id="8924" class="Symbol">(</a><a id="8925" href="/Substitution/#3332" class="Function">↑</a> <a id="8927" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="8929" href="/Substitution/#8847" class="Bound">σ</a><a id="8930" class="Symbol">))</a> <a id="8933" href="/Substitution/#8902" class="Bound">x</a> <a id="8935" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8937" href="/Substitution/#8847" class="Bound">σ</a> <a id="8939" href="/Substitution/#8902" class="Bound">x</a>
   <a id="8944" href="/Substitution/#8891" class="Function">lemma</a> <a id="8950" class="Symbol">{</a><a id="8951" class="Argument">x</a> <a id="8953" class="Symbol">=</a> <a id="8955" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8956" class="Symbol">}</a> <a id="8958" class="Symbol">=</a> <a id="8960" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
   <a id="8968" href="/Substitution/#8891" class="Function">lemma</a> <a id="8974" class="Symbol">{</a><a id="8975" class="Argument">x</a> <a id="8977" class="Symbol">=</a> <a id="8979" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="8981" href="/Substitution/#8981" class="Bound">x</a><a id="8982" class="Symbol">}</a> <a id="8984" class="Symbol">=</a> <a id="8986" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="Z-shift"></a><a id="9016" href="/Substitution/#9016" class="Function">Z-shift</a> <a id="9024" class="Symbol">:</a> <a id="9026" class="Symbol">∀{</a><a id="9028" href="/Substitution/#9028" class="Bound">Γ</a><a id="9029" class="Symbol">}{</a><a id="9031" href="/Substitution/#9031" class="Bound">A</a> <a id="9033" href="/Substitution/#9033" class="Bound">B</a><a id="9034" class="Symbol">}</a>
        <a id="9044" class="Symbol">→</a> <a id="9046" class="Symbol">((</a><a id="9048" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="9050" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="9051" class="Symbol">)</a> <a id="9053" href="/Substitution/#3590" class="Function Operator">•</a> <a id="9055" href="/Substitution/#3332" class="Function">↑</a><a id="9056" class="Symbol">)</a> <a id="9058" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9060" href="/Substitution/#3177" class="Function">ids</a> <a id="9064" class="Symbol">{</a><a id="9065" href="/Substitution/#9028" class="Bound">Γ</a> <a id="9067" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="9069" href="/Substitution/#9031" class="Bound">A</a><a id="9070" class="Symbol">}</a> <a id="9072" class="Symbol">{</a><a id="9073" href="/Substitution/#9033" class="Bound">B</a><a id="9074" class="Symbol">}</a>
<a id="9076" href="/Substitution/#9016" class="Function">Z-shift</a> <a id="9084" class="Symbol">{</a><a id="9085" href="/Substitution/#9085" class="Bound">Γ</a><a id="9086" class="Symbol">}{</a><a id="9088" href="/Substitution/#9088" class="Bound">A</a><a id="9089" class="Symbol">}{</a><a id="9091" href="/Substitution/#9091" class="Bound">B</a><a id="9092" class="Symbol">}</a> <a id="9094" class="Symbol">=</a> <a id="9096" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="9111" href="/Substitution/#9129" class="Function">lemma</a>
   <a id="9120" class="Keyword">where</a>
   <a id="9129" href="/Substitution/#9129" class="Function">lemma</a> <a id="9135" class="Symbol">:</a> <a id="9137" class="Symbol">(</a><a id="9138" href="/Substitution/#9138" class="Bound">x</a> <a id="9140" class="Symbol">:</a> <a id="9142" href="/Substitution/#9085" class="Bound">Γ</a> <a id="9144" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="9146" href="/Substitution/#9088" class="Bound">A</a> <a id="9148" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="9150" href="/Substitution/#9091" class="Bound">B</a><a id="9151" class="Symbol">)</a> <a id="9153" class="Symbol">→</a> <a id="9155" class="Symbol">((</a><a id="9157" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="9159" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="9160" class="Symbol">)</a> <a id="9162" href="/Substitution/#3590" class="Function Operator">•</a> <a id="9164" href="/Substitution/#3332" class="Function">↑</a><a id="9165" class="Symbol">)</a> <a id="9167" href="/Substitution/#9138" class="Bound">x</a> <a id="9169" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9171" href="/Substitution/#3177" class="Function">ids</a> <a id="9175" href="/Substitution/#9138" class="Bound">x</a>
   <a id="9180" href="/Substitution/#9129" class="Function">lemma</a> <a id="9186" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="9188" class="Symbol">=</a> <a id="9190" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
   <a id="9198" href="/Substitution/#9129" class="Function">lemma</a> <a id="9204" class="Symbol">(</a><a id="9205" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="9207" href="/Substitution/#9207" class="Bound">y</a><a id="9208" class="Symbol">)</a> <a id="9210" class="Symbol">=</a> <a id="9212" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-idL"></a><a id="9242" href="/Substitution/#9242" class="Function">sub-idL</a> <a id="9250" class="Symbol">:</a> <a id="9252" class="Symbol">∀{</a><a id="9254" href="/Substitution/#9254" class="Bound">Γ</a> <a id="9256" href="/Substitution/#9256" class="Bound">Δ</a><a id="9257" class="Symbol">}</a> <a id="9259" class="Symbol">{</a><a id="9260" href="/Substitution/#9260" class="Bound">σ</a> <a id="9262" class="Symbol">:</a> <a id="9264" href="/Substitution/#2504" class="Function">Subst</a> <a id="9270" href="/Substitution/#9254" class="Bound">Γ</a> <a id="9272" href="/Substitution/#9256" class="Bound">Δ</a><a id="9273" class="Symbol">}</a> <a id="9275" class="Symbol">{</a><a id="9276" href="/Substitution/#9276" class="Bound">A</a><a id="9277" class="Symbol">}</a>
       <a id="9286" class="Symbol">→</a> <a id="9288" href="/Substitution/#3177" class="Function">ids</a> <a id="9292" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="9294" href="/Substitution/#9260" class="Bound">σ</a> <a id="9296" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9298" href="/Substitution/#9260" class="Bound">σ</a> <a id="9300" class="Symbol">{</a><a id="9301" href="/Substitution/#9276" class="Bound">A</a><a id="9302" class="Symbol">}</a>
<a id="9304" href="/Substitution/#9242" class="Function">sub-idL</a> <a id="9312" class="Symbol">=</a> <a id="9314" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="9329" class="Symbol">λ</a> <a id="9331" href="/Substitution/#9331" class="Bound">x</a> <a id="9333" class="Symbol">→</a> <a id="9335" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-dist"></a><a id="9365" href="/Substitution/#9365" class="Function">sub-dist</a> <a id="9374" class="Symbol">:</a>  <a id="9377" class="Symbol">∀{</a><a id="9379" href="/Substitution/#9379" class="Bound">Γ</a> <a id="9381" href="/Substitution/#9381" class="Bound">Δ</a> <a id="9383" href="/Substitution/#9383" class="Bound">Σ</a> <a id="9385" class="Symbol">:</a> <a id="9387" href="/Untyped/#2980" class="Datatype">Context</a><a id="9394" class="Symbol">}</a> <a id="9396" class="Symbol">{</a><a id="9397" href="/Substitution/#9397" class="Bound">A</a> <a id="9399" href="/Substitution/#9399" class="Bound">B</a><a id="9400" class="Symbol">}</a> <a id="9402" class="Symbol">{</a><a id="9403" href="/Substitution/#9403" class="Bound">σ</a> <a id="9405" class="Symbol">:</a> <a id="9407" href="/Substitution/#2504" class="Function">Subst</a> <a id="9413" href="/Substitution/#9379" class="Bound">Γ</a> <a id="9415" href="/Substitution/#9381" class="Bound">Δ</a><a id="9416" class="Symbol">}</a> <a id="9418" class="Symbol">{</a><a id="9419" href="/Substitution/#9419" class="Bound">τ</a> <a id="9421" class="Symbol">:</a> <a id="9423" href="/Substitution/#2504" class="Function">Subst</a> <a id="9429" href="/Substitution/#9381" class="Bound">Δ</a> <a id="9431" href="/Substitution/#9383" class="Bound">Σ</a><a id="9432" class="Symbol">}</a>
              <a id="9448" class="Symbol">{</a><a id="9449" href="/Substitution/#9449" class="Bound">M</a> <a id="9451" class="Symbol">:</a> <a id="9453" href="/Substitution/#9381" class="Bound">Δ</a> <a id="9455" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="9457" href="/Substitution/#9397" class="Bound">A</a><a id="9458" class="Symbol">}</a>
         <a id="9469" class="Symbol">→</a> <a id="9471" class="Symbol">((</a><a id="9473" href="/Substitution/#9449" class="Bound">M</a> <a id="9475" href="/Substitution/#3590" class="Function Operator">•</a> <a id="9477" href="/Substitution/#9403" class="Bound">σ</a><a id="9478" class="Symbol">)</a> <a id="9480" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="9482" href="/Substitution/#9419" class="Bound">τ</a><a id="9483" class="Symbol">)</a> <a id="9485" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9487" class="Symbol">((</a><a id="9489" href="/Untyped/#6931" class="Function">subst</a> <a id="9495" href="/Substitution/#9419" class="Bound">τ</a> <a id="9497" href="/Substitution/#9449" class="Bound">M</a><a id="9498" class="Symbol">)</a> <a id="9500" href="/Substitution/#3590" class="Function Operator">•</a> <a id="9502" class="Symbol">(</a><a id="9503" href="/Substitution/#9403" class="Bound">σ</a> <a id="9505" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="9507" href="/Substitution/#9419" class="Bound">τ</a><a id="9508" class="Symbol">))</a> <a id="9511" class="Symbol">{</a><a id="9512" href="/Substitution/#9399" class="Bound">B</a><a id="9513" class="Symbol">}</a>
<a id="9515" href="/Substitution/#9365" class="Function">sub-dist</a> <a id="9524" class="Symbol">{</a><a id="9525" href="/Substitution/#9525" class="Bound">Γ</a><a id="9526" class="Symbol">}{</a><a id="9528" href="/Substitution/#9528" class="Bound">Δ</a><a id="9529" class="Symbol">}{</a><a id="9531" href="/Substitution/#9531" class="Bound">Σ</a><a id="9532" class="Symbol">}{</a><a id="9534" href="/Substitution/#9534" class="Bound">A</a><a id="9535" class="Symbol">}{</a><a id="9537" href="/Substitution/#9537" class="Bound">B</a><a id="9538" class="Symbol">}{</a><a id="9540" href="/Substitution/#9540" class="Bound">σ</a><a id="9541" class="Symbol">}{</a><a id="9543" href="/Substitution/#9543" class="Bound">τ</a><a id="9544" class="Symbol">}{</a><a id="9546" href="/Substitution/#9546" class="Bound">M</a><a id="9547" class="Symbol">}</a> <a id="9549" class="Symbol">=</a> <a id="9551" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="9566" class="Symbol">λ</a> <a id="9568" href="/Substitution/#9568" class="Bound">x</a> <a id="9570" class="Symbol">→</a> <a id="9572" href="/Substitution/#9596" class="Function">lemma</a> <a id="9578" class="Symbol">{</a><a id="9579" class="Argument">x</a> <a id="9581" class="Symbol">=</a> <a id="9583" href="/Substitution/#9568" class="Bound">x</a><a id="9584" class="Symbol">}</a>
  <a id="9588" class="Keyword">where</a>
  <a id="9596" href="/Substitution/#9596" class="Function">lemma</a> <a id="9602" class="Symbol">:</a> <a id="9604" class="Symbol">∀</a> <a id="9606" class="Symbol">{</a><a id="9607" href="/Substitution/#9607" class="Bound">x</a> <a id="9609" class="Symbol">:</a> <a id="9611" href="/Substitution/#9525" class="Bound">Γ</a> <a id="9613" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="9615" href="/Substitution/#9534" class="Bound">A</a> <a id="9617" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="9619" href="/Substitution/#9537" class="Bound">B</a><a id="9620" class="Symbol">}</a> <a id="9622" class="Symbol">→</a> <a id="9624" class="Symbol">((</a><a id="9626" href="/Substitution/#9546" class="Bound">M</a> <a id="9628" href="/Substitution/#3590" class="Function Operator">•</a> <a id="9630" href="/Substitution/#9540" class="Bound">σ</a><a id="9631" class="Symbol">)</a> <a id="9633" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="9635" href="/Substitution/#9543" class="Bound">τ</a><a id="9636" class="Symbol">)</a> <a id="9638" href="/Substitution/#9607" class="Bound">x</a> <a id="9640" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9642" class="Symbol">((</a><a id="9644" href="/Untyped/#6931" class="Function">subst</a> <a id="9650" href="/Substitution/#9543" class="Bound">τ</a> <a id="9652" href="/Substitution/#9546" class="Bound">M</a><a id="9653" class="Symbol">)</a> <a id="9655" href="/Substitution/#3590" class="Function Operator">•</a> <a id="9657" class="Symbol">(</a><a id="9658" href="/Substitution/#9540" class="Bound">σ</a> <a id="9660" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="9662" href="/Substitution/#9543" class="Bound">τ</a><a id="9663" class="Symbol">))</a> <a id="9666" href="/Substitution/#9607" class="Bound">x</a>
  <a id="9670" href="/Substitution/#9596" class="Function">lemma</a> <a id="9676" class="Symbol">{</a><a id="9677" class="Argument">x</a> <a id="9679" class="Symbol">=</a> <a id="9681" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="9682" class="Symbol">}</a> <a id="9684" class="Symbol">=</a> <a id="9686" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="9693" href="/Substitution/#9596" class="Function">lemma</a> <a id="9699" class="Symbol">{</a><a id="9700" class="Argument">x</a> <a id="9702" class="Symbol">=</a> <a id="9704" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="9706" href="/Substitution/#9706" class="Bound">x</a><a id="9707" class="Symbol">}</a> <a id="9709" class="Symbol">=</a> <a id="9711" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-app"></a><a id="9741" href="/Substitution/#9741" class="Function">sub-app</a> <a id="9749" class="Symbol">:</a> <a id="9751" class="Symbol">∀{</a><a id="9753" href="/Substitution/#9753" class="Bound">Γ</a> <a id="9755" href="/Substitution/#9755" class="Bound">Δ</a><a id="9756" class="Symbol">}</a> <a id="9758" class="Symbol">{</a><a id="9759" href="/Substitution/#9759" class="Bound">σ</a> <a id="9761" class="Symbol">:</a> <a id="9763" href="/Substitution/#2504" class="Function">Subst</a> <a id="9769" href="/Substitution/#9753" class="Bound">Γ</a> <a id="9771" href="/Substitution/#9755" class="Bound">Δ</a><a id="9772" class="Symbol">}</a> <a id="9774" class="Symbol">{</a><a id="9775" href="/Substitution/#9775" class="Bound">L</a> <a id="9777" class="Symbol">:</a> <a id="9779" href="/Substitution/#9753" class="Bound">Γ</a> <a id="9781" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="9783" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="9784" class="Symbol">}{</a><a id="9786" href="/Substitution/#9786" class="Bound">M</a> <a id="9788" class="Symbol">:</a> <a id="9790" href="/Substitution/#9753" class="Bound">Γ</a> <a id="9792" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="9794" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="9795" class="Symbol">}</a>
        <a id="9805" class="Symbol">→</a> <a id="9807" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="9809" href="/Substitution/#9759" class="Bound">σ</a> <a id="9811" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="9813" class="Symbol">(</a><a id="9814" href="/Substitution/#9775" class="Bound">L</a> <a id="9816" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="9818" href="/Substitution/#9786" class="Bound">M</a><a id="9819" class="Symbol">)</a>  <a id="9822" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9824" class="Symbol">(</a><a id="9825" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="9827" href="/Substitution/#9759" class="Bound">σ</a> <a id="9829" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="9831" href="/Substitution/#9775" class="Bound">L</a><a id="9832" class="Symbol">)</a> <a id="9834" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="9836" class="Symbol">(</a><a id="9837" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="9839" href="/Substitution/#9759" class="Bound">σ</a> <a id="9841" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="9843" href="/Substitution/#9786" class="Bound">M</a><a id="9844" class="Symbol">)</a>
<a id="9846" href="/Substitution/#9741" class="Function">sub-app</a> <a id="9854" class="Symbol">=</a> <a id="9856" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<h2 id="interlude-congruences">Interlude: congruences</h2>

<p>In this section we establish congruence rules for the σ algebra
operators <code class="highlighter-rouge">•</code> and <code class="highlighter-rouge">⨟</code> and for <code class="highlighter-rouge">subst</code> and its helper functions <code class="highlighter-rouge">ext</code>,
<code class="highlighter-rouge">rename</code>, <code class="highlighter-rouge">exts</code>, and <code class="highlighter-rouge">subst-zero</code>. These congruence rules help with
the equational reasoning in the later sections of this chapter.</p>

<p>[JGS: I would have liked to prove all of these via cong and cong₂,
 but I have not yet found a way to make that work. It seems that
 various implicit parameters get in the way.]</p>

<pre class="Agda"><a id="cong-ext"></a><a id="10361" href="/Substitution/#10361" class="Function">cong-ext</a> <a id="10370" class="Symbol">:</a> <a id="10372" class="Symbol">∀{</a><a id="10374" href="/Substitution/#10374" class="Bound">Γ</a> <a id="10376" href="/Substitution/#10376" class="Bound">Δ</a><a id="10377" class="Symbol">}{</a><a id="10379" href="/Substitution/#10379" class="Bound">ρ</a> <a id="10381" href="/Substitution/#10381" class="Bound">ρ′</a> <a id="10384" class="Symbol">:</a> <a id="10386" href="/Substitution/#2275" class="Function">Rename</a> <a id="10393" href="/Substitution/#10374" class="Bound">Γ</a> <a id="10395" href="/Substitution/#10376" class="Bound">Δ</a><a id="10396" class="Symbol">}{</a><a id="10398" href="/Substitution/#10398" class="Bound">B</a><a id="10399" class="Symbol">}</a>
   <a id="10404" class="Symbol">→</a> <a id="10406" class="Symbol">(∀{</a><a id="10409" href="/Substitution/#10409" class="Bound">A</a><a id="10410" class="Symbol">}</a> <a id="10412" class="Symbol">→</a> <a id="10414" href="/Substitution/#10379" class="Bound">ρ</a> <a id="10416" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10418" href="/Substitution/#10381" class="Bound">ρ′</a> <a id="10421" class="Symbol">{</a><a id="10422" href="/Substitution/#10409" class="Bound">A</a><a id="10423" class="Symbol">})</a>
     <a id="10431" class="Comment">---------------------------------</a>
   <a id="10468" class="Symbol">→</a> <a id="10470" class="Symbol">∀{</a><a id="10472" href="/Substitution/#10472" class="Bound">A</a><a id="10473" class="Symbol">}</a> <a id="10475" class="Symbol">→</a> <a id="10477" href="/Untyped/#5845" class="Function">ext</a> <a id="10481" href="/Substitution/#10379" class="Bound">ρ</a> <a id="10483" class="Symbol">{</a><a id="10484" class="Argument">B</a> <a id="10486" class="Symbol">=</a> <a id="10488" href="/Substitution/#10398" class="Bound">B</a><a id="10489" class="Symbol">}</a> <a id="10491" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10493" href="/Untyped/#5845" class="Function">ext</a> <a id="10497" href="/Substitution/#10381" class="Bound">ρ′</a> <a id="10500" class="Symbol">{</a><a id="10501" href="/Substitution/#10472" class="Bound">A</a><a id="10502" class="Symbol">}</a>
<a id="10504" href="/Substitution/#10361" class="Function">cong-ext</a><a id="10512" class="Symbol">{</a><a id="10513" href="/Substitution/#10513" class="Bound">Γ</a><a id="10514" class="Symbol">}{</a><a id="10516" href="/Substitution/#10516" class="Bound">Δ</a><a id="10517" class="Symbol">}{</a><a id="10519" href="/Substitution/#10519" class="Bound">ρ</a><a id="10520" class="Symbol">}{</a><a id="10522" href="/Substitution/#10522" class="Bound">ρ′</a><a id="10524" class="Symbol">}{</a><a id="10526" href="/Substitution/#10526" class="Bound">B</a><a id="10527" class="Symbol">}</a> <a id="10529" href="/Substitution/#10529" class="Bound">rr</a> <a id="10532" class="Symbol">{</a><a id="10533" href="/Substitution/#10533" class="Bound">A</a><a id="10534" class="Symbol">}</a> <a id="10536" class="Symbol">=</a> <a id="10538" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="10553" class="Symbol">λ</a> <a id="10555" href="/Substitution/#10555" class="Bound">x</a> <a id="10557" class="Symbol">→</a> <a id="10559" href="/Substitution/#10579" class="Function">lemma</a> <a id="10565" class="Symbol">{</a><a id="10566" href="/Substitution/#10555" class="Bound">x</a><a id="10567" class="Symbol">}</a>
  <a id="10571" class="Keyword">where</a>
  <a id="10579" href="/Substitution/#10579" class="Function">lemma</a> <a id="10585" class="Symbol">:</a> <a id="10587" class="Symbol">∀{</a><a id="10589" href="/Substitution/#10589" class="Bound">x</a> <a id="10591" class="Symbol">:</a> <a id="10593" href="/Substitution/#10513" class="Bound">Γ</a> <a id="10595" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="10597" href="/Substitution/#10526" class="Bound">B</a> <a id="10599" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="10601" href="/Substitution/#10533" class="Bound">A</a><a id="10602" class="Symbol">}</a> <a id="10604" class="Symbol">→</a> <a id="10606" href="/Untyped/#5845" class="Function">ext</a> <a id="10610" href="/Substitution/#10519" class="Bound">ρ</a> <a id="10612" href="/Substitution/#10589" class="Bound">x</a> <a id="10614" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10616" href="/Untyped/#5845" class="Function">ext</a> <a id="10620" href="/Substitution/#10522" class="Bound">ρ′</a> <a id="10623" href="/Substitution/#10589" class="Bound">x</a>
  <a id="10627" href="/Substitution/#10579" class="Function">lemma</a> <a id="10633" class="Symbol">{</a><a id="10634" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="10635" class="Symbol">}</a> <a id="10637" class="Symbol">=</a> <a id="10639" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="10646" href="/Substitution/#10579" class="Function">lemma</a> <a id="10652" class="Symbol">{</a><a id="10653" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="10655" href="/Substitution/#10655" class="Bound">y</a><a id="10656" class="Symbol">}</a> <a id="10658" class="Symbol">=</a> <a id="10660" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="10665" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="10668" class="Symbol">(</a><a id="10669" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="10678" href="/Substitution/#10529" class="Bound">rr</a> <a id="10681" href="/Substitution/#10655" class="Bound">y</a><a id="10682" class="Symbol">)</a></pre>

<pre class="Agda"><a id="cong-rename"></a><a id="10709" href="/Substitution/#10709" class="Function">cong-rename</a> <a id="10721" class="Symbol">:</a> <a id="10723" class="Symbol">∀{</a><a id="10725" href="/Substitution/#10725" class="Bound">Γ</a> <a id="10727" href="/Substitution/#10727" class="Bound">Δ</a><a id="10728" class="Symbol">}{</a><a id="10730" href="/Substitution/#10730" class="Bound">ρ</a> <a id="10732" href="/Substitution/#10732" class="Bound">ρ′</a> <a id="10735" class="Symbol">:</a> <a id="10737" href="/Substitution/#2275" class="Function">Rename</a> <a id="10744" href="/Substitution/#10725" class="Bound">Γ</a> <a id="10746" href="/Substitution/#10727" class="Bound">Δ</a><a id="10747" class="Symbol">}{</a><a id="10749" href="/Substitution/#10749" class="Bound">B</a><a id="10750" class="Symbol">}{</a><a id="10752" href="/Substitution/#10752" class="Bound">M</a> <a id="10754" href="/Substitution/#10754" class="Bound">M′</a> <a id="10757" class="Symbol">:</a> <a id="10759" href="/Substitution/#10725" class="Bound">Γ</a> <a id="10761" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="10763" href="/Substitution/#10749" class="Bound">B</a><a id="10764" class="Symbol">}</a>
        <a id="10774" class="Symbol">→</a> <a id="10776" class="Symbol">(∀{</a><a id="10779" href="/Substitution/#10779" class="Bound">A</a><a id="10780" class="Symbol">}</a> <a id="10782" class="Symbol">→</a> <a id="10784" href="/Substitution/#10730" class="Bound">ρ</a> <a id="10786" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10788" href="/Substitution/#10732" class="Bound">ρ′</a> <a id="10791" class="Symbol">{</a><a id="10792" href="/Substitution/#10779" class="Bound">A</a><a id="10793" class="Symbol">})</a>  <a id="10797" class="Symbol">→</a>  <a id="10800" href="/Substitution/#10752" class="Bound">M</a> <a id="10802" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10804" href="/Substitution/#10754" class="Bound">M′</a>
          <a id="10817" class="Comment">------------------------------</a>
        <a id="10856" class="Symbol">→</a> <a id="10858" href="/Untyped/#6171" class="Function">rename</a> <a id="10865" href="/Substitution/#10730" class="Bound">ρ</a> <a id="10867" href="/Substitution/#10752" class="Bound">M</a> <a id="10869" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10871" href="/Untyped/#6171" class="Function">rename</a> <a id="10878" href="/Substitution/#10732" class="Bound">ρ′</a> <a id="10881" href="/Substitution/#10752" class="Bound">M</a>
<a id="10883" href="/Substitution/#10709" class="Function">cong-rename</a> <a id="10895" class="Symbol">{</a><a id="10896" class="Argument">M</a> <a id="10898" class="Symbol">=</a> <a id="10900" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="10902" href="/Substitution/#10902" class="Bound">x</a><a id="10903" class="Symbol">}</a> <a id="10905" href="/Substitution/#10905" class="Bound">rr</a> <a id="10908" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="10913" class="Symbol">=</a> <a id="10915" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="10920" href="/Untyped/#4186" class="InductiveConstructor Operator">`_</a> <a id="10923" class="Symbol">(</a><a id="10924" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="10933" href="/Substitution/#10905" class="Bound">rr</a> <a id="10936" href="/Substitution/#10902" class="Bound">x</a><a id="10937" class="Symbol">)</a>
<a id="10939" href="/Substitution/#10709" class="Function">cong-rename</a> <a id="10951" class="Symbol">{</a><a id="10952" class="Argument">ρ</a> <a id="10954" class="Symbol">=</a> <a id="10956" href="/Substitution/#10956" class="Bound">ρ</a><a id="10957" class="Symbol">}</a> <a id="10959" class="Symbol">{</a><a id="10960" class="Argument">ρ′</a> <a id="10963" class="Symbol">=</a> <a id="10965" href="/Substitution/#10965" class="Bound">ρ′</a><a id="10967" class="Symbol">}</a> <a id="10969" class="Symbol">{</a><a id="10970" class="Argument">M</a> <a id="10972" class="Symbol">=</a> <a id="10974" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="10976" href="/Substitution/#10976" class="Bound">N</a><a id="10977" class="Symbol">}</a> <a id="10979" href="/Substitution/#10979" class="Bound">rr</a> <a id="10982" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="10987" class="Symbol">=</a>
   <a id="10992" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="10997" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="11000" class="Symbol">(</a><a id="11001" href="/Substitution/#10709" class="Function">cong-rename</a> <a id="11013" class="Symbol">{</a><a id="11014" class="Argument">ρ</a> <a id="11016" class="Symbol">=</a> <a id="11018" href="/Untyped/#5845" class="Function">ext</a> <a id="11022" href="/Substitution/#10956" class="Bound">ρ</a><a id="11023" class="Symbol">}{</a><a id="11025" class="Argument">ρ′</a> <a id="11028" class="Symbol">=</a> <a id="11030" href="/Untyped/#5845" class="Function">ext</a> <a id="11034" href="/Substitution/#10965" class="Bound">ρ′</a><a id="11036" class="Symbol">}{</a><a id="11038" class="Argument">M</a> <a id="11040" class="Symbol">=</a> <a id="11042" href="/Substitution/#10976" class="Bound">N</a><a id="11043" class="Symbol">}</a> <a id="11045" class="Symbol">(</a><a id="11046" href="/Substitution/#10361" class="Function">cong-ext</a> <a id="11055" href="/Substitution/#10979" class="Bound">rr</a><a id="11057" class="Symbol">)</a> <a id="11059" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="11063" class="Symbol">)</a>
<a id="11065" href="/Substitution/#10709" class="Function">cong-rename</a> <a id="11077" class="Symbol">{</a><a id="11078" class="Argument">M</a> <a id="11080" class="Symbol">=</a> <a id="11082" href="/Substitution/#11082" class="Bound">L</a> <a id="11084" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="11086" href="/Substitution/#11086" class="Bound">M</a><a id="11087" class="Symbol">}</a> <a id="11089" href="/Substitution/#11089" class="Bound">rr</a> <a id="11092" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="11097" class="Symbol">=</a>
   <a id="11102" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="11108" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="11112" class="Symbol">(</a><a id="11113" href="/Substitution/#10709" class="Function">cong-rename</a> <a id="11125" href="/Substitution/#11089" class="Bound">rr</a> <a id="11128" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="11132" class="Symbol">)</a> <a id="11134" class="Symbol">(</a><a id="11135" href="/Substitution/#10709" class="Function">cong-rename</a> <a id="11147" href="/Substitution/#11089" class="Bound">rr</a> <a id="11150" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="11154" class="Symbol">)</a></pre>

<pre class="Agda"><a id="cong-exts"></a><a id="11181" href="/Substitution/#11181" class="Function">cong-exts</a> <a id="11191" class="Symbol">:</a> <a id="11193" class="Symbol">∀{</a><a id="11195" href="/Substitution/#11195" class="Bound">Γ</a> <a id="11197" href="/Substitution/#11197" class="Bound">Δ</a><a id="11198" class="Symbol">}{</a><a id="11200" href="/Substitution/#11200" class="Bound">σ</a> <a id="11202" href="/Substitution/#11202" class="Bound">σ′</a> <a id="11205" class="Symbol">:</a> <a id="11207" href="/Substitution/#2504" class="Function">Subst</a> <a id="11213" href="/Substitution/#11195" class="Bound">Γ</a> <a id="11215" href="/Substitution/#11197" class="Bound">Δ</a><a id="11216" class="Symbol">}{</a><a id="11218" href="/Substitution/#11218" class="Bound">B</a><a id="11219" class="Symbol">}</a>
   <a id="11224" class="Symbol">→</a> <a id="11226" class="Symbol">(∀{</a><a id="11229" href="/Substitution/#11229" class="Bound">A</a><a id="11230" class="Symbol">}</a> <a id="11232" class="Symbol">→</a> <a id="11234" href="/Substitution/#11200" class="Bound">σ</a> <a id="11236" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11238" href="/Substitution/#11202" class="Bound">σ′</a> <a id="11241" class="Symbol">{</a><a id="11242" href="/Substitution/#11229" class="Bound">A</a><a id="11243" class="Symbol">})</a>
     <a id="11251" class="Comment">-----------------------------------</a>
   <a id="11290" class="Symbol">→</a> <a id="11292" class="Symbol">∀{</a><a id="11294" href="/Substitution/#11294" class="Bound">A</a><a id="11295" class="Symbol">}</a> <a id="11297" class="Symbol">→</a> <a id="11299" href="/Untyped/#6623" class="Function">exts</a> <a id="11304" href="/Substitution/#11200" class="Bound">σ</a> <a id="11306" class="Symbol">{</a><a id="11307" class="Argument">B</a> <a id="11309" class="Symbol">=</a> <a id="11311" href="/Substitution/#11218" class="Bound">B</a><a id="11312" class="Symbol">}</a> <a id="11314" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11316" href="/Untyped/#6623" class="Function">exts</a> <a id="11321" href="/Substitution/#11202" class="Bound">σ′</a> <a id="11324" class="Symbol">{</a><a id="11325" href="/Substitution/#11294" class="Bound">A</a><a id="11326" class="Symbol">}</a>
<a id="11328" href="/Substitution/#11181" class="Function">cong-exts</a><a id="11337" class="Symbol">{</a><a id="11338" href="/Substitution/#11338" class="Bound">Γ</a><a id="11339" class="Symbol">}{</a><a id="11341" href="/Substitution/#11341" class="Bound">Δ</a><a id="11342" class="Symbol">}{</a><a id="11344" href="/Substitution/#11344" class="Bound">σ</a><a id="11345" class="Symbol">}{</a><a id="11347" href="/Substitution/#11347" class="Bound">σ′</a><a id="11349" class="Symbol">}{</a><a id="11351" href="/Substitution/#11351" class="Bound">B</a><a id="11352" class="Symbol">}</a> <a id="11354" href="/Substitution/#11354" class="Bound">ss</a> <a id="11357" class="Symbol">{</a><a id="11358" href="/Substitution/#11358" class="Bound">A</a><a id="11359" class="Symbol">}</a> <a id="11361" class="Symbol">=</a> <a id="11363" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="11378" class="Symbol">λ</a> <a id="11380" href="/Substitution/#11380" class="Bound">x</a> <a id="11382" class="Symbol">→</a> <a id="11384" href="/Substitution/#11406" class="Function">lemma</a> <a id="11390" class="Symbol">{</a><a id="11391" href="/Substitution/#11380" class="Bound">x</a><a id="11392" class="Symbol">}</a>
   <a id="11397" class="Keyword">where</a>
   <a id="11406" href="/Substitution/#11406" class="Function">lemma</a> <a id="11412" class="Symbol">:</a> <a id="11414" class="Symbol">∀{</a><a id="11416" href="/Substitution/#11416" class="Bound">x</a><a id="11417" class="Symbol">}</a> <a id="11419" class="Symbol">→</a> <a id="11421" href="/Untyped/#6623" class="Function">exts</a> <a id="11426" href="/Substitution/#11344" class="Bound">σ</a> <a id="11428" href="/Substitution/#11416" class="Bound">x</a> <a id="11430" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11432" href="/Untyped/#6623" class="Function">exts</a> <a id="11437" href="/Substitution/#11347" class="Bound">σ′</a> <a id="11440" href="/Substitution/#11416" class="Bound">x</a>
   <a id="11445" href="/Substitution/#11406" class="Function">lemma</a> <a id="11451" class="Symbol">{</a><a id="11452" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="11453" class="Symbol">}</a> <a id="11455" class="Symbol">=</a> <a id="11457" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
   <a id="11465" href="/Substitution/#11406" class="Function">lemma</a> <a id="11471" class="Symbol">{</a><a id="11472" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="11474" href="/Substitution/#11474" class="Bound">x</a><a id="11475" class="Symbol">}</a> <a id="11477" class="Symbol">=</a> <a id="11479" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="11484" class="Symbol">(</a><a id="11485" href="/Untyped/#6171" class="Function">rename</a> <a id="11492" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="11494" class="Symbol">)</a> <a id="11496" class="Symbol">(</a><a id="11497" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="11506" class="Symbol">(</a><a id="11507" href="/Substitution/#11354" class="Bound">ss</a> <a id="11510" class="Symbol">{</a><a id="11511" href="/Substitution/#11358" class="Bound">A</a><a id="11512" class="Symbol">})</a> <a id="11515" href="/Substitution/#11474" class="Bound">x</a><a id="11516" class="Symbol">)</a></pre>

<pre class="Agda"><a id="cong-sub"></a><a id="11543" href="/Substitution/#11543" class="Function">cong-sub</a> <a id="11552" class="Symbol">:</a> <a id="11554" class="Symbol">∀{</a><a id="11556" href="/Substitution/#11556" class="Bound">Γ</a> <a id="11558" href="/Substitution/#11558" class="Bound">Δ</a><a id="11559" class="Symbol">}{</a><a id="11561" href="/Substitution/#11561" class="Bound">σ</a> <a id="11563" href="/Substitution/#11563" class="Bound">σ′</a> <a id="11566" class="Symbol">:</a> <a id="11568" href="/Substitution/#2504" class="Function">Subst</a> <a id="11574" href="/Substitution/#11556" class="Bound">Γ</a> <a id="11576" href="/Substitution/#11558" class="Bound">Δ</a><a id="11577" class="Symbol">}{</a><a id="11579" href="/Substitution/#11579" class="Bound">A</a><a id="11580" class="Symbol">}{</a><a id="11582" href="/Substitution/#11582" class="Bound">M</a> <a id="11584" href="/Substitution/#11584" class="Bound">M′</a> <a id="11587" class="Symbol">:</a> <a id="11589" href="/Substitution/#11556" class="Bound">Γ</a> <a id="11591" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="11593" href="/Substitution/#11579" class="Bound">A</a><a id="11594" class="Symbol">}</a>
            <a id="11608" class="Symbol">→</a> <a id="11610" class="Symbol">(∀{</a><a id="11613" href="/Substitution/#11613" class="Bound">A</a><a id="11614" class="Symbol">}</a> <a id="11616" class="Symbol">→</a> <a id="11618" href="/Substitution/#11561" class="Bound">σ</a> <a id="11620" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11622" href="/Substitution/#11563" class="Bound">σ′</a> <a id="11625" class="Symbol">{</a><a id="11626" href="/Substitution/#11613" class="Bound">A</a><a id="11627" class="Symbol">})</a>  <a id="11631" class="Symbol">→</a>  <a id="11634" href="/Substitution/#11582" class="Bound">M</a> <a id="11636" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11638" href="/Substitution/#11584" class="Bound">M′</a>
              <a id="11655" class="Comment">------------------------------</a>
            <a id="11698" class="Symbol">→</a> <a id="11700" href="/Untyped/#6931" class="Function">subst</a> <a id="11706" href="/Substitution/#11561" class="Bound">σ</a> <a id="11708" href="/Substitution/#11582" class="Bound">M</a> <a id="11710" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11712" href="/Untyped/#6931" class="Function">subst</a> <a id="11718" href="/Substitution/#11563" class="Bound">σ′</a> <a id="11721" href="/Substitution/#11584" class="Bound">M′</a>
<a id="11724" href="/Substitution/#11543" class="Function">cong-sub</a> <a id="11733" class="Symbol">{</a><a id="11734" href="/Substitution/#11734" class="Bound">Γ</a><a id="11735" class="Symbol">}</a> <a id="11737" class="Symbol">{</a><a id="11738" href="/Substitution/#11738" class="Bound">Δ</a><a id="11739" class="Symbol">}</a> <a id="11741" class="Symbol">{</a><a id="11742" href="/Substitution/#11742" class="Bound">σ</a><a id="11743" class="Symbol">}</a> <a id="11745" class="Symbol">{</a><a id="11746" href="/Substitution/#11746" class="Bound">σ′</a><a id="11748" class="Symbol">}</a> <a id="11750" class="Symbol">{</a><a id="11751" href="/Substitution/#11751" class="Bound">A</a><a id="11752" class="Symbol">}</a> <a id="11754" class="Symbol">{</a><a id="11755" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="11757" href="/Substitution/#11757" class="Bound">x</a><a id="11758" class="Symbol">}</a> <a id="11760" href="/Substitution/#11760" class="Bound">ss</a> <a id="11763" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="11768" class="Symbol">=</a> <a id="11770" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="11779" href="/Substitution/#11760" class="Bound">ss</a> <a id="11782" href="/Substitution/#11757" class="Bound">x</a>
<a id="11784" href="/Substitution/#11543" class="Function">cong-sub</a> <a id="11793" class="Symbol">{</a><a id="11794" href="/Substitution/#11794" class="Bound">Γ</a><a id="11795" class="Symbol">}</a> <a id="11797" class="Symbol">{</a><a id="11798" href="/Substitution/#11798" class="Bound">Δ</a><a id="11799" class="Symbol">}</a> <a id="11801" class="Symbol">{</a><a id="11802" href="/Substitution/#11802" class="Bound">σ</a><a id="11803" class="Symbol">}</a> <a id="11805" class="Symbol">{</a><a id="11806" href="/Substitution/#11806" class="Bound">σ′</a><a id="11808" class="Symbol">}</a> <a id="11810" class="Symbol">{</a><a id="11811" href="/Substitution/#11811" class="Bound">A</a><a id="11812" class="Symbol">}</a> <a id="11814" class="Symbol">{</a><a id="11815" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="11817" href="/Substitution/#11817" class="Bound">M</a><a id="11818" class="Symbol">}</a> <a id="11820" href="/Substitution/#11820" class="Bound">ss</a> <a id="11823" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="11828" class="Symbol">=</a>
   <a id="11833" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="11838" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="11841" class="Symbol">(</a><a id="11842" href="/Substitution/#11543" class="Function">cong-sub</a> <a id="11851" class="Symbol">{</a><a id="11852" class="Argument">σ</a> <a id="11854" class="Symbol">=</a> <a id="11856" href="/Untyped/#6623" class="Function">exts</a> <a id="11861" href="/Substitution/#11802" class="Bound">σ</a><a id="11862" class="Symbol">}{</a><a id="11864" class="Argument">σ′</a> <a id="11867" class="Symbol">=</a> <a id="11869" href="/Untyped/#6623" class="Function">exts</a> <a id="11874" href="/Substitution/#11806" class="Bound">σ′</a><a id="11876" class="Symbol">}</a> <a id="11878" class="Symbol">{</a><a id="11879" class="Argument">M</a> <a id="11881" class="Symbol">=</a> <a id="11883" href="/Substitution/#11817" class="Bound">M</a><a id="11884" class="Symbol">}</a> <a id="11886" class="Symbol">(</a><a id="11887" href="/Substitution/#11181" class="Function">cong-exts</a> <a id="11897" href="/Substitution/#11820" class="Bound">ss</a><a id="11899" class="Symbol">)</a> <a id="11901" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="11905" class="Symbol">)</a>
<a id="11907" href="/Substitution/#11543" class="Function">cong-sub</a> <a id="11916" class="Symbol">{</a><a id="11917" href="/Substitution/#11917" class="Bound">Γ</a><a id="11918" class="Symbol">}</a> <a id="11920" class="Symbol">{</a><a id="11921" href="/Substitution/#11921" class="Bound">Δ</a><a id="11922" class="Symbol">}</a> <a id="11924" class="Symbol">{</a><a id="11925" href="/Substitution/#11925" class="Bound">σ</a><a id="11926" class="Symbol">}</a> <a id="11928" class="Symbol">{</a><a id="11929" href="/Substitution/#11929" class="Bound">σ′</a><a id="11931" class="Symbol">}</a> <a id="11933" class="Symbol">{</a><a id="11934" href="/Substitution/#11934" class="Bound">A</a><a id="11935" class="Symbol">}</a> <a id="11937" class="Symbol">{</a><a id="11938" href="/Substitution/#11938" class="Bound">L</a> <a id="11940" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="11942" href="/Substitution/#11942" class="Bound">M</a><a id="11943" class="Symbol">}</a> <a id="11945" href="/Substitution/#11945" class="Bound">ss</a> <a id="11948" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="11953" class="Symbol">=</a>
   <a id="11958" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="11964" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="11968" class="Symbol">(</a><a id="11969" href="/Substitution/#11543" class="Function">cong-sub</a> <a id="11978" class="Symbol">{</a><a id="11979" class="Argument">M</a> <a id="11981" class="Symbol">=</a> <a id="11983" href="/Substitution/#11938" class="Bound">L</a><a id="11984" class="Symbol">}</a> <a id="11986" href="/Substitution/#11945" class="Bound">ss</a> <a id="11989" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="11993" class="Symbol">)</a> <a id="11995" class="Symbol">(</a><a id="11996" href="/Substitution/#11543" class="Function">cong-sub</a> <a id="12005" class="Symbol">{</a><a id="12006" class="Argument">M</a> <a id="12008" class="Symbol">=</a> <a id="12010" href="/Substitution/#11942" class="Bound">M</a><a id="12011" class="Symbol">}</a> <a id="12013" href="/Substitution/#11945" class="Bound">ss</a> <a id="12016" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="12020" class="Symbol">)</a></pre>

<pre class="Agda"><a id="cong-sub-zero"></a><a id="12047" href="/Substitution/#12047" class="Function">cong-sub-zero</a> <a id="12061" class="Symbol">:</a> <a id="12063" class="Symbol">∀{</a><a id="12065" href="/Substitution/#12065" class="Bound">Γ</a><a id="12066" class="Symbol">}{</a><a id="12068" href="/Substitution/#12068" class="Bound">B</a> <a id="12070" class="Symbol">:</a> <a id="12072" href="/Untyped/#2675" class="Datatype">Type</a><a id="12076" class="Symbol">}{</a><a id="12078" href="/Substitution/#12078" class="Bound">M</a> <a id="12080" href="/Substitution/#12080" class="Bound">M′</a> <a id="12083" class="Symbol">:</a> <a id="12085" href="/Substitution/#12065" class="Bound">Γ</a> <a id="12087" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="12089" href="/Substitution/#12068" class="Bound">B</a><a id="12090" class="Symbol">}</a>
  <a id="12094" class="Symbol">→</a> <a id="12096" href="/Substitution/#12078" class="Bound">M</a> <a id="12098" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12100" href="/Substitution/#12080" class="Bound">M′</a>
    <a id="12107" class="Comment">-----------------------------------------</a>
  <a id="12151" class="Symbol">→</a> <a id="12153" class="Symbol">∀{</a><a id="12155" href="/Substitution/#12155" class="Bound">A</a><a id="12156" class="Symbol">}</a> <a id="12158" class="Symbol">→</a> <a id="12160" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="12171" href="/Substitution/#12078" class="Bound">M</a> <a id="12173" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12175" class="Symbol">(</a><a id="12176" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="12187" href="/Substitution/#12080" class="Bound">M′</a><a id="12189" class="Symbol">)</a> <a id="12191" class="Symbol">{</a><a id="12192" href="/Substitution/#12155" class="Bound">A</a><a id="12193" class="Symbol">}</a>
<a id="12195" href="/Substitution/#12047" class="Function">cong-sub-zero</a> <a id="12209" class="Symbol">{</a><a id="12210" href="/Substitution/#12210" class="Bound">Γ</a><a id="12211" class="Symbol">}{</a><a id="12213" href="/Substitution/#12213" class="Bound">B</a><a id="12214" class="Symbol">}{</a><a id="12216" href="/Substitution/#12216" class="Bound">M</a><a id="12217" class="Symbol">}{</a><a id="12219" href="/Substitution/#12219" class="Bound">M′</a><a id="12221" class="Symbol">}</a> <a id="12223" href="/Substitution/#12223" class="Bound">mm&#39;</a> <a id="12227" class="Symbol">{</a><a id="12228" href="/Substitution/#12228" class="Bound">A</a><a id="12229" class="Symbol">}</a> <a id="12231" class="Symbol">=</a>
   <a id="12236" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="12251" class="Symbol">λ</a> <a id="12253" href="/Substitution/#12253" class="Bound">x</a> <a id="12255" class="Symbol">→</a> <a id="12257" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="12262" class="Symbol">(λ</a> <a id="12265" href="/Substitution/#12265" class="Bound">z</a> <a id="12267" class="Symbol">→</a> <a id="12269" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="12280" href="/Substitution/#12265" class="Bound">z</a> <a id="12282" href="/Substitution/#12253" class="Bound">x</a><a id="12283" class="Symbol">)</a> <a id="12285" href="/Substitution/#12223" class="Bound">mm&#39;</a></pre>

<pre class="Agda"><a id="cong-cons"></a><a id="12314" href="/Substitution/#12314" class="Function">cong-cons</a> <a id="12324" class="Symbol">:</a> <a id="12326" class="Symbol">∀{</a><a id="12328" href="/Substitution/#12328" class="Bound">Γ</a> <a id="12330" href="/Substitution/#12330" class="Bound">Δ</a><a id="12331" class="Symbol">}{</a><a id="12333" href="/Substitution/#12333" class="Bound">A</a><a id="12334" class="Symbol">}{</a><a id="12336" href="/Substitution/#12336" class="Bound">M</a> <a id="12338" href="/Substitution/#12338" class="Bound">N</a> <a id="12340" class="Symbol">:</a> <a id="12342" href="/Substitution/#12330" class="Bound">Δ</a> <a id="12344" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="12346" href="/Substitution/#12333" class="Bound">A</a><a id="12347" class="Symbol">}{</a><a id="12349" href="/Substitution/#12349" class="Bound">σ</a> <a id="12351" href="/Substitution/#12351" class="Bound">τ</a> <a id="12353" class="Symbol">:</a> <a id="12355" href="/Substitution/#2504" class="Function">Subst</a> <a id="12361" href="/Substitution/#12328" class="Bound">Γ</a> <a id="12363" href="/Substitution/#12330" class="Bound">Δ</a><a id="12364" class="Symbol">}</a>
  <a id="12368" class="Symbol">→</a> <a id="12370" href="/Substitution/#12336" class="Bound">M</a> <a id="12372" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12374" href="/Substitution/#12338" class="Bound">N</a>  <a id="12377" class="Symbol">→</a>  <a id="12380" class="Symbol">(∀{</a><a id="12383" href="/Substitution/#12383" class="Bound">A</a><a id="12384" class="Symbol">}</a> <a id="12386" class="Symbol">→</a> <a id="12388" href="/Substitution/#12349" class="Bound">σ</a> <a id="12390" class="Symbol">{</a><a id="12391" href="/Substitution/#12383" class="Bound">A</a><a id="12392" class="Symbol">}</a> <a id="12394" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12396" href="/Substitution/#12351" class="Bound">τ</a> <a id="12398" class="Symbol">{</a><a id="12399" href="/Substitution/#12383" class="Bound">A</a><a id="12400" class="Symbol">})</a>
    <a id="12407" class="Comment">--------------------------------</a>
  <a id="12442" class="Symbol">→</a> <a id="12444" class="Symbol">∀{</a><a id="12446" href="/Substitution/#12446" class="Bound">A</a><a id="12447" class="Symbol">}</a> <a id="12449" class="Symbol">→</a> <a id="12451" class="Symbol">(</a><a id="12452" href="/Substitution/#12336" class="Bound">M</a> <a id="12454" href="/Substitution/#3590" class="Function Operator">•</a> <a id="12456" href="/Substitution/#12349" class="Bound">σ</a><a id="12457" class="Symbol">)</a> <a id="12459" class="Symbol">{</a><a id="12460" href="/Substitution/#12446" class="Bound">A</a><a id="12461" class="Symbol">}</a> <a id="12463" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12465" class="Symbol">(</a><a id="12466" href="/Substitution/#12338" class="Bound">N</a> <a id="12468" href="/Substitution/#3590" class="Function Operator">•</a> <a id="12470" href="/Substitution/#12351" class="Bound">τ</a><a id="12471" class="Symbol">)</a> <a id="12473" class="Symbol">{</a><a id="12474" href="/Substitution/#12446" class="Bound">A</a><a id="12475" class="Symbol">}</a>
<a id="12477" href="/Substitution/#12314" class="Function">cong-cons</a><a id="12486" class="Symbol">{</a><a id="12487" href="/Substitution/#12487" class="Bound">Γ</a><a id="12488" class="Symbol">}{</a><a id="12490" href="/Substitution/#12490" class="Bound">Δ</a><a id="12491" class="Symbol">}{</a><a id="12493" href="/Substitution/#12493" class="Bound">A</a><a id="12494" class="Symbol">}{</a><a id="12496" href="/Substitution/#12496" class="Bound">M</a><a id="12497" class="Symbol">}{</a><a id="12499" href="/Substitution/#12499" class="Bound">N</a><a id="12500" class="Symbol">}{</a><a id="12502" href="/Substitution/#12502" class="Bound">σ</a><a id="12503" class="Symbol">}{</a><a id="12505" href="/Substitution/#12505" class="Bound">τ</a><a id="12506" class="Symbol">}</a> <a id="12508" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="12513" href="/Substitution/#12513" class="Bound">st</a> <a id="12516" class="Symbol">{</a><a id="12517" href="/Substitution/#12517" class="Bound">A′</a><a id="12519" class="Symbol">}</a> <a id="12521" class="Symbol">=</a> <a id="12523" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="12538" href="/Substitution/#12554" class="Function">lemma</a>
  <a id="12546" class="Keyword">where</a>
  <a id="12554" href="/Substitution/#12554" class="Function">lemma</a> <a id="12560" class="Symbol">:</a> <a id="12562" class="Symbol">(</a><a id="12563" href="/Substitution/#12563" class="Bound">x</a> <a id="12565" class="Symbol">:</a> <a id="12567" href="/Substitution/#12487" class="Bound">Γ</a> <a id="12569" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="12571" href="/Substitution/#12493" class="Bound">A</a> <a id="12573" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="12575" href="/Substitution/#12517" class="Bound">A′</a><a id="12577" class="Symbol">)</a> <a id="12579" class="Symbol">→</a> <a id="12581" class="Symbol">(</a><a id="12582" href="/Substitution/#12496" class="Bound">M</a> <a id="12584" href="/Substitution/#3590" class="Function Operator">•</a> <a id="12586" href="/Substitution/#12502" class="Bound">σ</a><a id="12587" class="Symbol">)</a> <a id="12589" href="/Substitution/#12563" class="Bound">x</a> <a id="12591" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12593" class="Symbol">(</a><a id="12594" href="/Substitution/#12496" class="Bound">M</a> <a id="12596" href="/Substitution/#3590" class="Function Operator">•</a> <a id="12598" href="/Substitution/#12505" class="Bound">τ</a><a id="12599" class="Symbol">)</a> <a id="12601" href="/Substitution/#12563" class="Bound">x</a>
  <a id="12605" href="/Substitution/#12554" class="Function">lemma</a> <a id="12611" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="12613" class="Symbol">=</a> <a id="12615" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="12622" href="/Substitution/#12554" class="Function">lemma</a> <a id="12628" class="Symbol">(</a><a id="12629" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="12631" href="/Substitution/#12631" class="Bound">x</a><a id="12632" class="Symbol">)</a> <a id="12634" class="Symbol">=</a> <a id="12636" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="12645" href="/Substitution/#12513" class="Bound">st</a> <a id="12648" href="/Substitution/#12631" class="Bound">x</a></pre>

<pre class="Agda"><a id="cong-seq"></a><a id="12675" href="/Substitution/#12675" class="Function">cong-seq</a> <a id="12684" class="Symbol">:</a> <a id="12686" class="Symbol">∀{</a><a id="12688" href="/Substitution/#12688" class="Bound">Γ</a> <a id="12690" href="/Substitution/#12690" class="Bound">Δ</a> <a id="12692" href="/Substitution/#12692" class="Bound">Σ</a><a id="12693" class="Symbol">}{</a><a id="12695" href="/Substitution/#12695" class="Bound">σ</a> <a id="12697" href="/Substitution/#12697" class="Bound">σ′</a> <a id="12700" class="Symbol">:</a> <a id="12702" href="/Substitution/#2504" class="Function">Subst</a> <a id="12708" href="/Substitution/#12688" class="Bound">Γ</a> <a id="12710" href="/Substitution/#12690" class="Bound">Δ</a><a id="12711" class="Symbol">}{</a><a id="12713" href="/Substitution/#12713" class="Bound">τ</a> <a id="12715" href="/Substitution/#12715" class="Bound">τ′</a> <a id="12718" class="Symbol">:</a> <a id="12720" href="/Substitution/#2504" class="Function">Subst</a> <a id="12726" href="/Substitution/#12690" class="Bound">Δ</a> <a id="12728" href="/Substitution/#12692" class="Bound">Σ</a><a id="12729" class="Symbol">}</a>
  <a id="12733" class="Symbol">→</a> <a id="12735" class="Symbol">(∀{</a><a id="12738" href="/Substitution/#12738" class="Bound">A</a><a id="12739" class="Symbol">}</a> <a id="12741" class="Symbol">→</a> <a id="12743" href="/Substitution/#12695" class="Bound">σ</a> <a id="12745" class="Symbol">{</a><a id="12746" href="/Substitution/#12738" class="Bound">A</a><a id="12747" class="Symbol">}</a> <a id="12749" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12751" href="/Substitution/#12697" class="Bound">σ′</a> <a id="12754" class="Symbol">{</a><a id="12755" href="/Substitution/#12738" class="Bound">A</a><a id="12756" class="Symbol">})</a> <a id="12759" class="Symbol">→</a> <a id="12761" class="Symbol">(∀{</a><a id="12764" href="/Substitution/#12764" class="Bound">A</a><a id="12765" class="Symbol">}</a> <a id="12767" class="Symbol">→</a> <a id="12769" href="/Substitution/#12713" class="Bound">τ</a> <a id="12771" class="Symbol">{</a><a id="12772" href="/Substitution/#12764" class="Bound">A</a><a id="12773" class="Symbol">}</a> <a id="12775" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12777" href="/Substitution/#12715" class="Bound">τ′</a> <a id="12780" class="Symbol">{</a><a id="12781" href="/Substitution/#12764" class="Bound">A</a><a id="12782" class="Symbol">})</a>
  <a id="12787" class="Symbol">→</a> <a id="12789" class="Symbol">∀{</a><a id="12791" href="/Substitution/#12791" class="Bound">A</a><a id="12792" class="Symbol">}</a> <a id="12794" class="Symbol">→</a> <a id="12796" class="Symbol">(</a><a id="12797" href="/Substitution/#12695" class="Bound">σ</a> <a id="12799" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="12801" href="/Substitution/#12713" class="Bound">τ</a><a id="12802" class="Symbol">)</a> <a id="12804" class="Symbol">{</a><a id="12805" href="/Substitution/#12791" class="Bound">A</a><a id="12806" class="Symbol">}</a> <a id="12808" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12810" class="Symbol">(</a><a id="12811" href="/Substitution/#12697" class="Bound">σ′</a> <a id="12814" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="12816" href="/Substitution/#12715" class="Bound">τ′</a><a id="12818" class="Symbol">)</a> <a id="12820" class="Symbol">{</a><a id="12821" href="/Substitution/#12791" class="Bound">A</a><a id="12822" class="Symbol">}</a>
<a id="12824" href="/Substitution/#12675" class="Function">cong-seq</a> <a id="12833" class="Symbol">{</a><a id="12834" href="/Substitution/#12834" class="Bound">Γ</a><a id="12835" class="Symbol">}{</a><a id="12837" href="/Substitution/#12837" class="Bound">Δ</a><a id="12838" class="Symbol">}{</a><a id="12840" href="/Substitution/#12840" class="Bound">Σ</a><a id="12841" class="Symbol">}{</a><a id="12843" href="/Substitution/#12843" class="Bound">σ</a><a id="12844" class="Symbol">}{</a><a id="12846" href="/Substitution/#12846" class="Bound">σ′</a><a id="12848" class="Symbol">}{</a><a id="12850" href="/Substitution/#12850" class="Bound">τ</a><a id="12851" class="Symbol">}{</a><a id="12853" href="/Substitution/#12853" class="Bound">τ′</a><a id="12855" class="Symbol">}</a> <a id="12857" href="/Substitution/#12857" class="Bound">ss&#39;</a> <a id="12861" href="/Substitution/#12861" class="Bound">tt&#39;</a> <a id="12865" class="Symbol">{</a><a id="12866" href="/Substitution/#12866" class="Bound">A</a><a id="12867" class="Symbol">}</a> <a id="12869" class="Symbol">=</a> <a id="12871" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="12886" href="/Substitution/#12902" class="Function">lemma</a>
  <a id="12894" class="Keyword">where</a>
  <a id="12902" href="/Substitution/#12902" class="Function">lemma</a> <a id="12908" class="Symbol">:</a> <a id="12910" class="Symbol">(</a><a id="12911" href="/Substitution/#12911" class="Bound">x</a> <a id="12913" class="Symbol">:</a> <a id="12915" href="/Substitution/#12834" class="Bound">Γ</a> <a id="12917" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="12919" href="/Substitution/#12866" class="Bound">A</a><a id="12920" class="Symbol">)</a> <a id="12922" class="Symbol">→</a> <a id="12924" class="Symbol">(</a><a id="12925" href="/Substitution/#12843" class="Bound">σ</a> <a id="12927" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="12929" href="/Substitution/#12850" class="Bound">τ</a><a id="12930" class="Symbol">)</a> <a id="12932" href="/Substitution/#12911" class="Bound">x</a> <a id="12934" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12936" class="Symbol">(</a><a id="12937" href="/Substitution/#12846" class="Bound">σ′</a> <a id="12940" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="12942" href="/Substitution/#12853" class="Bound">τ′</a><a id="12944" class="Symbol">)</a> <a id="12946" href="/Substitution/#12911" class="Bound">x</a>
  <a id="12950" href="/Substitution/#12902" class="Function">lemma</a> <a id="12956" href="/Substitution/#12956" class="Bound">x</a> <a id="12958" class="Symbol">=</a>
     <a id="12965" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="12978" class="Symbol">(</a><a id="12979" href="/Substitution/#12843" class="Bound">σ</a> <a id="12981" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="12983" href="/Substitution/#12850" class="Bound">τ</a><a id="12984" class="Symbol">)</a> <a id="12986" href="/Substitution/#12956" class="Bound">x</a>
     <a id="12993" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="13004" href="/Untyped/#6931" class="Function">subst</a> <a id="13010" href="/Substitution/#12850" class="Bound">τ</a> <a id="13012" class="Symbol">(</a><a id="13013" href="/Substitution/#12843" class="Bound">σ</a> <a id="13015" href="/Substitution/#12956" class="Bound">x</a><a id="13016" class="Symbol">)</a>
     <a id="13023" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="13026" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="13031" class="Symbol">(</a><a id="13032" href="/Untyped/#6931" class="Function">subst</a> <a id="13038" href="/Substitution/#12850" class="Bound">τ</a><a id="13039" class="Symbol">)</a> <a id="13041" class="Symbol">(</a><a id="13042" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="13051" href="/Substitution/#12857" class="Bound">ss&#39;</a> <a id="13055" href="/Substitution/#12956" class="Bound">x</a><a id="13056" class="Symbol">)</a> <a id="13058" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="13067" href="/Untyped/#6931" class="Function">subst</a> <a id="13073" href="/Substitution/#12850" class="Bound">τ</a> <a id="13075" class="Symbol">(</a><a id="13076" href="/Substitution/#12846" class="Bound">σ′</a> <a id="13079" href="/Substitution/#12956" class="Bound">x</a><a id="13080" class="Symbol">)</a>
     <a id="13087" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="13090" href="/Substitution/#11543" class="Function">cong-sub</a><a id="13098" class="Symbol">{</a><a id="13099" class="Argument">M</a> <a id="13101" class="Symbol">=</a> <a id="13103" href="/Substitution/#12846" class="Bound">σ′</a> <a id="13106" href="/Substitution/#12956" class="Bound">x</a><a id="13107" class="Symbol">}</a> <a id="13109" href="/Substitution/#12861" class="Bound">tt&#39;</a> <a id="13113" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="13118" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="13127" href="/Untyped/#6931" class="Function">subst</a> <a id="13133" href="/Substitution/#12853" class="Bound">τ′</a> <a id="13136" class="Symbol">(</a><a id="13137" href="/Substitution/#12846" class="Bound">σ′</a> <a id="13140" href="/Substitution/#12956" class="Bound">x</a><a id="13141" class="Symbol">)</a>
     <a id="13148" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="13159" class="Symbol">(</a><a id="13160" href="/Substitution/#12846" class="Bound">σ′</a> <a id="13163" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="13165" href="/Substitution/#12853" class="Bound">τ′</a><a id="13167" class="Symbol">)</a> <a id="13169" href="/Substitution/#12956" class="Bound">x</a>
     <a id="13176" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="relating-rename-exts-ext-and-subst-zero-to-the-σ-algebra">Relating <code class="highlighter-rouge">rename</code>, <code class="highlighter-rouge">exts</code>, <code class="highlighter-rouge">ext</code>, and <code class="highlighter-rouge">subst-zero</code> to the σ algebra</h2>

<p>In this section we establish equations that relate <code class="highlighter-rouge">subst</code> and its
helper functions (<code class="highlighter-rouge">rename</code>, <code class="highlighter-rouge">exts</code>, <code class="highlighter-rouge">ext</code>, and <code class="highlighter-rouge">subst-zero</code>) to terms
in the σ algebra.</p>

<p>The first equation we prove is</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ M ≡ ⟪ ren ρ ⟫ M              (rename-subst-ren)
</code></pre></div></div>

<p>Because <code class="highlighter-rouge">subst</code> uses the <code class="highlighter-rouge">exts</code> function, we need the following lemma
which says that <code class="highlighter-rouge">exts</code> and <code class="highlighter-rouge">ext</code> do the same thing except that <code class="highlighter-rouge">ext</code>
works on renamings and <code class="highlighter-rouge">exts</code> works on substitutions.</p>

<pre class="Agda"><a id="ren-ext"></a><a id="13720" href="/Substitution/#13720" class="Function">ren-ext</a> <a id="13728" class="Symbol">:</a> <a id="13730" class="Symbol">∀</a> <a id="13732" class="Symbol">{</a><a id="13733" href="/Substitution/#13733" class="Bound">Γ</a> <a id="13735" href="/Substitution/#13735" class="Bound">Δ</a><a id="13736" class="Symbol">}{</a><a id="13738" href="/Substitution/#13738" class="Bound">B</a> <a id="13740" href="/Substitution/#13740" class="Bound">C</a> <a id="13742" class="Symbol">:</a> <a id="13744" href="/Untyped/#2675" class="Datatype">Type</a><a id="13748" class="Symbol">}</a> <a id="13750" class="Symbol">{</a><a id="13751" href="/Substitution/#13751" class="Bound">ρ</a> <a id="13753" class="Symbol">:</a> <a id="13755" href="/Substitution/#2275" class="Function">Rename</a> <a id="13762" href="/Substitution/#13733" class="Bound">Γ</a> <a id="13764" href="/Substitution/#13735" class="Bound">Δ</a><a id="13765" class="Symbol">}</a>
        <a id="13775" class="Symbol">→</a> <a id="13777" href="/Substitution/#6693" class="Function">ren</a> <a id="13781" class="Symbol">(</a><a id="13782" href="/Untyped/#5845" class="Function">ext</a> <a id="13786" href="/Substitution/#13751" class="Bound">ρ</a> <a id="13788" class="Symbol">{</a><a id="13789" class="Argument">B</a> <a id="13791" class="Symbol">=</a> <a id="13793" href="/Substitution/#13738" class="Bound">B</a><a id="13794" class="Symbol">})</a> <a id="13797" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="13799" href="/Untyped/#6623" class="Function">exts</a> <a id="13804" class="Symbol">(</a><a id="13805" href="/Substitution/#6693" class="Function">ren</a> <a id="13809" href="/Substitution/#13751" class="Bound">ρ</a><a id="13810" class="Symbol">)</a> <a id="13812" class="Symbol">{</a><a id="13813" href="/Substitution/#13740" class="Bound">C</a><a id="13814" class="Symbol">}</a>
<a id="13816" href="/Substitution/#13720" class="Function">ren-ext</a> <a id="13824" class="Symbol">{</a><a id="13825" href="/Substitution/#13825" class="Bound">Γ</a><a id="13826" class="Symbol">}{</a><a id="13828" href="/Substitution/#13828" class="Bound">Δ</a><a id="13829" class="Symbol">}{</a><a id="13831" href="/Substitution/#13831" class="Bound">B</a><a id="13832" class="Symbol">}{</a><a id="13834" href="/Substitution/#13834" class="Bound">C</a><a id="13835" class="Symbol">}{</a><a id="13837" href="/Substitution/#13837" class="Bound">ρ</a><a id="13838" class="Symbol">}</a> <a id="13840" class="Symbol">=</a> <a id="13842" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="13857" class="Symbol">λ</a> <a id="13859" href="/Substitution/#13859" class="Bound">x</a> <a id="13861" class="Symbol">→</a> <a id="13863" href="/Substitution/#13887" class="Function">lemma</a> <a id="13869" class="Symbol">{</a><a id="13870" class="Argument">x</a> <a id="13872" class="Symbol">=</a> <a id="13874" href="/Substitution/#13859" class="Bound">x</a><a id="13875" class="Symbol">}</a>
  <a id="13879" class="Keyword">where</a>
  <a id="13887" href="/Substitution/#13887" class="Function">lemma</a> <a id="13893" class="Symbol">:</a> <a id="13895" class="Symbol">∀</a> <a id="13897" class="Symbol">{</a><a id="13898" href="/Substitution/#13898" class="Bound">x</a> <a id="13900" class="Symbol">:</a> <a id="13902" href="/Substitution/#13825" class="Bound">Γ</a> <a id="13904" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="13906" href="/Substitution/#13831" class="Bound">B</a> <a id="13908" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="13910" href="/Substitution/#13834" class="Bound">C</a><a id="13911" class="Symbol">}</a> <a id="13913" class="Symbol">→</a> <a id="13915" class="Symbol">(</a><a id="13916" href="/Substitution/#6693" class="Function">ren</a> <a id="13920" class="Symbol">(</a><a id="13921" href="/Untyped/#5845" class="Function">ext</a> <a id="13925" href="/Substitution/#13837" class="Bound">ρ</a><a id="13926" class="Symbol">))</a> <a id="13929" href="/Substitution/#13898" class="Bound">x</a> <a id="13931" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="13933" href="/Untyped/#6623" class="Function">exts</a> <a id="13938" class="Symbol">(</a><a id="13939" href="/Substitution/#6693" class="Function">ren</a> <a id="13943" href="/Substitution/#13837" class="Bound">ρ</a><a id="13944" class="Symbol">)</a> <a id="13946" href="/Substitution/#13898" class="Bound">x</a>
  <a id="13950" href="/Substitution/#13887" class="Function">lemma</a> <a id="13956" class="Symbol">{</a><a id="13957" class="Argument">x</a> <a id="13959" class="Symbol">=</a> <a id="13961" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="13962" class="Symbol">}</a> <a id="13964" class="Symbol">=</a> <a id="13966" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="13973" href="/Substitution/#13887" class="Function">lemma</a> <a id="13979" class="Symbol">{</a><a id="13980" class="Argument">x</a> <a id="13982" class="Symbol">=</a> <a id="13984" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="13986" href="/Substitution/#13986" class="Bound">x</a><a id="13987" class="Symbol">}</a> <a id="13989" class="Symbol">=</a> <a id="13991" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<p>With this lemma in hand, the proof is a straightforward induction on
the term <code class="highlighter-rouge">M</code>.</p>

<pre class="Agda"><a id="rename-subst-ren"></a><a id="14105" href="/Substitution/#14105" class="Function">rename-subst-ren</a> <a id="14122" class="Symbol">:</a> <a id="14124" class="Symbol">∀</a> <a id="14126" class="Symbol">{</a><a id="14127" href="/Substitution/#14127" class="Bound">Γ</a> <a id="14129" href="/Substitution/#14129" class="Bound">Δ</a><a id="14130" class="Symbol">}{</a><a id="14132" href="/Substitution/#14132" class="Bound">A</a><a id="14133" class="Symbol">}</a> <a id="14135" class="Symbol">{</a><a id="14136" href="/Substitution/#14136" class="Bound">ρ</a> <a id="14138" class="Symbol">:</a> <a id="14140" href="/Substitution/#2275" class="Function">Rename</a> <a id="14147" href="/Substitution/#14127" class="Bound">Γ</a> <a id="14149" href="/Substitution/#14129" class="Bound">Δ</a><a id="14150" class="Symbol">}{</a><a id="14152" href="/Substitution/#14152" class="Bound">M</a> <a id="14154" class="Symbol">:</a> <a id="14156" href="/Substitution/#14127" class="Bound">Γ</a> <a id="14158" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="14160" href="/Substitution/#14132" class="Bound">A</a><a id="14161" class="Symbol">}</a>
                 <a id="14180" class="Symbol">→</a> <a id="14182" href="/Untyped/#6171" class="Function">rename</a> <a id="14189" href="/Substitution/#14136" class="Bound">ρ</a> <a id="14191" href="/Substitution/#14152" class="Bound">M</a> <a id="14193" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="14195" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="14197" href="/Substitution/#6693" class="Function">ren</a> <a id="14201" href="/Substitution/#14136" class="Bound">ρ</a> <a id="14203" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="14205" href="/Substitution/#14152" class="Bound">M</a>
<a id="14207" href="/Substitution/#14105" class="Function">rename-subst-ren</a> <a id="14224" class="Symbol">{</a><a id="14225" class="Argument">M</a> <a id="14227" class="Symbol">=</a> <a id="14229" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="14231" href="/Substitution/#14231" class="Bound">x</a><a id="14232" class="Symbol">}</a> <a id="14234" class="Symbol">=</a> <a id="14236" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="14241" href="/Substitution/#14105" class="Function">rename-subst-ren</a> <a id="14258" class="Symbol">{</a><a id="14259" class="Argument">ρ</a> <a id="14261" class="Symbol">=</a> <a id="14263" href="/Substitution/#14263" class="Bound">ρ</a><a id="14264" class="Symbol">}{</a><a id="14266" class="Argument">M</a> <a id="14268" class="Symbol">=</a> <a id="14270" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="14272" href="/Substitution/#14272" class="Bound">N</a><a id="14273" class="Symbol">}</a> <a id="14275" class="Symbol">=</a>
  <a id="14279" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
      <a id="14291" href="/Untyped/#6171" class="Function">rename</a> <a id="14298" href="/Substitution/#14263" class="Bound">ρ</a> <a id="14300" class="Symbol">(</a><a id="14301" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="14303" href="/Substitution/#14272" class="Bound">N</a><a id="14304" class="Symbol">)</a>
    <a id="14310" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
      <a id="14320" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="14322" href="/Untyped/#6171" class="Function">rename</a> <a id="14329" class="Symbol">(</a><a id="14330" href="/Untyped/#5845" class="Function">ext</a> <a id="14334" href="/Substitution/#14263" class="Bound">ρ</a><a id="14335" class="Symbol">)</a> <a id="14337" href="/Substitution/#14272" class="Bound">N</a>
    <a id="14343" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="14346" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="14351" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="14354" class="Symbol">(</a><a id="14355" href="/Substitution/#14105" class="Function">rename-subst-ren</a> <a id="14372" class="Symbol">{</a><a id="14373" class="Argument">ρ</a> <a id="14375" class="Symbol">=</a> <a id="14377" href="/Untyped/#5845" class="Function">ext</a> <a id="14381" href="/Substitution/#14263" class="Bound">ρ</a><a id="14382" class="Symbol">}{</a><a id="14384" class="Argument">M</a> <a id="14386" class="Symbol">=</a> <a id="14388" href="/Substitution/#14272" class="Bound">N</a><a id="14389" class="Symbol">})</a> <a id="14392" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="14400" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="14402" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="14404" href="/Substitution/#6693" class="Function">ren</a> <a id="14408" class="Symbol">(</a><a id="14409" href="/Untyped/#5845" class="Function">ext</a> <a id="14413" href="/Substitution/#14263" class="Bound">ρ</a><a id="14414" class="Symbol">)</a> <a id="14416" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="14418" href="/Substitution/#14272" class="Bound">N</a>
    <a id="14424" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="14427" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="14432" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="14435" class="Symbol">(</a><a id="14436" href="/Substitution/#11543" class="Function">cong-sub</a> <a id="14445" class="Symbol">{</a><a id="14446" class="Argument">M</a> <a id="14448" class="Symbol">=</a> <a id="14450" href="/Substitution/#14272" class="Bound">N</a><a id="14451" class="Symbol">}</a> <a id="14453" href="/Substitution/#13720" class="Function">ren-ext</a> <a id="14461" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="14465" class="Symbol">)</a> <a id="14467" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="14475" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="14477" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="14479" href="/Untyped/#6623" class="Function">exts</a> <a id="14484" class="Symbol">(</a><a id="14485" href="/Substitution/#6693" class="Function">ren</a> <a id="14489" href="/Substitution/#14263" class="Bound">ρ</a><a id="14490" class="Symbol">)</a> <a id="14492" href="/Substitution/#2661" class="Function Operator">⟫</a>  <a id="14495" href="/Substitution/#14272" class="Bound">N</a>
    <a id="14501" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
      <a id="14511" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="14513" href="/Substitution/#6693" class="Function">ren</a> <a id="14517" href="/Substitution/#14263" class="Bound">ρ</a> <a id="14519" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="14521" class="Symbol">(</a><a id="14522" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="14524" href="/Substitution/#14272" class="Bound">N</a><a id="14525" class="Symbol">)</a>
  <a id="14529" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>
<a id="14531" href="/Substitution/#14105" class="Function">rename-subst-ren</a> <a id="14548" class="Symbol">{</a><a id="14549" class="Argument">M</a> <a id="14551" class="Symbol">=</a> <a id="14553" href="/Substitution/#14553" class="Bound">L</a> <a id="14555" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="14557" href="/Substitution/#14557" class="Bound">M</a><a id="14558" class="Symbol">}</a> <a id="14560" class="Symbol">=</a> <a id="14562" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="14568" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="14572" href="/Substitution/#14105" class="Function">rename-subst-ren</a> <a id="14589" href="/Substitution/#14105" class="Function">rename-subst-ren</a></pre>

<p>The substitution <code class="highlighter-rouge">ren S_</code> is equivalent to <code class="highlighter-rouge">↑</code>.</p>

<pre class="Agda"><a id="ren-shift"></a><a id="14680" href="/Substitution/#14680" class="Function">ren-shift</a> <a id="14690" class="Symbol">:</a> <a id="14692" class="Symbol">∀{</a><a id="14694" href="/Substitution/#14694" class="Bound">Γ</a><a id="14695" class="Symbol">}{</a><a id="14697" href="/Substitution/#14697" class="Bound">A</a><a id="14698" class="Symbol">}{</a><a id="14700" href="/Substitution/#14700" class="Bound">B</a><a id="14701" class="Symbol">}</a>
          <a id="14713" class="Symbol">→</a> <a id="14715" href="/Substitution/#6693" class="Function">ren</a> <a id="14719" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="14722" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="14724" href="/Substitution/#3332" class="Function">↑</a> <a id="14726" class="Symbol">{</a><a id="14727" class="Argument">A</a> <a id="14729" class="Symbol">=</a> <a id="14731" href="/Substitution/#14700" class="Bound">B</a><a id="14732" class="Symbol">}</a> <a id="14734" class="Symbol">{</a><a id="14735" href="/Substitution/#14697" class="Bound">A</a><a id="14736" class="Symbol">}</a>
<a id="14738" href="/Substitution/#14680" class="Function">ren-shift</a> <a id="14748" class="Symbol">{</a><a id="14749" href="/Substitution/#14749" class="Bound">Γ</a><a id="14750" class="Symbol">}{</a><a id="14752" href="/Substitution/#14752" class="Bound">A</a><a id="14753" class="Symbol">}{</a><a id="14755" href="/Substitution/#14755" class="Bound">B</a><a id="14756" class="Symbol">}</a> <a id="14758" class="Symbol">=</a> <a id="14760" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="14775" class="Symbol">λ</a> <a id="14777" href="/Substitution/#14777" class="Bound">x</a> <a id="14779" class="Symbol">→</a> <a id="14781" href="/Substitution/#14805" class="Function">lemma</a> <a id="14787" class="Symbol">{</a><a id="14788" class="Argument">x</a> <a id="14790" class="Symbol">=</a> <a id="14792" href="/Substitution/#14777" class="Bound">x</a><a id="14793" class="Symbol">}</a>
  <a id="14797" class="Keyword">where</a>
  <a id="14805" href="/Substitution/#14805" class="Function">lemma</a> <a id="14811" class="Symbol">:</a> <a id="14813" class="Symbol">∀</a> <a id="14815" class="Symbol">{</a><a id="14816" href="/Substitution/#14816" class="Bound">x</a> <a id="14818" class="Symbol">:</a> <a id="14820" href="/Substitution/#14749" class="Bound">Γ</a> <a id="14822" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="14824" href="/Substitution/#14752" class="Bound">A</a><a id="14825" class="Symbol">}</a> <a id="14827" class="Symbol">→</a> <a id="14829" href="/Substitution/#6693" class="Function">ren</a> <a id="14833" class="Symbol">(</a><a id="14834" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="14836" class="Symbol">{</a><a id="14837" class="Argument">B</a> <a id="14839" class="Symbol">=</a> <a id="14841" href="/Substitution/#14755" class="Bound">B</a><a id="14842" class="Symbol">})</a> <a id="14845" href="/Substitution/#14816" class="Bound">x</a> <a id="14847" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="14849" href="/Substitution/#3332" class="Function">↑</a> <a id="14851" class="Symbol">{</a><a id="14852" class="Argument">A</a> <a id="14854" class="Symbol">=</a> <a id="14856" href="/Substitution/#14755" class="Bound">B</a><a id="14857" class="Symbol">}</a> <a id="14859" href="/Substitution/#14816" class="Bound">x</a>
  <a id="14863" href="/Substitution/#14805" class="Function">lemma</a> <a id="14869" class="Symbol">{</a><a id="14870" class="Argument">x</a> <a id="14872" class="Symbol">=</a> <a id="14874" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="14875" class="Symbol">}</a> <a id="14877" class="Symbol">=</a> <a id="14879" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="14886" href="/Substitution/#14805" class="Function">lemma</a> <a id="14892" class="Symbol">{</a><a id="14893" class="Argument">x</a> <a id="14895" class="Symbol">=</a> <a id="14897" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="14899" href="/Substitution/#14899" class="Bound">x</a><a id="14900" class="Symbol">}</a> <a id="14902" class="Symbol">=</a> <a id="14904" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<p>The substitution <code class="highlighter-rouge">rename S_ M</code> is equivalent to shifting: <code class="highlighter-rouge">⟪ ↑ ⟫ M</code>.</p>

<pre class="Agda"><a id="rename-shift"></a><a id="15004" href="/Substitution/#15004" class="Function">rename-shift</a> <a id="15017" class="Symbol">:</a> <a id="15019" class="Symbol">∀{</a><a id="15021" href="/Substitution/#15021" class="Bound">Γ</a><a id="15022" class="Symbol">}</a> <a id="15024" class="Symbol">{</a><a id="15025" href="/Substitution/#15025" class="Bound">A</a><a id="15026" class="Symbol">}</a> <a id="15028" class="Symbol">{</a><a id="15029" href="/Substitution/#15029" class="Bound">B</a><a id="15030" class="Symbol">}</a> <a id="15032" class="Symbol">{</a><a id="15033" href="/Substitution/#15033" class="Bound">M</a> <a id="15035" class="Symbol">:</a> <a id="15037" href="/Substitution/#15021" class="Bound">Γ</a> <a id="15039" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="15041" href="/Substitution/#15025" class="Bound">A</a><a id="15042" class="Symbol">}</a>
             <a id="15057" class="Symbol">→</a> <a id="15059" href="/Untyped/#6171" class="Function">rename</a> <a id="15066" class="Symbol">(</a><a id="15067" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="15069" class="Symbol">{</a><a id="15070" class="Argument">B</a> <a id="15072" class="Symbol">=</a> <a id="15074" href="/Substitution/#15029" class="Bound">B</a><a id="15075" class="Symbol">})</a> <a id="15078" href="/Substitution/#15033" class="Bound">M</a> <a id="15080" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="15082" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="15084" href="/Substitution/#3332" class="Function">↑</a> <a id="15086" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="15088" href="/Substitution/#15033" class="Bound">M</a>
<a id="15090" href="/Substitution/#15004" class="Function">rename-shift</a><a id="15102" class="Symbol">{</a><a id="15103" href="/Substitution/#15103" class="Bound">Γ</a><a id="15104" class="Symbol">}{</a><a id="15106" href="/Substitution/#15106" class="Bound">A</a><a id="15107" class="Symbol">}{</a><a id="15109" href="/Substitution/#15109" class="Bound">B</a><a id="15110" class="Symbol">}{</a><a id="15112" href="/Substitution/#15112" class="Bound">M</a><a id="15113" class="Symbol">}</a> <a id="15115" class="Symbol">=</a>
  <a id="15119" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
    <a id="15129" href="/Untyped/#6171" class="Function">rename</a> <a id="15136" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="15139" href="/Substitution/#15112" class="Bound">M</a>
  <a id="15143" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="15146" href="/Substitution/#14105" class="Function">rename-subst-ren</a> <a id="15163" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
    <a id="15169" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="15171" href="/Substitution/#6693" class="Function">ren</a> <a id="15175" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="15178" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="15180" href="/Substitution/#15112" class="Bound">M</a>
  <a id="15184" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="15187" href="/Substitution/#11543" class="Function">cong-sub</a><a id="15195" class="Symbol">{</a><a id="15196" class="Argument">M</a> <a id="15198" class="Symbol">=</a> <a id="15200" href="/Substitution/#15112" class="Bound">M</a><a id="15201" class="Symbol">}</a> <a id="15203" href="/Substitution/#14680" class="Function">ren-shift</a> <a id="15213" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="15218" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
    <a id="15224" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="15226" href="/Substitution/#3332" class="Function">↑</a> <a id="15228" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="15230" href="/Substitution/#15112" class="Bound">M</a>
  <a id="15234" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>Next we prove the equation <code class="highlighter-rouge">exts-cons-shift</code>, which states that <code class="highlighter-rouge">exts</code>
is equivalent to cons’ing Z onto the sequence formed by applying <code class="highlighter-rouge">σ</code>
and then shifting. The proof is by case analysis on the variable <code class="highlighter-rouge">x</code>,
using <code class="highlighter-rouge">rename-subst-ren</code> for when <code class="highlighter-rouge">x = S y</code>.</p>

<pre class="Agda"><a id="exts-cons-shift"></a><a id="15517" href="/Substitution/#15517" class="Function">exts-cons-shift</a> <a id="15533" class="Symbol">:</a> <a id="15535" class="Symbol">∀{</a><a id="15537" href="/Substitution/#15537" class="Bound">Γ</a> <a id="15539" href="/Substitution/#15539" class="Bound">Δ</a><a id="15540" class="Symbol">}</a> <a id="15542" class="Symbol">{</a><a id="15543" href="/Substitution/#15543" class="Bound">A</a> <a id="15545" href="/Substitution/#15545" class="Bound">B</a><a id="15546" class="Symbol">}</a> <a id="15548" class="Symbol">{</a><a id="15549" href="/Substitution/#15549" class="Bound">σ</a> <a id="15551" class="Symbol">:</a> <a id="15553" href="/Substitution/#2504" class="Function">Subst</a> <a id="15559" href="/Substitution/#15537" class="Bound">Γ</a> <a id="15561" href="/Substitution/#15539" class="Bound">Δ</a><a id="15562" class="Symbol">}</a>
                <a id="15580" class="Symbol">→</a> <a id="15582" href="/Untyped/#6623" class="Function">exts</a> <a id="15587" href="/Substitution/#15549" class="Bound">σ</a> <a id="15589" class="Symbol">{</a><a id="15590" href="/Substitution/#15543" class="Bound">A</a><a id="15591" class="Symbol">}</a> <a id="15593" class="Symbol">{</a><a id="15594" href="/Substitution/#15545" class="Bound">B</a><a id="15595" class="Symbol">}</a> <a id="15597" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="15599" class="Symbol">(</a><a id="15600" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="15602" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="15604" href="/Substitution/#3590" class="Function Operator">•</a> <a id="15606" class="Symbol">(</a><a id="15607" href="/Substitution/#15549" class="Bound">σ</a> <a id="15609" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="15611" href="/Substitution/#3332" class="Function">↑</a><a id="15612" class="Symbol">))</a>
<a id="15615" href="/Substitution/#15517" class="Function">exts-cons-shift</a> <a id="15631" class="Symbol">=</a> <a id="15633" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="15648" class="Symbol">λ</a> <a id="15650" href="/Substitution/#15650" class="Bound">x</a> <a id="15652" class="Symbol">→</a> <a id="15654" href="/Substitution/#15677" class="Function">lemma</a><a id="15659" class="Symbol">{</a><a id="15660" class="Argument">x</a> <a id="15662" class="Symbol">=</a> <a id="15664" href="/Substitution/#15650" class="Bound">x</a><a id="15665" class="Symbol">}</a>
  <a id="15669" class="Keyword">where</a>
  <a id="15677" href="/Substitution/#15677" class="Function">lemma</a> <a id="15683" class="Symbol">:</a> <a id="15685" class="Symbol">∀{</a><a id="15687" href="/Substitution/#15687" class="Bound">Γ</a> <a id="15689" href="/Substitution/#15689" class="Bound">Δ</a><a id="15690" class="Symbol">}</a> <a id="15692" class="Symbol">{</a><a id="15693" href="/Substitution/#15693" class="Bound">A</a> <a id="15695" href="/Substitution/#15695" class="Bound">B</a><a id="15696" class="Symbol">}</a> <a id="15698" class="Symbol">{</a><a id="15699" href="/Substitution/#15699" class="Bound">σ</a> <a id="15701" class="Symbol">:</a> <a id="15703" href="/Substitution/#2504" class="Function">Subst</a> <a id="15709" href="/Substitution/#15687" class="Bound">Γ</a> <a id="15711" href="/Substitution/#15689" class="Bound">Δ</a><a id="15712" class="Symbol">}</a> <a id="15714" class="Symbol">{</a><a id="15715" href="/Substitution/#15715" class="Bound">x</a> <a id="15717" class="Symbol">:</a> <a id="15719" href="/Substitution/#15687" class="Bound">Γ</a> <a id="15721" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="15723" href="/Substitution/#15695" class="Bound">B</a> <a id="15725" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="15727" href="/Substitution/#15693" class="Bound">A</a><a id="15728" class="Symbol">}</a>
                  <a id="15748" class="Symbol">→</a> <a id="15750" href="/Untyped/#6623" class="Function">exts</a> <a id="15755" href="/Substitution/#15699" class="Bound">σ</a> <a id="15757" href="/Substitution/#15715" class="Bound">x</a> <a id="15759" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="15761" class="Symbol">(</a><a id="15762" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="15764" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="15766" href="/Substitution/#3590" class="Function Operator">•</a> <a id="15768" class="Symbol">(</a><a id="15769" href="/Substitution/#15699" class="Bound">σ</a> <a id="15771" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="15773" href="/Substitution/#3332" class="Function">↑</a><a id="15774" class="Symbol">))</a> <a id="15777" href="/Substitution/#15715" class="Bound">x</a>
  <a id="15781" href="/Substitution/#15677" class="Function">lemma</a> <a id="15787" class="Symbol">{</a><a id="15788" class="Argument">x</a> <a id="15790" class="Symbol">=</a> <a id="15792" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="15793" class="Symbol">}</a> <a id="15795" class="Symbol">=</a> <a id="15797" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="15804" href="/Substitution/#15677" class="Function">lemma</a> <a id="15810" class="Symbol">{</a><a id="15811" class="Argument">x</a> <a id="15813" class="Symbol">=</a> <a id="15815" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="15817" href="/Substitution/#15817" class="Bound">y</a><a id="15818" class="Symbol">}</a> <a id="15820" class="Symbol">=</a> <a id="15822" href="/Substitution/#14105" class="Function">rename-subst-ren</a></pre>

<p>As a corollary, we have a similar correspondence for <code class="highlighter-rouge">ren (ext ρ)</code>.</p>

<pre class="Agda"><a id="ext-cons-Z-shift"></a><a id="15933" href="/Substitution/#15933" class="Function">ext-cons-Z-shift</a> <a id="15950" class="Symbol">:</a> <a id="15952" class="Symbol">∀{</a><a id="15954" href="/Substitution/#15954" class="Bound">Γ</a> <a id="15956" href="/Substitution/#15956" class="Bound">Δ</a><a id="15957" class="Symbol">}</a> <a id="15959" class="Symbol">{</a><a id="15960" href="/Substitution/#15960" class="Bound">ρ</a> <a id="15962" class="Symbol">:</a> <a id="15964" href="/Substitution/#2275" class="Function">Rename</a> <a id="15971" href="/Substitution/#15954" class="Bound">Γ</a> <a id="15973" href="/Substitution/#15956" class="Bound">Δ</a><a id="15974" class="Symbol">}{</a><a id="15976" href="/Substitution/#15976" class="Bound">A</a><a id="15977" class="Symbol">}{</a><a id="15979" href="/Substitution/#15979" class="Bound">B</a><a id="15980" class="Symbol">}</a>
                 <a id="15999" class="Symbol">→</a> <a id="16001" href="/Substitution/#6693" class="Function">ren</a> <a id="16005" class="Symbol">(</a><a id="16006" href="/Untyped/#5845" class="Function">ext</a> <a id="16010" href="/Substitution/#15960" class="Bound">ρ</a> <a id="16012" class="Symbol">{</a><a id="16013" class="Argument">B</a> <a id="16015" class="Symbol">=</a> <a id="16017" href="/Substitution/#15979" class="Bound">B</a><a id="16018" class="Symbol">})</a> <a id="16021" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="16023" class="Symbol">(</a><a id="16024" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="16026" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="16028" href="/Substitution/#3590" class="Function Operator">•</a> <a id="16030" class="Symbol">(</a><a id="16031" href="/Substitution/#6693" class="Function">ren</a> <a id="16035" href="/Substitution/#15960" class="Bound">ρ</a> <a id="16037" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="16039" href="/Substitution/#3332" class="Function">↑</a><a id="16040" class="Symbol">))</a> <a id="16043" class="Symbol">{</a><a id="16044" href="/Substitution/#15976" class="Bound">A</a><a id="16045" class="Symbol">}</a>
<a id="16047" href="/Substitution/#15933" class="Function">ext-cons-Z-shift</a> <a id="16064" class="Symbol">{</a><a id="16065" href="/Substitution/#16065" class="Bound">Γ</a><a id="16066" class="Symbol">}{</a><a id="16068" href="/Substitution/#16068" class="Bound">Δ</a><a id="16069" class="Symbol">}{</a><a id="16071" href="/Substitution/#16071" class="Bound">ρ</a><a id="16072" class="Symbol">}{</a><a id="16074" href="/Substitution/#16074" class="Bound">A</a><a id="16075" class="Symbol">}{</a><a id="16077" href="/Substitution/#16077" class="Bound">B</a><a id="16078" class="Symbol">}</a> <a id="16080" class="Symbol">=</a>
  <a id="16084" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
    <a id="16094" href="/Substitution/#6693" class="Function">ren</a> <a id="16098" class="Symbol">(</a><a id="16099" href="/Untyped/#5845" class="Function">ext</a> <a id="16103" href="/Substitution/#16071" class="Bound">ρ</a><a id="16104" class="Symbol">)</a>
  <a id="16108" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="16111" href="/Substitution/#13720" class="Function">ren-ext</a> <a id="16119" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
    <a id="16125" href="/Untyped/#6623" class="Function">exts</a> <a id="16130" class="Symbol">(</a><a id="16131" href="/Substitution/#6693" class="Function">ren</a> <a id="16135" href="/Substitution/#16071" class="Bound">ρ</a><a id="16136" class="Symbol">)</a>
  <a id="16140" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="16143" href="/Substitution/#15517" class="Function">exts-cons-shift</a><a id="16158" class="Symbol">{</a><a id="16159" class="Argument">σ</a> <a id="16161" class="Symbol">=</a> <a id="16163" href="/Substitution/#6693" class="Function">ren</a> <a id="16167" href="/Substitution/#16071" class="Bound">ρ</a><a id="16168" class="Symbol">}</a> <a id="16170" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
   <a id="16175" class="Symbol">((</a><a id="16177" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="16179" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="16180" class="Symbol">)</a> <a id="16182" href="/Substitution/#3590" class="Function Operator">•</a> <a id="16184" class="Symbol">(</a><a id="16185" href="/Substitution/#6693" class="Function">ren</a> <a id="16189" href="/Substitution/#16071" class="Bound">ρ</a> <a id="16191" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="16193" href="/Substitution/#3332" class="Function">↑</a><a id="16194" class="Symbol">))</a>
  <a id="16199" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>Finally, the <code class="highlighter-rouge">subst-zero M</code> substitution is equivalent to cons’ing <code class="highlighter-rouge">M</code>
onto the identity substitution.</p>

<pre class="Agda"><a id="subst-Z-cons-ids"></a><a id="16330" href="/Substitution/#16330" class="Function">subst-Z-cons-ids</a> <a id="16347" class="Symbol">:</a> <a id="16349" class="Symbol">∀{</a><a id="16351" href="/Substitution/#16351" class="Bound">Γ</a><a id="16352" class="Symbol">}{</a><a id="16354" href="/Substitution/#16354" class="Bound">A</a> <a id="16356" href="/Substitution/#16356" class="Bound">B</a> <a id="16358" class="Symbol">:</a> <a id="16360" href="/Untyped/#2675" class="Datatype">Type</a><a id="16364" class="Symbol">}{</a><a id="16366" href="/Substitution/#16366" class="Bound">M</a> <a id="16368" class="Symbol">:</a> <a id="16370" href="/Substitution/#16351" class="Bound">Γ</a> <a id="16372" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="16374" href="/Substitution/#16356" class="Bound">B</a><a id="16375" class="Symbol">}</a>
                 <a id="16394" class="Symbol">→</a> <a id="16396" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="16407" href="/Substitution/#16366" class="Bound">M</a> <a id="16409" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="16411" class="Symbol">(</a><a id="16412" href="/Substitution/#16366" class="Bound">M</a> <a id="16414" href="/Substitution/#3590" class="Function Operator">•</a> <a id="16416" href="/Substitution/#3177" class="Function">ids</a><a id="16419" class="Symbol">)</a> <a id="16421" class="Symbol">{</a><a id="16422" href="/Substitution/#16354" class="Bound">A</a><a id="16423" class="Symbol">}</a>
<a id="16425" href="/Substitution/#16330" class="Function">subst-Z-cons-ids</a> <a id="16442" class="Symbol">=</a> <a id="16444" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="16459" class="Symbol">λ</a> <a id="16461" href="/Substitution/#16461" class="Bound">x</a> <a id="16463" class="Symbol">→</a> <a id="16465" href="/Substitution/#16489" class="Function">lemma</a> <a id="16471" class="Symbol">{</a><a id="16472" class="Argument">x</a> <a id="16474" class="Symbol">=</a> <a id="16476" href="/Substitution/#16461" class="Bound">x</a><a id="16477" class="Symbol">}</a>
  <a id="16481" class="Keyword">where</a>
  <a id="16489" href="/Substitution/#16489" class="Function">lemma</a> <a id="16495" class="Symbol">:</a> <a id="16497" class="Symbol">∀{</a><a id="16499" href="/Substitution/#16499" class="Bound">Γ</a><a id="16500" class="Symbol">}{</a><a id="16502" href="/Substitution/#16502" class="Bound">A</a> <a id="16504" href="/Substitution/#16504" class="Bound">B</a> <a id="16506" class="Symbol">:</a> <a id="16508" href="/Untyped/#2675" class="Datatype">Type</a><a id="16512" class="Symbol">}{</a><a id="16514" href="/Substitution/#16514" class="Bound">M</a> <a id="16516" class="Symbol">:</a> <a id="16518" href="/Substitution/#16499" class="Bound">Γ</a> <a id="16520" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="16522" href="/Substitution/#16504" class="Bound">B</a><a id="16523" class="Symbol">}{</a><a id="16525" href="/Substitution/#16525" class="Bound">x</a> <a id="16527" class="Symbol">:</a> <a id="16529" href="/Substitution/#16499" class="Bound">Γ</a> <a id="16531" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="16533" href="/Substitution/#16504" class="Bound">B</a> <a id="16535" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="16537" href="/Substitution/#16502" class="Bound">A</a><a id="16538" class="Symbol">}</a>
                      <a id="16562" class="Symbol">→</a> <a id="16564" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="16575" href="/Substitution/#16514" class="Bound">M</a> <a id="16577" href="/Substitution/#16525" class="Bound">x</a> <a id="16579" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="16581" class="Symbol">(</a><a id="16582" href="/Substitution/#16514" class="Bound">M</a> <a id="16584" href="/Substitution/#3590" class="Function Operator">•</a> <a id="16586" href="/Substitution/#3177" class="Function">ids</a><a id="16589" class="Symbol">)</a> <a id="16591" href="/Substitution/#16525" class="Bound">x</a>
  <a id="16595" href="/Substitution/#16489" class="Function">lemma</a> <a id="16601" class="Symbol">{</a><a id="16602" class="Argument">x</a> <a id="16604" class="Symbol">=</a> <a id="16606" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="16607" class="Symbol">}</a> <a id="16609" class="Symbol">=</a> <a id="16611" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="16618" href="/Substitution/#16489" class="Function">lemma</a> <a id="16624" class="Symbol">{</a><a id="16625" class="Argument">x</a> <a id="16627" class="Symbol">=</a> <a id="16629" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="16631" href="/Substitution/#16631" class="Bound">x</a><a id="16632" class="Symbol">}</a> <a id="16634" class="Symbol">=</a> <a id="16636" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<h2 id="proofs-of-sub-abs-sub-id-and-rename-id">Proofs of sub-abs, sub-id, and rename-id</h2>

<p>The equation <code class="highlighter-rouge">sub-abs</code> follows immediately from the equation
<code class="highlighter-rouge">exts-cons-shift</code>.</p>

<pre class="Agda"><a id="sub-abs"></a><a id="16793" href="/Substitution/#16793" class="Function">sub-abs</a> <a id="16801" class="Symbol">:</a> <a id="16803" class="Symbol">∀{</a><a id="16805" href="/Substitution/#16805" class="Bound">Γ</a> <a id="16807" href="/Substitution/#16807" class="Bound">Δ</a><a id="16808" class="Symbol">}</a> <a id="16810" class="Symbol">{</a><a id="16811" href="/Substitution/#16811" class="Bound">σ</a> <a id="16813" class="Symbol">:</a> <a id="16815" href="/Substitution/#2504" class="Function">Subst</a> <a id="16821" href="/Substitution/#16805" class="Bound">Γ</a> <a id="16823" href="/Substitution/#16807" class="Bound">Δ</a><a id="16824" class="Symbol">}</a> <a id="16826" class="Symbol">{</a><a id="16827" href="/Substitution/#16827" class="Bound">N</a> <a id="16829" class="Symbol">:</a> <a id="16831" href="/Substitution/#16805" class="Bound">Γ</a> <a id="16833" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="16835" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="16837" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="16839" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="16840" class="Symbol">}</a>
        <a id="16850" class="Symbol">→</a> <a id="16852" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="16854" href="/Substitution/#16811" class="Bound">σ</a> <a id="16856" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="16858" class="Symbol">(</a><a id="16859" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16861" href="/Substitution/#16827" class="Bound">N</a><a id="16862" class="Symbol">)</a> <a id="16864" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="16866" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16868" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="16870" class="Symbol">(</a><a id="16871" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="16873" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="16874" class="Symbol">)</a> <a id="16876" href="/Substitution/#3590" class="Function Operator">•</a> <a id="16878" class="Symbol">(</a><a id="16879" href="/Substitution/#16811" class="Bound">σ</a> <a id="16881" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="16883" href="/Substitution/#3332" class="Function">↑</a><a id="16884" class="Symbol">)</a> <a id="16886" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="16888" href="/Substitution/#16827" class="Bound">N</a>
<a id="16890" href="/Substitution/#16793" class="Function">sub-abs</a> <a id="16898" class="Symbol">{</a><a id="16899" class="Argument">σ</a> <a id="16901" class="Symbol">=</a> <a id="16903" href="/Substitution/#16903" class="Bound">σ</a><a id="16904" class="Symbol">}{</a><a id="16906" class="Argument">N</a> <a id="16908" class="Symbol">=</a> <a id="16910" href="/Substitution/#16910" class="Bound">N</a><a id="16911" class="Symbol">}</a> <a id="16913" class="Symbol">=</a>
   <a id="16918" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
     <a id="16929" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="16931" href="/Substitution/#16903" class="Bound">σ</a> <a id="16933" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="16935" class="Symbol">(</a><a id="16936" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16938" href="/Substitution/#16910" class="Bound">N</a><a id="16939" class="Symbol">)</a>
   <a id="16944" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
     <a id="16953" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16955" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="16957" href="/Untyped/#6623" class="Function">exts</a> <a id="16962" href="/Substitution/#16903" class="Bound">σ</a> <a id="16964" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="16966" href="/Substitution/#16910" class="Bound">N</a>
   <a id="16971" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="16974" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="16979" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="16982" class="Symbol">(</a><a id="16983" href="/Substitution/#11543" class="Function">cong-sub</a><a id="16991" class="Symbol">{</a><a id="16992" class="Argument">M</a> <a id="16994" class="Symbol">=</a> <a id="16996" href="/Substitution/#16910" class="Bound">N</a><a id="16997" class="Symbol">}</a> <a id="16999" href="/Substitution/#15517" class="Function">exts-cons-shift</a> <a id="17015" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="17019" class="Symbol">)</a> <a id="17021" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="17028" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="17030" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="17032" class="Symbol">(</a><a id="17033" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="17035" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="17036" class="Symbol">)</a> <a id="17038" href="/Substitution/#3590" class="Function Operator">•</a> <a id="17040" class="Symbol">(</a><a id="17041" href="/Substitution/#16903" class="Bound">σ</a> <a id="17043" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="17045" href="/Substitution/#3332" class="Function">↑</a><a id="17046" class="Symbol">)</a> <a id="17048" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="17050" href="/Substitution/#16910" class="Bound">N</a>
   <a id="17055" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>The proof of <code class="highlighter-rouge">sub-id</code> requires the following lemma which says that
extending the identity substitution produces the identity
substitution.</p>

<pre class="Agda"><a id="exts-ids"></a><a id="17222" href="/Substitution/#17222" class="Function">exts-ids</a> <a id="17231" class="Symbol">:</a> <a id="17233" class="Symbol">∀{</a><a id="17235" href="/Substitution/#17235" class="Bound">Γ</a><a id="17236" class="Symbol">}{</a><a id="17238" href="/Substitution/#17238" class="Bound">A</a> <a id="17240" href="/Substitution/#17240" class="Bound">B</a><a id="17241" class="Symbol">}</a>
         <a id="17252" class="Symbol">→</a> <a id="17254" href="/Untyped/#6623" class="Function">exts</a> <a id="17259" href="/Substitution/#3177" class="Function">ids</a> <a id="17263" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="17265" href="/Substitution/#3177" class="Function">ids</a> <a id="17269" class="Symbol">{</a><a id="17270" href="/Substitution/#17235" class="Bound">Γ</a> <a id="17272" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="17274" href="/Substitution/#17240" class="Bound">B</a><a id="17275" class="Symbol">}</a> <a id="17277" class="Symbol">{</a><a id="17278" href="/Substitution/#17238" class="Bound">A</a><a id="17279" class="Symbol">}</a>
<a id="17281" href="/Substitution/#17222" class="Function">exts-ids</a> <a id="17290" class="Symbol">{</a><a id="17291" href="/Substitution/#17291" class="Bound">Γ</a><a id="17292" class="Symbol">}{</a><a id="17294" href="/Substitution/#17294" class="Bound">A</a><a id="17295" class="Symbol">}{</a><a id="17297" href="/Substitution/#17297" class="Bound">B</a><a id="17298" class="Symbol">}</a> <a id="17300" class="Symbol">=</a> <a id="17302" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="17317" href="/Substitution/#17331" class="Function">lemma</a>
  <a id="17325" class="Keyword">where</a> <a id="17331" href="/Substitution/#17331" class="Function">lemma</a> <a id="17337" class="Symbol">:</a> <a id="17339" class="Symbol">(</a><a id="17340" href="/Substitution/#17340" class="Bound">x</a> <a id="17342" class="Symbol">:</a> <a id="17344" href="/Substitution/#17291" class="Bound">Γ</a> <a id="17346" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="17348" href="/Substitution/#17297" class="Bound">B</a> <a id="17350" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="17352" href="/Substitution/#17294" class="Bound">A</a><a id="17353" class="Symbol">)</a> <a id="17355" class="Symbol">→</a> <a id="17357" href="/Untyped/#6623" class="Function">exts</a> <a id="17362" href="/Substitution/#3177" class="Function">ids</a> <a id="17366" href="/Substitution/#17340" class="Bound">x</a> <a id="17368" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="17370" href="/Substitution/#3177" class="Function">ids</a> <a id="17374" href="/Substitution/#17340" class="Bound">x</a>
        <a id="17384" href="/Substitution/#17331" class="Function">lemma</a> <a id="17390" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="17392" class="Symbol">=</a> <a id="17394" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
        <a id="17407" href="/Substitution/#17331" class="Function">lemma</a> <a id="17413" class="Symbol">(</a><a id="17414" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="17416" href="/Substitution/#17416" class="Bound">x</a><a id="17417" class="Symbol">)</a> <a id="17419" class="Symbol">=</a> <a id="17421" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<p>The proof of <code class="highlighter-rouge">⟪ ids ⟫ M ≡ M</code> now follows easily by induction on <code class="highlighter-rouge">M</code>,
using <code class="highlighter-rouge">exts-ids</code> in the case for <code class="highlighter-rouge">M ≡ ƛ N</code>.</p>

<pre class="Agda"><a id="sub-id"></a><a id="17565" href="/Substitution/#17565" class="Function">sub-id</a> <a id="17572" class="Symbol">:</a> <a id="17574" class="Symbol">∀{</a><a id="17576" href="/Substitution/#17576" class="Bound">Γ</a><a id="17577" class="Symbol">}</a> <a id="17579" class="Symbol">{</a><a id="17580" href="/Substitution/#17580" class="Bound">A</a><a id="17581" class="Symbol">}</a> <a id="17583" class="Symbol">{</a><a id="17584" href="/Substitution/#17584" class="Bound">M</a> <a id="17586" class="Symbol">:</a> <a id="17588" href="/Substitution/#17576" class="Bound">Γ</a> <a id="17590" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="17592" href="/Substitution/#17580" class="Bound">A</a><a id="17593" class="Symbol">}</a>
         <a id="17604" class="Symbol">→</a> <a id="17606" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="17608" href="/Substitution/#3177" class="Function">ids</a> <a id="17612" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="17614" href="/Substitution/#17584" class="Bound">M</a> <a id="17616" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="17618" href="/Substitution/#17584" class="Bound">M</a>
<a id="17620" href="/Substitution/#17565" class="Function">sub-id</a> <a id="17627" class="Symbol">{</a><a id="17628" class="Argument">M</a> <a id="17630" class="Symbol">=</a> <a id="17632" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="17634" href="/Substitution/#17634" class="Bound">x</a><a id="17635" class="Symbol">}</a> <a id="17637" class="Symbol">=</a> <a id="17639" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="17644" href="/Substitution/#17565" class="Function">sub-id</a> <a id="17651" class="Symbol">{</a><a id="17652" class="Argument">M</a> <a id="17654" class="Symbol">=</a> <a id="17656" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="17658" href="/Substitution/#17658" class="Bound">N</a><a id="17659" class="Symbol">}</a> <a id="17661" class="Symbol">=</a>
   <a id="17666" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
     <a id="17677" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="17679" href="/Substitution/#3177" class="Function">ids</a> <a id="17683" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="17685" class="Symbol">(</a><a id="17686" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="17688" href="/Substitution/#17658" class="Bound">N</a><a id="17689" class="Symbol">)</a>
   <a id="17694" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
     <a id="17703" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="17705" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="17707" href="/Untyped/#6623" class="Function">exts</a> <a id="17712" href="/Substitution/#3177" class="Function">ids</a> <a id="17716" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="17718" href="/Substitution/#17658" class="Bound">N</a>
   <a id="17723" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="17726" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="17731" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="17734" class="Symbol">(</a><a id="17735" href="/Substitution/#11543" class="Function">cong-sub</a><a id="17743" class="Symbol">{</a><a id="17744" class="Argument">M</a> <a id="17746" class="Symbol">=</a> <a id="17748" href="/Substitution/#17658" class="Bound">N</a><a id="17749" class="Symbol">}</a> <a id="17751" href="/Substitution/#17222" class="Function">exts-ids</a> <a id="17760" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="17764" class="Symbol">)</a>  <a id="17767" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="17774" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="17776" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="17778" href="/Substitution/#3177" class="Function">ids</a> <a id="17782" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="17784" href="/Substitution/#17658" class="Bound">N</a>
   <a id="17789" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="17792" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="17797" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="17800" href="/Substitution/#17565" class="Function">sub-id</a> <a id="17807" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="17814" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="17816" href="/Substitution/#17658" class="Bound">N</a>
   <a id="17821" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>
<a id="17823" href="/Substitution/#17565" class="Function">sub-id</a> <a id="17830" class="Symbol">{</a><a id="17831" class="Argument">M</a> <a id="17833" class="Symbol">=</a> <a id="17835" href="/Substitution/#17835" class="Bound">L</a> <a id="17837" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="17839" href="/Substitution/#17839" class="Bound">M</a><a id="17840" class="Symbol">}</a> <a id="17842" class="Symbol">=</a> <a id="17844" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="17850" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="17854" href="/Substitution/#17565" class="Function">sub-id</a> <a id="17861" href="/Substitution/#17565" class="Function">sub-id</a></pre>

<p>The <code class="highlighter-rouge">rename-id</code> equation is a corollary is <code class="highlighter-rouge">sub-id</code>.</p>

<pre class="Agda"><a id="rename-id"></a><a id="17947" href="/Substitution/#17947" class="Function">rename-id</a> <a id="17957" class="Symbol">:</a> <a id="17959" class="Symbol">∀</a> <a id="17961" class="Symbol">{</a><a id="17962" href="/Substitution/#17962" class="Bound">Γ</a><a id="17963" class="Symbol">}{</a><a id="17965" href="/Substitution/#17965" class="Bound">A</a><a id="17966" class="Symbol">}</a> <a id="17968" class="Symbol">{</a><a id="17969" href="/Substitution/#17969" class="Bound">M</a> <a id="17971" class="Symbol">:</a> <a id="17973" href="/Substitution/#17962" class="Bound">Γ</a> <a id="17975" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="17977" href="/Substitution/#17965" class="Bound">A</a><a id="17978" class="Symbol">}</a>
  <a id="17982" class="Symbol">→</a> <a id="17984" href="/Untyped/#6171" class="Function">rename</a> <a id="17991" class="Symbol">(λ</a> <a id="17994" class="Symbol">{</a><a id="17995" href="/Substitution/#17995" class="Bound">A</a><a id="17996" class="Symbol">}</a> <a id="17998" href="/Substitution/#17998" class="Bound">x</a> <a id="18000" class="Symbol">→</a> <a id="18002" href="/Substitution/#17998" class="Bound">x</a><a id="18003" class="Symbol">)</a> <a id="18005" href="/Substitution/#17969" class="Bound">M</a> <a id="18007" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="18009" href="/Substitution/#17969" class="Bound">M</a>
<a id="18011" href="/Substitution/#17947" class="Function">rename-id</a> <a id="18021" class="Symbol">{</a><a id="18022" class="Argument">M</a> <a id="18024" class="Symbol">=</a> <a id="18026" href="/Substitution/#18026" class="Bound">M</a><a id="18027" class="Symbol">}</a> <a id="18029" class="Symbol">=</a>
   <a id="18034" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
     <a id="18045" href="/Untyped/#6171" class="Function">rename</a> <a id="18052" class="Symbol">(λ</a> <a id="18055" class="Symbol">{</a><a id="18056" href="/Substitution/#18056" class="Bound">A</a><a id="18057" class="Symbol">}</a> <a id="18059" href="/Substitution/#18059" class="Bound">x</a> <a id="18061" class="Symbol">→</a> <a id="18063" href="/Substitution/#18059" class="Bound">x</a><a id="18064" class="Symbol">)</a> <a id="18066" href="/Substitution/#18026" class="Bound">M</a>
   <a id="18071" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="18074" href="/Substitution/#14105" class="Function">rename-subst-ren</a>  <a id="18092" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="18099" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="18101" href="/Substitution/#6693" class="Function">ren</a> <a id="18105" class="Symbol">(λ</a> <a id="18108" class="Symbol">{</a><a id="18109" href="/Substitution/#18109" class="Bound">A</a><a id="18110" class="Symbol">}</a> <a id="18112" href="/Substitution/#18112" class="Bound">x</a> <a id="18114" class="Symbol">→</a> <a id="18116" href="/Substitution/#18112" class="Bound">x</a><a id="18117" class="Symbol">)</a> <a id="18119" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="18121" href="/Substitution/#18026" class="Bound">M</a>
   <a id="18126" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
     <a id="18135" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="18137" href="/Substitution/#3177" class="Function">ids</a> <a id="18141" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="18143" href="/Substitution/#18026" class="Bound">M</a>
   <a id="18148" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="18151" href="/Substitution/#17565" class="Function">sub-id</a>  <a id="18159" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="18166" href="/Substitution/#18026" class="Bound">M</a>
   <a id="18171" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="proof-of-sub-idr">Proof of sub-idR</h2>

<p>The proof of <code class="highlighter-rouge">sub-idR</code> follows directly from <code class="highlighter-rouge">sub-id</code>.</p>

<pre class="Agda"><a id="sub-idR"></a><a id="18275" href="/Substitution/#18275" class="Function">sub-idR</a> <a id="18283" class="Symbol">:</a> <a id="18285" class="Symbol">∀{</a><a id="18287" href="/Substitution/#18287" class="Bound">Γ</a> <a id="18289" href="/Substitution/#18289" class="Bound">Δ</a><a id="18290" class="Symbol">}</a> <a id="18292" class="Symbol">{</a><a id="18293" href="/Substitution/#18293" class="Bound">σ</a> <a id="18295" class="Symbol">:</a> <a id="18297" href="/Substitution/#2504" class="Function">Subst</a> <a id="18303" href="/Substitution/#18287" class="Bound">Γ</a> <a id="18305" href="/Substitution/#18289" class="Bound">Δ</a><a id="18306" class="Symbol">}</a> <a id="18308" class="Symbol">{</a><a id="18309" href="/Substitution/#18309" class="Bound">A</a><a id="18310" class="Symbol">}</a>
       <a id="18319" class="Symbol">→</a> <a id="18321" class="Symbol">(</a><a id="18322" href="/Substitution/#18293" class="Bound">σ</a> <a id="18324" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="18326" href="/Substitution/#3177" class="Function">ids</a><a id="18329" class="Symbol">)</a> <a id="18331" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="18333" href="/Substitution/#18293" class="Bound">σ</a> <a id="18335" class="Symbol">{</a><a id="18336" href="/Substitution/#18309" class="Bound">A</a><a id="18337" class="Symbol">}</a>
<a id="18339" href="/Substitution/#18275" class="Function">sub-idR</a> <a id="18347" class="Symbol">{</a><a id="18348" href="/Substitution/#18348" class="Bound">Γ</a><a id="18349" class="Symbol">}{</a><a id="18351" class="Argument">σ</a> <a id="18353" class="Symbol">=</a> <a id="18355" href="/Substitution/#18355" class="Bound">σ</a><a id="18356" class="Symbol">}{</a><a id="18358" href="/Substitution/#18358" class="Bound">A</a><a id="18359" class="Symbol">}</a> <a id="18361" class="Symbol">=</a>
          <a id="18373" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
            <a id="18391" href="/Substitution/#18355" class="Bound">σ</a> <a id="18393" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="18395" href="/Substitution/#3177" class="Function">ids</a>
          <a id="18409" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
            <a id="18425" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="18427" href="/Substitution/#3177" class="Function">ids</a> <a id="18431" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="18433" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="18435" href="/Substitution/#18355" class="Bound">σ</a>
          <a id="18447" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="18450" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="18465" class="Symbol">(λ</a> <a id="18468" href="/Substitution/#18468" class="Bound">x</a> <a id="18470" class="Symbol">→</a> <a id="18472" href="/Substitution/#17565" class="Function">sub-id</a><a id="18478" class="Symbol">)</a> <a id="18480" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
            <a id="18494" href="/Substitution/#18355" class="Bound">σ</a>
          <a id="18506" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="proof-of-sub-sub">Proof of sub-sub</h2>

<p>The <code class="highlighter-rouge">sub-sub</code> equation states that sequenced substitutions <code class="highlighter-rouge">σ ⨟ τ</code>
are equivalent to first applying <code class="highlighter-rouge">σ</code> then applying <code class="highlighter-rouge">τ</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪ τ ⟫ ⟪ σ ⟫ M  ≡ ⟪ σ ⨟ τ ⟫ M
</code></pre></div></div>

<p>The proof requires several lemmas. First, we need to prove the
specialization for renaming.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ (rename ρ′ M) ≡ rename (ρ ∘ ρ′) M
</code></pre></div></div>

<p>This in turn requires the following lemma about <code class="highlighter-rouge">ext</code>.</p>

<pre class="Agda"><a id="compose-ext"></a><a id="18910" href="/Substitution/#18910" class="Function">compose-ext</a> <a id="18922" class="Symbol">:</a> <a id="18924" class="Symbol">∀{</a><a id="18926" href="/Substitution/#18926" class="Bound">Γ</a> <a id="18928" href="/Substitution/#18928" class="Bound">Δ</a> <a id="18930" href="/Substitution/#18930" class="Bound">Σ</a><a id="18931" class="Symbol">}{</a><a id="18933" href="/Substitution/#18933" class="Bound">ρ</a> <a id="18935" class="Symbol">:</a> <a id="18937" href="/Substitution/#2275" class="Function">Rename</a> <a id="18944" href="/Substitution/#18928" class="Bound">Δ</a> <a id="18946" href="/Substitution/#18930" class="Bound">Σ</a><a id="18947" class="Symbol">}</a> <a id="18949" class="Symbol">{</a><a id="18950" href="/Substitution/#18950" class="Bound">ρ′</a> <a id="18953" class="Symbol">:</a> <a id="18955" href="/Substitution/#2275" class="Function">Rename</a> <a id="18962" href="/Substitution/#18926" class="Bound">Γ</a> <a id="18964" href="/Substitution/#18928" class="Bound">Δ</a><a id="18965" class="Symbol">}</a> <a id="18967" class="Symbol">{</a><a id="18968" href="/Substitution/#18968" class="Bound">A</a> <a id="18970" href="/Substitution/#18970" class="Bound">B</a><a id="18971" class="Symbol">}</a>
            <a id="18985" class="Symbol">→</a> <a id="18987" class="Symbol">((</a><a id="18989" href="/Untyped/#5845" class="Function">ext</a> <a id="18993" href="/Substitution/#18933" class="Bound">ρ</a><a id="18994" class="Symbol">)</a> <a id="18996" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="18998" class="Symbol">(</a><a id="18999" href="/Untyped/#5845" class="Function">ext</a> <a id="19003" href="/Substitution/#18950" class="Bound">ρ′</a><a id="19005" class="Symbol">))</a> <a id="19008" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="19010" href="/Untyped/#5845" class="Function">ext</a> <a id="19014" class="Symbol">(</a><a id="19015" href="/Substitution/#18933" class="Bound">ρ</a> <a id="19017" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="19019" href="/Substitution/#18950" class="Bound">ρ′</a><a id="19021" class="Symbol">)</a> <a id="19023" class="Symbol">{</a><a id="19024" href="/Substitution/#18970" class="Bound">B</a><a id="19025" class="Symbol">}</a> <a id="19027" class="Symbol">{</a><a id="19028" href="/Substitution/#18968" class="Bound">A</a><a id="19029" class="Symbol">}</a>
<a id="19031" href="/Substitution/#18910" class="Function">compose-ext</a> <a id="19043" class="Symbol">=</a> <a id="19045" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="19060" class="Symbol">λ</a> <a id="19062" href="/Substitution/#19062" class="Bound">x</a> <a id="19064" class="Symbol">→</a> <a id="19066" href="/Substitution/#19090" class="Function">lemma</a> <a id="19072" class="Symbol">{</a><a id="19073" class="Argument">x</a> <a id="19075" class="Symbol">=</a> <a id="19077" href="/Substitution/#19062" class="Bound">x</a><a id="19078" class="Symbol">}</a>
  <a id="19082" class="Keyword">where</a>
  <a id="19090" href="/Substitution/#19090" class="Function">lemma</a> <a id="19096" class="Symbol">:</a> <a id="19098" class="Symbol">∀{</a><a id="19100" href="/Substitution/#19100" class="Bound">Γ</a> <a id="19102" href="/Substitution/#19102" class="Bound">Δ</a> <a id="19104" href="/Substitution/#19104" class="Bound">Σ</a><a id="19105" class="Symbol">}{</a><a id="19107" href="/Substitution/#19107" class="Bound">ρ</a> <a id="19109" class="Symbol">:</a> <a id="19111" href="/Substitution/#2275" class="Function">Rename</a> <a id="19118" href="/Substitution/#19102" class="Bound">Δ</a> <a id="19120" href="/Substitution/#19104" class="Bound">Σ</a><a id="19121" class="Symbol">}</a> <a id="19123" class="Symbol">{</a><a id="19124" href="/Substitution/#19124" class="Bound">ρ′</a> <a id="19127" class="Symbol">:</a> <a id="19129" href="/Substitution/#2275" class="Function">Rename</a> <a id="19136" href="/Substitution/#19100" class="Bound">Γ</a> <a id="19138" href="/Substitution/#19102" class="Bound">Δ</a><a id="19139" class="Symbol">}</a> <a id="19141" class="Symbol">{</a><a id="19142" href="/Substitution/#19142" class="Bound">A</a> <a id="19144" href="/Substitution/#19144" class="Bound">B</a><a id="19145" class="Symbol">}</a> <a id="19147" class="Symbol">{</a><a id="19148" href="/Substitution/#19148" class="Bound">x</a> <a id="19150" class="Symbol">:</a> <a id="19152" href="/Substitution/#19100" class="Bound">Γ</a> <a id="19154" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="19156" href="/Substitution/#19144" class="Bound">B</a> <a id="19158" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="19160" href="/Substitution/#19142" class="Bound">A</a><a id="19161" class="Symbol">}</a>
              <a id="19177" class="Symbol">→</a> <a id="19179" class="Symbol">((</a><a id="19181" href="/Untyped/#5845" class="Function">ext</a> <a id="19185" href="/Substitution/#19107" class="Bound">ρ</a><a id="19186" class="Symbol">)</a> <a id="19188" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="19190" class="Symbol">(</a><a id="19191" href="/Untyped/#5845" class="Function">ext</a> <a id="19195" href="/Substitution/#19124" class="Bound">ρ′</a><a id="19197" class="Symbol">))</a> <a id="19200" href="/Substitution/#19148" class="Bound">x</a> <a id="19202" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="19204" href="/Untyped/#5845" class="Function">ext</a> <a id="19208" class="Symbol">(</a><a id="19209" href="/Substitution/#19107" class="Bound">ρ</a> <a id="19211" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="19213" href="/Substitution/#19124" class="Bound">ρ′</a><a id="19215" class="Symbol">)</a> <a id="19217" href="/Substitution/#19148" class="Bound">x</a>
  <a id="19221" href="/Substitution/#19090" class="Function">lemma</a> <a id="19227" class="Symbol">{</a><a id="19228" class="Argument">x</a> <a id="19230" class="Symbol">=</a> <a id="19232" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="19233" class="Symbol">}</a> <a id="19235" class="Symbol">=</a> <a id="19237" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="19244" href="/Substitution/#19090" class="Function">lemma</a> <a id="19250" class="Symbol">{</a><a id="19251" class="Argument">x</a> <a id="19253" class="Symbol">=</a> <a id="19255" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="19257" href="/Substitution/#19257" class="Bound">x</a><a id="19258" class="Symbol">}</a> <a id="19260" class="Symbol">=</a> <a id="19262" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<p>To prove that composing renamings is equivalent to applying one after
the other using <code class="highlighter-rouge">rename</code>, we proceed by induction on the term <code class="highlighter-rouge">M</code>,
using the <code class="highlighter-rouge">compose-ext</code> lemma in the case for <code class="highlighter-rouge">M ≡ ƛ N</code>.</p>

<pre class="Agda"><a id="compose-rename"></a><a id="19487" href="/Substitution/#19487" class="Function">compose-rename</a> <a id="19502" class="Symbol">:</a> <a id="19504" class="Symbol">∀{</a><a id="19506" href="/Substitution/#19506" class="Bound">Γ</a> <a id="19508" href="/Substitution/#19508" class="Bound">Δ</a> <a id="19510" href="/Substitution/#19510" class="Bound">Σ</a><a id="19511" class="Symbol">}{</a><a id="19513" href="/Substitution/#19513" class="Bound">A</a><a id="19514" class="Symbol">}{</a><a id="19516" href="/Substitution/#19516" class="Bound">M</a> <a id="19518" class="Symbol">:</a> <a id="19520" href="/Substitution/#19506" class="Bound">Γ</a> <a id="19522" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="19524" href="/Substitution/#19513" class="Bound">A</a><a id="19525" class="Symbol">}{</a><a id="19527" href="/Substitution/#19527" class="Bound">ρ</a> <a id="19529" class="Symbol">:</a> <a id="19531" href="/Substitution/#2275" class="Function">Rename</a> <a id="19538" href="/Substitution/#19508" class="Bound">Δ</a> <a id="19540" href="/Substitution/#19510" class="Bound">Σ</a><a id="19541" class="Symbol">}{</a><a id="19543" href="/Substitution/#19543" class="Bound">ρ′</a> <a id="19546" class="Symbol">:</a> <a id="19548" href="/Substitution/#2275" class="Function">Rename</a> <a id="19555" href="/Substitution/#19506" class="Bound">Γ</a> <a id="19557" href="/Substitution/#19508" class="Bound">Δ</a><a id="19558" class="Symbol">}</a>
  <a id="19562" class="Symbol">→</a> <a id="19564" href="/Untyped/#6171" class="Function">rename</a> <a id="19571" href="/Substitution/#19527" class="Bound">ρ</a> <a id="19573" class="Symbol">(</a><a id="19574" href="/Untyped/#6171" class="Function">rename</a> <a id="19581" href="/Substitution/#19543" class="Bound">ρ′</a> <a id="19584" href="/Substitution/#19516" class="Bound">M</a><a id="19585" class="Symbol">)</a> <a id="19587" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="19589" href="/Untyped/#6171" class="Function">rename</a> <a id="19596" class="Symbol">(</a><a id="19597" href="/Substitution/#19527" class="Bound">ρ</a> <a id="19599" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="19601" href="/Substitution/#19543" class="Bound">ρ′</a><a id="19603" class="Symbol">)</a> <a id="19605" href="/Substitution/#19516" class="Bound">M</a>
<a id="19607" href="/Substitution/#19487" class="Function">compose-rename</a> <a id="19622" class="Symbol">{</a><a id="19623" class="Argument">M</a> <a id="19625" class="Symbol">=</a> <a id="19627" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="19629" href="/Substitution/#19629" class="Bound">x</a><a id="19630" class="Symbol">}</a> <a id="19632" class="Symbol">=</a> <a id="19634" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="19639" href="/Substitution/#19487" class="Function">compose-rename</a> <a id="19654" class="Symbol">{</a><a id="19655" href="/Substitution/#19655" class="Bound">Γ</a><a id="19656" class="Symbol">}{</a><a id="19658" href="/Substitution/#19658" class="Bound">Δ</a><a id="19659" class="Symbol">}{</a><a id="19661" href="/Substitution/#19661" class="Bound">Σ</a><a id="19662" class="Symbol">}{</a><a id="19664" href="/Substitution/#19664" class="Bound">A</a><a id="19665" class="Symbol">}{</a><a id="19667" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="19669" href="/Substitution/#19669" class="Bound">N</a><a id="19670" class="Symbol">}{</a><a id="19672" href="/Substitution/#19672" class="Bound">ρ</a><a id="19673" class="Symbol">}{</a><a id="19675" href="/Substitution/#19675" class="Bound">ρ′</a><a id="19677" class="Symbol">}</a> <a id="19679" class="Symbol">=</a> <a id="19681" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="19686" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="19689" href="/Substitution/#19701" class="Function">G</a>
  <a id="19693" class="Keyword">where</a>
  <a id="19701" href="/Substitution/#19701" class="Function">G</a> <a id="19703" class="Symbol">:</a> <a id="19705" href="/Untyped/#6171" class="Function">rename</a> <a id="19712" class="Symbol">(</a><a id="19713" href="/Untyped/#5845" class="Function">ext</a> <a id="19717" href="/Substitution/#19672" class="Bound">ρ</a><a id="19718" class="Symbol">)</a> <a id="19720" class="Symbol">(</a><a id="19721" href="/Untyped/#6171" class="Function">rename</a> <a id="19728" class="Symbol">(</a><a id="19729" href="/Untyped/#5845" class="Function">ext</a> <a id="19733" href="/Substitution/#19675" class="Bound">ρ′</a><a id="19735" class="Symbol">)</a> <a id="19737" href="/Substitution/#19669" class="Bound">N</a><a id="19738" class="Symbol">)</a> <a id="19740" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="19742" href="/Untyped/#6171" class="Function">rename</a> <a id="19749" class="Symbol">(</a><a id="19750" href="/Untyped/#5845" class="Function">ext</a> <a id="19754" class="Symbol">(</a><a id="19755" href="/Substitution/#19672" class="Bound">ρ</a> <a id="19757" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="19759" href="/Substitution/#19675" class="Bound">ρ′</a><a id="19761" class="Symbol">))</a> <a id="19764" href="/Substitution/#19669" class="Bound">N</a>
  <a id="19768" href="/Substitution/#19701" class="Function">G</a> <a id="19770" class="Symbol">=</a>
      <a id="19778" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
        <a id="19792" href="/Untyped/#6171" class="Function">rename</a> <a id="19799" class="Symbol">(</a><a id="19800" href="/Untyped/#5845" class="Function">ext</a> <a id="19804" href="/Substitution/#19672" class="Bound">ρ</a><a id="19805" class="Symbol">)</a> <a id="19807" class="Symbol">(</a><a id="19808" href="/Untyped/#6171" class="Function">rename</a> <a id="19815" class="Symbol">(</a><a id="19816" href="/Untyped/#5845" class="Function">ext</a> <a id="19820" href="/Substitution/#19675" class="Bound">ρ′</a><a id="19822" class="Symbol">)</a> <a id="19824" href="/Substitution/#19669" class="Bound">N</a><a id="19825" class="Symbol">)</a>
      <a id="19833" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="19836" href="/Substitution/#19487" class="Function">compose-rename</a><a id="19850" class="Symbol">{</a><a id="19851" class="Argument">ρ</a> <a id="19853" class="Symbol">=</a> <a id="19855" href="/Untyped/#5845" class="Function">ext</a> <a id="19859" href="/Substitution/#19672" class="Bound">ρ</a><a id="19860" class="Symbol">}{</a><a id="19862" class="Argument">ρ′</a> <a id="19865" class="Symbol">=</a> <a id="19867" href="/Untyped/#5845" class="Function">ext</a> <a id="19871" href="/Substitution/#19675" class="Bound">ρ′</a><a id="19873" class="Symbol">}</a> <a id="19875" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
        <a id="19885" href="/Untyped/#6171" class="Function">rename</a> <a id="19892" class="Symbol">((</a><a id="19894" href="/Untyped/#5845" class="Function">ext</a> <a id="19898" href="/Substitution/#19672" class="Bound">ρ</a><a id="19899" class="Symbol">)</a> <a id="19901" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="19903" class="Symbol">(</a><a id="19904" href="/Untyped/#5845" class="Function">ext</a> <a id="19908" href="/Substitution/#19675" class="Bound">ρ′</a><a id="19910" class="Symbol">))</a> <a id="19913" href="/Substitution/#19669" class="Bound">N</a>
      <a id="19921" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="19924" href="/Substitution/#10709" class="Function">cong-rename</a> <a id="19936" href="/Substitution/#18910" class="Function">compose-ext</a> <a id="19948" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="19953" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
        <a id="19963" href="/Untyped/#6171" class="Function">rename</a> <a id="19970" class="Symbol">(</a><a id="19971" href="/Untyped/#5845" class="Function">ext</a> <a id="19975" class="Symbol">(</a><a id="19976" href="/Substitution/#19672" class="Bound">ρ</a> <a id="19978" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="19980" href="/Substitution/#19675" class="Bound">ρ′</a><a id="19982" class="Symbol">))</a> <a id="19985" href="/Substitution/#19669" class="Bound">N</a>
      <a id="19993" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>
<a id="19995" href="/Substitution/#19487" class="Function">compose-rename</a> <a id="20010" class="Symbol">{</a><a id="20011" class="Argument">M</a> <a id="20013" class="Symbol">=</a> <a id="20015" href="/Substitution/#20015" class="Bound">L</a> <a id="20017" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="20019" href="/Substitution/#20019" class="Bound">M</a><a id="20020" class="Symbol">}</a> <a id="20022" class="Symbol">=</a> <a id="20024" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="20030" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="20034" href="/Substitution/#19487" class="Function">compose-rename</a> <a id="20049" href="/Substitution/#19487" class="Function">compose-rename</a></pre>

<p>The next lemma states that if a renaming and substitution commute on
variables, then they also commute on terms. We explain the proof in
detail below.</p>

<pre class="Agda"><a id="commute-subst-rename"></a><a id="20241" href="/Substitution/#20241" class="Function">commute-subst-rename</a> <a id="20262" class="Symbol">:</a> <a id="20264" class="Symbol">∀{</a><a id="20266" href="/Substitution/#20266" class="Bound">Γ</a> <a id="20268" href="/Substitution/#20268" class="Bound">Δ</a><a id="20269" class="Symbol">}{</a><a id="20271" href="/Substitution/#20271" class="Bound">M</a> <a id="20273" class="Symbol">:</a> <a id="20275" href="/Substitution/#20266" class="Bound">Γ</a> <a id="20277" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="20279" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20280" class="Symbol">}{</a><a id="20282" href="/Substitution/#20282" class="Bound">σ</a> <a id="20284" class="Symbol">:</a> <a id="20286" href="/Substitution/#2504" class="Function">Subst</a> <a id="20292" href="/Substitution/#20266" class="Bound">Γ</a> <a id="20294" href="/Substitution/#20268" class="Bound">Δ</a><a id="20295" class="Symbol">}</a>
                        <a id="20321" class="Symbol">{</a><a id="20322" href="/Substitution/#20322" class="Bound">ρ</a> <a id="20324" class="Symbol">:</a> <a id="20326" class="Symbol">∀{</a><a id="20328" href="/Substitution/#20328" class="Bound">Γ</a><a id="20329" class="Symbol">}</a> <a id="20331" class="Symbol">→</a> <a id="20333" href="/Substitution/#2275" class="Function">Rename</a> <a id="20340" href="/Substitution/#20328" class="Bound">Γ</a> <a id="20342" class="Symbol">(</a><a id="20343" href="/Substitution/#20328" class="Bound">Γ</a> <a id="20345" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="20347" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20348" class="Symbol">)}</a>
     <a id="20356" class="Symbol">→</a> <a id="20358" class="Symbol">(∀{</a><a id="20361" href="/Substitution/#20361" class="Bound">x</a> <a id="20363" class="Symbol">:</a> <a id="20365" href="/Substitution/#20266" class="Bound">Γ</a> <a id="20367" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="20369" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20370" class="Symbol">}</a> <a id="20372" class="Symbol">→</a> <a id="20374" href="/Untyped/#6623" class="Function">exts</a> <a id="20379" href="/Substitution/#20282" class="Bound">σ</a> <a id="20381" class="Symbol">{</a><a id="20382" class="Argument">B</a> <a id="20384" class="Symbol">=</a> <a id="20386" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20387" class="Symbol">}</a> <a id="20389" class="Symbol">(</a><a id="20390" href="/Substitution/#20322" class="Bound">ρ</a> <a id="20392" href="/Substitution/#20361" class="Bound">x</a><a id="20393" class="Symbol">)</a> <a id="20395" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="20397" href="/Untyped/#6171" class="Function">rename</a> <a id="20404" href="/Substitution/#20322" class="Bound">ρ</a> <a id="20406" class="Symbol">(</a><a id="20407" href="/Substitution/#20282" class="Bound">σ</a> <a id="20409" href="/Substitution/#20361" class="Bound">x</a><a id="20410" class="Symbol">))</a>
     <a id="20418" class="Symbol">→</a> <a id="20420" href="/Untyped/#6931" class="Function">subst</a> <a id="20426" class="Symbol">(</a><a id="20427" href="/Untyped/#6623" class="Function">exts</a> <a id="20432" href="/Substitution/#20282" class="Bound">σ</a> <a id="20434" class="Symbol">{</a><a id="20435" class="Argument">B</a> <a id="20437" class="Symbol">=</a> <a id="20439" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20440" class="Symbol">})</a> <a id="20443" class="Symbol">(</a><a id="20444" href="/Untyped/#6171" class="Function">rename</a> <a id="20451" href="/Substitution/#20322" class="Bound">ρ</a> <a id="20453" href="/Substitution/#20271" class="Bound">M</a><a id="20454" class="Symbol">)</a> <a id="20456" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="20458" href="/Untyped/#6171" class="Function">rename</a> <a id="20465" href="/Substitution/#20322" class="Bound">ρ</a> <a id="20467" class="Symbol">(</a><a id="20468" href="/Untyped/#6931" class="Function">subst</a> <a id="20474" href="/Substitution/#20282" class="Bound">σ</a> <a id="20476" href="/Substitution/#20271" class="Bound">M</a><a id="20477" class="Symbol">)</a>
<a id="20479" href="/Substitution/#20241" class="Function">commute-subst-rename</a> <a id="20500" class="Symbol">{</a><a id="20501" class="Argument">M</a> <a id="20503" class="Symbol">=</a> <a id="20505" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="20507" href="/Substitution/#20507" class="Bound">x</a><a id="20508" class="Symbol">}</a> <a id="20510" href="/Substitution/#20510" class="Bound">r</a> <a id="20512" class="Symbol">=</a> <a id="20514" href="/Substitution/#20510" class="Bound">r</a>
<a id="20516" href="/Substitution/#20241" class="Function">commute-subst-rename</a><a id="20536" class="Symbol">{</a><a id="20537" href="/Substitution/#20537" class="Bound">Γ</a><a id="20538" class="Symbol">}{</a><a id="20540" href="/Substitution/#20540" class="Bound">Δ</a><a id="20541" class="Symbol">}{</a><a id="20543" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="20545" href="/Substitution/#20545" class="Bound">N</a><a id="20546" class="Symbol">}{</a><a id="20548" href="/Substitution/#20548" class="Bound">σ</a><a id="20549" class="Symbol">}{</a><a id="20551" href="/Substitution/#20551" class="Bound">ρ</a><a id="20552" class="Symbol">}</a> <a id="20554" href="/Substitution/#20554" class="Bound">r</a> <a id="20556" class="Symbol">=</a>
   <a id="20561" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="20566" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="20569" class="Symbol">(</a><a id="20570" href="/Substitution/#20241" class="Function">commute-subst-rename</a><a id="20590" class="Symbol">{</a><a id="20591" href="/Substitution/#20537" class="Bound">Γ</a> <a id="20593" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="20595" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20596" class="Symbol">}{</a><a id="20598" href="/Substitution/#20540" class="Bound">Δ</a> <a id="20600" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="20602" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20603" class="Symbol">}{</a><a id="20605" href="/Substitution/#20545" class="Bound">N</a><a id="20606" class="Symbol">}</a>
               <a id="20623" class="Symbol">{</a><a id="20624" href="/Untyped/#6623" class="Function">exts</a> <a id="20629" href="/Substitution/#20548" class="Bound">σ</a><a id="20630" class="Symbol">}{</a><a id="20632" class="Argument">ρ</a> <a id="20634" class="Symbol">=</a> <a id="20636" href="/Substitution/#20669" class="Function">ρ′</a><a id="20638" class="Symbol">}</a> <a id="20640" class="Symbol">(λ</a> <a id="20643" class="Symbol">{</a><a id="20644" href="/Substitution/#20644" class="Bound">x</a><a id="20645" class="Symbol">}</a> <a id="20647" class="Symbol">→</a> <a id="20649" href="/Substitution/#20742" class="Function">H</a> <a id="20651" class="Symbol">{</a><a id="20652" href="/Substitution/#20644" class="Bound">x</a><a id="20653" class="Symbol">}))</a>
   <a id="20660" class="Keyword">where</a>
   <a id="20669" href="/Substitution/#20669" class="Function">ρ′</a> <a id="20672" class="Symbol">:</a> <a id="20674" class="Symbol">∀</a> <a id="20676" class="Symbol">{</a><a id="20677" href="/Substitution/#20677" class="Bound">Γ</a><a id="20678" class="Symbol">}</a> <a id="20680" class="Symbol">→</a> <a id="20682" href="/Substitution/#2275" class="Function">Rename</a> <a id="20689" href="/Substitution/#20677" class="Bound">Γ</a> <a id="20691" class="Symbol">(</a><a id="20692" href="/Substitution/#20677" class="Bound">Γ</a> <a id="20694" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="20696" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20697" class="Symbol">)</a>
   <a id="20702" href="/Substitution/#20669" class="Function">ρ′</a> <a id="20705" class="Symbol">{</a><a id="20706" href="/Untyped/#3002" class="InductiveConstructor">∅</a><a id="20707" class="Symbol">}</a> <a id="20709" class="Symbol">=</a> <a id="20711" class="Symbol">λ</a> <a id="20713" class="Symbol">()</a>
   <a id="20719" href="/Substitution/#20669" class="Function">ρ′</a> <a id="20722" class="Symbol">{</a><a id="20723" href="/Substitution/#20723" class="Bound">Γ</a> <a id="20725" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="20727" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20728" class="Symbol">}</a> <a id="20730" class="Symbol">=</a> <a id="20732" href="/Untyped/#5845" class="Function">ext</a> <a id="20736" href="/Substitution/#20551" class="Bound">ρ</a>

   <a id="20742" href="/Substitution/#20742" class="Function">H</a> <a id="20744" class="Symbol">:</a> <a id="20746" class="Symbol">{</a><a id="20747" href="/Substitution/#20747" class="Bound">x</a> <a id="20749" class="Symbol">:</a> <a id="20751" href="/Substitution/#20537" class="Bound">Γ</a> <a id="20753" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="20755" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="20757" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="20759" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20760" class="Symbol">}</a> <a id="20762" class="Symbol">→</a> <a id="20764" href="/Untyped/#6623" class="Function">exts</a> <a id="20769" class="Symbol">(</a><a id="20770" href="/Untyped/#6623" class="Function">exts</a> <a id="20775" href="/Substitution/#20548" class="Bound">σ</a><a id="20776" class="Symbol">)</a> <a id="20778" class="Symbol">(</a><a id="20779" href="/Untyped/#5845" class="Function">ext</a> <a id="20783" href="/Substitution/#20551" class="Bound">ρ</a> <a id="20785" href="/Substitution/#20747" class="Bound">x</a><a id="20786" class="Symbol">)</a> <a id="20788" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="20790" href="/Untyped/#6171" class="Function">rename</a> <a id="20797" class="Symbol">(</a><a id="20798" href="/Untyped/#5845" class="Function">ext</a> <a id="20802" href="/Substitution/#20551" class="Bound">ρ</a><a id="20803" class="Symbol">)</a> <a id="20805" class="Symbol">(</a><a id="20806" href="/Untyped/#6623" class="Function">exts</a> <a id="20811" href="/Substitution/#20548" class="Bound">σ</a> <a id="20813" href="/Substitution/#20747" class="Bound">x</a><a id="20814" class="Symbol">)</a>
   <a id="20819" href="/Substitution/#20742" class="Function">H</a> <a id="20821" class="Symbol">{</a><a id="20822" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="20823" class="Symbol">}</a> <a id="20825" class="Symbol">=</a> <a id="20827" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
   <a id="20835" href="/Substitution/#20742" class="Function">H</a> <a id="20837" class="Symbol">{</a><a id="20838" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="20840" href="/Substitution/#20840" class="Bound">y</a><a id="20841" class="Symbol">}</a> <a id="20843" class="Symbol">=</a>
     <a id="20850" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="20863" href="/Untyped/#6623" class="Function">exts</a> <a id="20868" class="Symbol">(</a><a id="20869" href="/Untyped/#6623" class="Function">exts</a> <a id="20874" href="/Substitution/#20548" class="Bound">σ</a><a id="20875" class="Symbol">)</a> <a id="20877" class="Symbol">(</a><a id="20878" href="/Untyped/#5845" class="Function">ext</a> <a id="20882" href="/Substitution/#20551" class="Bound">ρ</a> <a id="20884" class="Symbol">(</a><a id="20885" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="20887" href="/Substitution/#20840" class="Bound">y</a><a id="20888" class="Symbol">))</a>
     <a id="20896" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="20907" href="/Untyped/#6171" class="Function">rename</a> <a id="20914" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="20917" class="Symbol">(</a><a id="20918" href="/Untyped/#6623" class="Function">exts</a> <a id="20923" href="/Substitution/#20548" class="Bound">σ</a> <a id="20925" class="Symbol">(</a><a id="20926" href="/Substitution/#20551" class="Bound">ρ</a> <a id="20928" href="/Substitution/#20840" class="Bound">y</a><a id="20929" class="Symbol">))</a>
     <a id="20937" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="20940" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="20945" class="Symbol">(</a><a id="20946" href="/Untyped/#6171" class="Function">rename</a> <a id="20953" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="20955" class="Symbol">)</a> <a id="20957" href="/Substitution/#20554" class="Bound">r</a> <a id="20959" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="20968" href="/Untyped/#6171" class="Function">rename</a> <a id="20975" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="20978" class="Symbol">(</a><a id="20979" href="/Untyped/#6171" class="Function">rename</a> <a id="20986" href="/Substitution/#20551" class="Bound">ρ</a> <a id="20988" class="Symbol">(</a><a id="20989" href="/Substitution/#20548" class="Bound">σ</a> <a id="20991" href="/Substitution/#20840" class="Bound">y</a><a id="20992" class="Symbol">))</a>
     <a id="21000" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="21003" href="/Substitution/#19487" class="Function">compose-rename</a> <a id="21018" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="21027" href="/Untyped/#6171" class="Function">rename</a> <a id="21034" class="Symbol">(</a><a id="21035" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="21038" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="21040" href="/Substitution/#20551" class="Bound">ρ</a><a id="21041" class="Symbol">)</a> <a id="21043" class="Symbol">(</a><a id="21044" href="/Substitution/#20548" class="Bound">σ</a> <a id="21046" href="/Substitution/#20840" class="Bound">y</a><a id="21047" class="Symbol">)</a>
     <a id="21054" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="21057" href="/Substitution/#10709" class="Function">cong-rename</a> <a id="21069" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="21074" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="21079" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="21088" href="/Untyped/#6171" class="Function">rename</a> <a id="21095" class="Symbol">((</a><a id="21097" href="/Untyped/#5845" class="Function">ext</a> <a id="21101" href="/Substitution/#20551" class="Bound">ρ</a><a id="21102" class="Symbol">)</a> <a id="21104" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="21106" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="21108" class="Symbol">)</a> <a id="21110" class="Symbol">(</a><a id="21111" href="/Substitution/#20548" class="Bound">σ</a> <a id="21113" href="/Substitution/#20840" class="Bound">y</a><a id="21114" class="Symbol">)</a>
     <a id="21121" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="21124" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="21128" href="/Substitution/#19487" class="Function">compose-rename</a> <a id="21143" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="21152" href="/Untyped/#6171" class="Function">rename</a> <a id="21159" class="Symbol">(</a><a id="21160" href="/Untyped/#5845" class="Function">ext</a> <a id="21164" href="/Substitution/#20551" class="Bound">ρ</a><a id="21165" class="Symbol">)</a> <a id="21167" class="Symbol">(</a><a id="21168" href="/Untyped/#6171" class="Function">rename</a> <a id="21175" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="21178" class="Symbol">(</a><a id="21179" href="/Substitution/#20548" class="Bound">σ</a> <a id="21181" href="/Substitution/#20840" class="Bound">y</a><a id="21182" class="Symbol">))</a>
     <a id="21190" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="21201" href="/Untyped/#6171" class="Function">rename</a> <a id="21208" class="Symbol">(</a><a id="21209" href="/Untyped/#5845" class="Function">ext</a> <a id="21213" href="/Substitution/#20551" class="Bound">ρ</a><a id="21214" class="Symbol">)</a> <a id="21216" class="Symbol">(</a><a id="21217" href="/Untyped/#6623" class="Function">exts</a> <a id="21222" href="/Substitution/#20548" class="Bound">σ</a> <a id="21224" class="Symbol">(</a><a id="21225" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="21227" href="/Substitution/#20840" class="Bound">y</a><a id="21228" class="Symbol">))</a>
     <a id="21236" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>
<a id="21238" href="/Substitution/#20241" class="Function">commute-subst-rename</a> <a id="21259" class="Symbol">{</a><a id="21260" class="Argument">M</a> <a id="21262" class="Symbol">=</a> <a id="21264" href="/Substitution/#21264" class="Bound">L</a> <a id="21266" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="21268" href="/Substitution/#21268" class="Bound">M</a><a id="21269" class="Symbol">}{</a><a id="21271" class="Argument">ρ</a> <a id="21273" class="Symbol">=</a> <a id="21275" href="/Substitution/#21275" class="Bound">ρ</a><a id="21276" class="Symbol">}</a> <a id="21278" href="/Substitution/#21278" class="Bound">r</a> <a id="21280" class="Symbol">=</a>
   <a id="21285" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="21291" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="21295" class="Symbol">(</a><a id="21296" href="/Substitution/#20241" class="Function">commute-subst-rename</a><a id="21316" class="Symbol">{</a><a id="21317" class="Argument">M</a> <a id="21319" class="Symbol">=</a> <a id="21321" href="/Substitution/#21264" class="Bound">L</a><a id="21322" class="Symbol">}{</a><a id="21324" class="Argument">ρ</a> <a id="21326" class="Symbol">=</a> <a id="21328" href="/Substitution/#21275" class="Bound">ρ</a><a id="21329" class="Symbol">}</a> <a id="21331" href="/Substitution/#21278" class="Bound">r</a><a id="21332" class="Symbol">)</a>
             <a id="21347" class="Symbol">(</a><a id="21348" href="/Substitution/#20241" class="Function">commute-subst-rename</a><a id="21368" class="Symbol">{</a><a id="21369" class="Argument">M</a> <a id="21371" class="Symbol">=</a> <a id="21373" href="/Substitution/#21268" class="Bound">M</a><a id="21374" class="Symbol">}{</a><a id="21376" class="Argument">ρ</a> <a id="21378" class="Symbol">=</a> <a id="21380" href="/Substitution/#21275" class="Bound">ρ</a><a id="21381" class="Symbol">}</a> <a id="21383" href="/Substitution/#21278" class="Bound">r</a><a id="21384" class="Symbol">)</a></pre>

<p>The proof is by induction on the term <code class="highlighter-rouge">M</code>.</p>

<ul>
  <li>
    <p>If <code class="highlighter-rouge">M</code> is a variable, then we use the premise to conclude.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">M ≡ ƛ N</code>, we conclude using the induction hypothesis for
<code class="highlighter-rouge">N</code>. However, to use the induction hypothesis, we must show
that</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  exts (exts σ) (ext ρ x) ≡ rename (ext ρ) (exts σ x)
</code></pre></div>    </div>

    <p>We prove this equation by cases on x.</p>

    <ul>
      <li>
        <p>If <code class="highlighter-rouge">x = Z</code>, the two sides are equal by definition.</p>
      </li>
      <li>
        <p>If <code class="highlighter-rouge">x = S y</code>, we obtain the goal by the following equational reasoning.</p>

        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts (exts σ) (ext ρ (S y))   ≡ rename S_ (exts σ (ρ y))   ≡ rename S_ (rename S_ (σ (ρ y)      (by the premise)   ≡ rename (ext ρ) (exts σ (S y))      (by compose-rename)   ≡ rename ((ext ρ) ∘ S_) (σ y)   ≡ rename (ext ρ) (rename S_ (σ y))   (by compose-rename)   ≡ rename (ext ρ) (exts σ (S y))
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">M</code> is an application, we obtain the goal using the induction
hypothesis for each subterm.</p>
  </li>
</ul>

<p>The last lemma needed to prove <code class="highlighter-rouge">sub-sub</code> states that the <code class="highlighter-rouge">exts</code>
function distributes with sequencing. It is a corollary of
<code class="highlighter-rouge">commute-subst-rename</code> as described below.  (It would have been nicer
to prove this directly by equational reasoning in the σ algebra, but
that would require the <code class="highlighter-rouge">sub-assoc</code> equation, whose proof depends on
<code class="highlighter-rouge">sub-sub</code>, which in turn depends on this lemma.)</p>

<pre class="Agda"><a id="exts-seq"></a><a id="22713" href="/Substitution/#22713" class="Function">exts-seq</a> <a id="22722" class="Symbol">:</a> <a id="22724" class="Symbol">∀{</a><a id="22726" href="/Substitution/#22726" class="Bound">Γ</a> <a id="22728" href="/Substitution/#22728" class="Bound">Δ</a> <a id="22730" href="/Substitution/#22730" class="Bound">Δ′</a><a id="22732" class="Symbol">}</a> <a id="22734" class="Symbol">{</a><a id="22735" href="/Substitution/#22735" class="Bound">σ₁</a> <a id="22738" class="Symbol">:</a> <a id="22740" href="/Substitution/#2504" class="Function">Subst</a> <a id="22746" href="/Substitution/#22726" class="Bound">Γ</a> <a id="22748" href="/Substitution/#22728" class="Bound">Δ</a><a id="22749" class="Symbol">}</a> <a id="22751" class="Symbol">{</a><a id="22752" href="/Substitution/#22752" class="Bound">σ₂</a> <a id="22755" class="Symbol">:</a> <a id="22757" href="/Substitution/#2504" class="Function">Subst</a> <a id="22763" href="/Substitution/#22728" class="Bound">Δ</a> <a id="22765" href="/Substitution/#22730" class="Bound">Δ′</a><a id="22767" class="Symbol">}</a>
         <a id="22778" class="Symbol">→</a> <a id="22780" class="Symbol">∀</a> <a id="22782" class="Symbol">{</a><a id="22783" href="/Substitution/#22783" class="Bound">A</a><a id="22784" class="Symbol">}</a> <a id="22786" class="Symbol">→</a> <a id="22788" class="Symbol">(</a><a id="22789" href="/Untyped/#6623" class="Function">exts</a> <a id="22794" href="/Substitution/#22735" class="Bound">σ₁</a> <a id="22797" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="22799" href="/Untyped/#6623" class="Function">exts</a> <a id="22804" href="/Substitution/#22752" class="Bound">σ₂</a><a id="22806" class="Symbol">)</a> <a id="22808" class="Symbol">{</a><a id="22809" href="/Substitution/#22783" class="Bound">A</a><a id="22810" class="Symbol">}</a> <a id="22812" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="22814" href="/Untyped/#6623" class="Function">exts</a> <a id="22819" class="Symbol">(</a><a id="22820" href="/Substitution/#22735" class="Bound">σ₁</a> <a id="22823" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="22825" href="/Substitution/#22752" class="Bound">σ₂</a><a id="22827" class="Symbol">)</a>
<a id="22829" href="/Substitution/#22713" class="Function">exts-seq</a> <a id="22838" class="Symbol">=</a> <a id="22840" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="22855" class="Symbol">λ</a> <a id="22857" href="/Substitution/#22857" class="Bound">x</a> <a id="22859" class="Symbol">→</a> <a id="22861" href="/Substitution/#22885" class="Function">lemma</a> <a id="22867" class="Symbol">{</a><a id="22868" class="Argument">x</a> <a id="22870" class="Symbol">=</a> <a id="22872" href="/Substitution/#22857" class="Bound">x</a><a id="22873" class="Symbol">}</a>
  <a id="22877" class="Keyword">where</a>
  <a id="22885" href="/Substitution/#22885" class="Function">lemma</a> <a id="22891" class="Symbol">:</a> <a id="22893" class="Symbol">∀{</a><a id="22895" href="/Substitution/#22895" class="Bound">Γ</a> <a id="22897" href="/Substitution/#22897" class="Bound">Δ</a> <a id="22899" href="/Substitution/#22899" class="Bound">Δ′</a><a id="22901" class="Symbol">}{</a><a id="22903" href="/Substitution/#22903" class="Bound">A</a><a id="22904" class="Symbol">}{</a><a id="22906" href="/Substitution/#22906" class="Bound">x</a> <a id="22908" class="Symbol">:</a> <a id="22910" href="/Substitution/#22895" class="Bound">Γ</a> <a id="22912" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="22914" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="22916" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="22918" href="/Substitution/#22903" class="Bound">A</a><a id="22919" class="Symbol">}</a> <a id="22921" class="Symbol">{</a><a id="22922" href="/Substitution/#22922" class="Bound">σ₁</a> <a id="22925" class="Symbol">:</a> <a id="22927" href="/Substitution/#2504" class="Function">Subst</a> <a id="22933" href="/Substitution/#22895" class="Bound">Γ</a> <a id="22935" href="/Substitution/#22897" class="Bound">Δ</a><a id="22936" class="Symbol">}{</a><a id="22938" href="/Substitution/#22938" class="Bound">σ₂</a> <a id="22941" class="Symbol">:</a> <a id="22943" href="/Substitution/#2504" class="Function">Subst</a> <a id="22949" href="/Substitution/#22897" class="Bound">Δ</a> <a id="22951" href="/Substitution/#22899" class="Bound">Δ′</a><a id="22953" class="Symbol">}</a>
     <a id="22960" class="Symbol">→</a> <a id="22962" class="Symbol">(</a><a id="22963" href="/Untyped/#6623" class="Function">exts</a> <a id="22968" href="/Substitution/#22922" class="Bound">σ₁</a> <a id="22971" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="22973" href="/Untyped/#6623" class="Function">exts</a> <a id="22978" href="/Substitution/#22938" class="Bound">σ₂</a><a id="22980" class="Symbol">)</a> <a id="22982" href="/Substitution/#22906" class="Bound">x</a> <a id="22984" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="22986" href="/Untyped/#6623" class="Function">exts</a> <a id="22991" class="Symbol">(</a><a id="22992" href="/Substitution/#22922" class="Bound">σ₁</a> <a id="22995" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="22997" href="/Substitution/#22938" class="Bound">σ₂</a><a id="22999" class="Symbol">)</a> <a id="23001" href="/Substitution/#22906" class="Bound">x</a>
  <a id="23005" href="/Substitution/#22885" class="Function">lemma</a> <a id="23011" class="Symbol">{</a><a id="23012" class="Argument">x</a> <a id="23014" class="Symbol">=</a> <a id="23016" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="23017" class="Symbol">}</a> <a id="23019" class="Symbol">=</a> <a id="23021" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="23028" href="/Substitution/#22885" class="Function">lemma</a> <a id="23034" class="Symbol">{</a><a id="23035" class="Argument">A</a> <a id="23037" class="Symbol">=</a> <a id="23039" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="23040" class="Symbol">}{</a><a id="23042" class="Argument">x</a> <a id="23044" class="Symbol">=</a> <a id="23046" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="23048" href="/Substitution/#23048" class="Bound">x</a><a id="23049" class="Symbol">}{</a><a id="23051" href="/Substitution/#23051" class="Bound">σ₁</a><a id="23053" class="Symbol">}{</a><a id="23055" href="/Substitution/#23055" class="Bound">σ₂</a><a id="23057" class="Symbol">}</a> <a id="23059" class="Symbol">=</a>
     <a id="23066" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="23079" class="Symbol">(</a><a id="23080" href="/Untyped/#6623" class="Function">exts</a> <a id="23085" href="/Substitution/#23051" class="Bound">σ₁</a> <a id="23088" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="23090" href="/Untyped/#6623" class="Function">exts</a> <a id="23095" href="/Substitution/#23055" class="Bound">σ₂</a><a id="23097" class="Symbol">)</a> <a id="23099" class="Symbol">(</a><a id="23100" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="23102" href="/Substitution/#23048" class="Bound">x</a><a id="23103" class="Symbol">)</a>
     <a id="23110" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="23121" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="23123" href="/Untyped/#6623" class="Function">exts</a> <a id="23128" href="/Substitution/#23055" class="Bound">σ₂</a> <a id="23131" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="23133" class="Symbol">(</a><a id="23134" href="/Untyped/#6171" class="Function">rename</a> <a id="23141" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="23144" class="Symbol">(</a><a id="23145" href="/Substitution/#23051" class="Bound">σ₁</a> <a id="23148" href="/Substitution/#23048" class="Bound">x</a><a id="23149" class="Symbol">))</a>
     <a id="23157" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="23160" href="/Substitution/#20241" class="Function">commute-subst-rename</a><a id="23180" class="Symbol">{</a><a id="23181" class="Argument">M</a> <a id="23183" class="Symbol">=</a> <a id="23185" href="/Substitution/#23051" class="Bound">σ₁</a> <a id="23188" href="/Substitution/#23048" class="Bound">x</a><a id="23189" class="Symbol">}{</a><a id="23191" class="Argument">σ</a> <a id="23193" class="Symbol">=</a> <a id="23195" href="/Substitution/#23055" class="Bound">σ₂</a><a id="23197" class="Symbol">}{</a><a id="23199" class="Argument">ρ</a> <a id="23201" class="Symbol">=</a> <a id="23203" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="23205" class="Symbol">}</a> <a id="23207" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="23212" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="23221" href="/Untyped/#6171" class="Function">rename</a> <a id="23228" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="23231" class="Symbol">(</a><a id="23232" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="23234" href="/Substitution/#23055" class="Bound">σ₂</a> <a id="23237" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="23239" class="Symbol">(</a><a id="23240" href="/Substitution/#23051" class="Bound">σ₁</a> <a id="23243" href="/Substitution/#23048" class="Bound">x</a><a id="23244" class="Symbol">))</a>
     <a id="23252" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="23263" href="/Untyped/#6171" class="Function">rename</a> <a id="23270" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="23273" class="Symbol">((</a><a id="23275" href="/Substitution/#23051" class="Bound">σ₁</a> <a id="23278" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="23280" href="/Substitution/#23055" class="Bound">σ₂</a><a id="23282" class="Symbol">)</a> <a id="23284" href="/Substitution/#23048" class="Bound">x</a><a id="23285" class="Symbol">)</a>
     <a id="23292" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>The proof proceed by cases on <code class="highlighter-rouge">x</code>.</p>

<ul>
  <li>
    <p>If <code class="highlighter-rouge">x = Z</code>, the two sides are equal by the definition of <code class="highlighter-rouge">exts</code>
and sequencing.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">x = S x</code>, we unfold the first use of <code class="highlighter-rouge">exts</code> and sequencing, then
apply the lemma <code class="highlighter-rouge">commute-subst-rename</code>. We conclude by the
definition of sequencing.</p>
  </li>
</ul>

<p>Now we come to the proof of <code class="highlighter-rouge">sub-sub</code>, which we explain below.</p>

<pre class="Agda"><a id="sub-sub"></a><a id="23666" href="/Substitution/#23666" class="Function">sub-sub</a> <a id="23674" class="Symbol">:</a> <a id="23676" class="Symbol">∀{</a><a id="23678" href="/Substitution/#23678" class="Bound">Γ</a> <a id="23680" href="/Substitution/#23680" class="Bound">Δ</a> <a id="23682" href="/Substitution/#23682" class="Bound">Σ</a><a id="23683" class="Symbol">}{</a><a id="23685" href="/Substitution/#23685" class="Bound">A</a><a id="23686" class="Symbol">}{</a><a id="23688" href="/Substitution/#23688" class="Bound">M</a> <a id="23690" class="Symbol">:</a> <a id="23692" href="/Substitution/#23678" class="Bound">Γ</a> <a id="23694" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="23696" href="/Substitution/#23685" class="Bound">A</a><a id="23697" class="Symbol">}</a> <a id="23699" class="Symbol">{</a><a id="23700" href="/Substitution/#23700" class="Bound">σ₁</a> <a id="23703" class="Symbol">:</a> <a id="23705" href="/Substitution/#2504" class="Function">Subst</a> <a id="23711" href="/Substitution/#23678" class="Bound">Γ</a> <a id="23713" href="/Substitution/#23680" class="Bound">Δ</a><a id="23714" class="Symbol">}{</a><a id="23716" href="/Substitution/#23716" class="Bound">σ₂</a> <a id="23719" class="Symbol">:</a> <a id="23721" href="/Substitution/#2504" class="Function">Subst</a> <a id="23727" href="/Substitution/#23680" class="Bound">Δ</a> <a id="23729" href="/Substitution/#23682" class="Bound">Σ</a><a id="23730" class="Symbol">}</a>
            <a id="23744" class="Symbol">→</a> <a id="23746" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="23748" href="/Substitution/#23716" class="Bound">σ₂</a> <a id="23751" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="23753" class="Symbol">(</a><a id="23754" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="23756" href="/Substitution/#23700" class="Bound">σ₁</a> <a id="23759" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="23761" href="/Substitution/#23688" class="Bound">M</a><a id="23762" class="Symbol">)</a> <a id="23764" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="23766" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="23768" href="/Substitution/#23700" class="Bound">σ₁</a> <a id="23771" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="23773" href="/Substitution/#23716" class="Bound">σ₂</a> <a id="23776" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="23778" href="/Substitution/#23688" class="Bound">M</a>
<a id="23780" href="/Substitution/#23666" class="Function">sub-sub</a> <a id="23788" class="Symbol">{</a><a id="23789" class="Argument">M</a> <a id="23791" class="Symbol">=</a> <a id="23793" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="23795" href="/Substitution/#23795" class="Bound">x</a><a id="23796" class="Symbol">}</a> <a id="23798" class="Symbol">=</a> <a id="23800" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="23805" href="/Substitution/#23666" class="Function">sub-sub</a> <a id="23813" class="Symbol">{</a><a id="23814" href="/Substitution/#23814" class="Bound">Γ</a><a id="23815" class="Symbol">}{</a><a id="23817" href="/Substitution/#23817" class="Bound">Δ</a><a id="23818" class="Symbol">}{</a><a id="23820" href="/Substitution/#23820" class="Bound">Σ</a><a id="23821" class="Symbol">}{</a><a id="23823" href="/Substitution/#23823" class="Bound">A</a><a id="23824" class="Symbol">}{</a><a id="23826" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="23828" href="/Substitution/#23828" class="Bound">N</a><a id="23829" class="Symbol">}{</a><a id="23831" href="/Substitution/#23831" class="Bound">σ₁</a><a id="23833" class="Symbol">}{</a><a id="23835" href="/Substitution/#23835" class="Bound">σ₂</a><a id="23837" class="Symbol">}</a> <a id="23839" class="Symbol">=</a>
   <a id="23844" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
     <a id="23855" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="23857" href="/Substitution/#23835" class="Bound">σ₂</a> <a id="23860" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="23862" class="Symbol">(</a><a id="23863" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="23865" href="/Substitution/#23831" class="Bound">σ₁</a> <a id="23868" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="23870" class="Symbol">(</a><a id="23871" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="23873" href="/Substitution/#23828" class="Bound">N</a><a id="23874" class="Symbol">))</a>
   <a id="23880" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
     <a id="23889" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="23891" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="23893" href="/Untyped/#6623" class="Function">exts</a> <a id="23898" href="/Substitution/#23835" class="Bound">σ₂</a> <a id="23901" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="23903" class="Symbol">(</a><a id="23904" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="23906" href="/Untyped/#6623" class="Function">exts</a> <a id="23911" href="/Substitution/#23831" class="Bound">σ₁</a> <a id="23914" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="23916" href="/Substitution/#23828" class="Bound">N</a><a id="23917" class="Symbol">)</a>
   <a id="23922" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="23925" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="23930" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="23933" class="Symbol">(</a><a id="23934" href="/Substitution/#23666" class="Function">sub-sub</a><a id="23941" class="Symbol">{</a><a id="23942" class="Argument">M</a> <a id="23944" class="Symbol">=</a> <a id="23946" href="/Substitution/#23828" class="Bound">N</a><a id="23947" class="Symbol">}{</a><a id="23949" class="Argument">σ₁</a> <a id="23952" class="Symbol">=</a> <a id="23954" href="/Untyped/#6623" class="Function">exts</a> <a id="23959" href="/Substitution/#23831" class="Bound">σ₁</a><a id="23961" class="Symbol">}{</a><a id="23963" class="Argument">σ₂</a> <a id="23966" class="Symbol">=</a> <a id="23968" href="/Untyped/#6623" class="Function">exts</a> <a id="23973" href="/Substitution/#23835" class="Bound">σ₂</a><a id="23975" class="Symbol">})</a> <a id="23978" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="23985" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="23987" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="23989" href="/Untyped/#6623" class="Function">exts</a> <a id="23994" href="/Substitution/#23831" class="Bound">σ₁</a> <a id="23997" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="23999" href="/Untyped/#6623" class="Function">exts</a> <a id="24004" href="/Substitution/#23835" class="Bound">σ₂</a> <a id="24007" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="24009" href="/Substitution/#23828" class="Bound">N</a>
   <a id="24014" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="24017" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="24022" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="24025" class="Symbol">(</a><a id="24026" href="/Substitution/#11543" class="Function">cong-sub</a><a id="24034" class="Symbol">{</a><a id="24035" class="Argument">M</a> <a id="24037" class="Symbol">=</a> <a id="24039" href="/Substitution/#23828" class="Bound">N</a><a id="24040" class="Symbol">}</a> <a id="24042" class="Symbol">(λ</a> <a id="24045" class="Symbol">{</a><a id="24046" href="/Substitution/#24046" class="Bound">A</a><a id="24047" class="Symbol">}</a> <a id="24049" class="Symbol">→</a> <a id="24051" href="/Substitution/#22713" class="Function">exts-seq</a><a id="24059" class="Symbol">)</a> <a id="24061" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="24065" class="Symbol">)</a> <a id="24067" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="24074" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="24076" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="24078" href="/Untyped/#6623" class="Function">exts</a> <a id="24083" class="Symbol">(</a> <a id="24085" href="/Substitution/#23831" class="Bound">σ₁</a> <a id="24088" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="24090" href="/Substitution/#23835" class="Bound">σ₂</a><a id="24092" class="Symbol">)</a> <a id="24094" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="24096" href="/Substitution/#23828" class="Bound">N</a>
   <a id="24101" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>
<a id="24103" href="/Substitution/#23666" class="Function">sub-sub</a> <a id="24111" class="Symbol">{</a><a id="24112" class="Argument">M</a> <a id="24114" class="Symbol">=</a> <a id="24116" href="/Substitution/#24116" class="Bound">L</a> <a id="24118" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="24120" href="/Substitution/#24120" class="Bound">M</a><a id="24121" class="Symbol">}</a> <a id="24123" class="Symbol">=</a> <a id="24125" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="24131" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="24135" class="Symbol">(</a><a id="24136" href="/Substitution/#23666" class="Function">sub-sub</a><a id="24143" class="Symbol">{</a><a id="24144" class="Argument">M</a> <a id="24146" class="Symbol">=</a> <a id="24148" href="/Substitution/#24116" class="Bound">L</a><a id="24149" class="Symbol">})</a> <a id="24152" class="Symbol">(</a><a id="24153" href="/Substitution/#23666" class="Function">sub-sub</a><a id="24160" class="Symbol">{</a><a id="24161" class="Argument">M</a> <a id="24163" class="Symbol">=</a> <a id="24165" href="/Substitution/#24120" class="Bound">M</a><a id="24166" class="Symbol">})</a></pre>

<p>We proceed by induction on the term <code class="highlighter-rouge">M</code>.</p>

<ul>
  <li>
    <p>If <code class="highlighter-rouge">M = x</code>, then both sides are equal to <code class="highlighter-rouge">σ₂ (σ₁ x)</code>.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">M = ƛ N</code>, we first use the induction hypothesis to show that</p>

    <p>ƛ ⟪ exts σ₂ ⟫ (⟪ exts σ₁ ⟫ N) ≡ ƛ ⟪ exts σ₁ ⨟ exts σ₂ ⟫ N</p>

    <p>and then use the lemma <code class="highlighter-rouge">exts-seq</code> to show</p>

    <p>ƛ ⟪ exts σ₁ ⨟ exts σ₂ ⟫ N ≡ ƛ ⟪ exts ( σ₁ ⨟ σ₂) ⟫ N</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">M</code> is an application, we use the induction hypothesis
for both subterms.</p>
  </li>
</ul>

<p>The following corollary of <code class="highlighter-rouge">sub-sub</code> specializes the first
substitution to a renaming.</p>

<pre class="Agda"><a id="rename-subst"></a><a id="24698" href="/Substitution/#24698" class="Function">rename-subst</a> <a id="24711" class="Symbol">:</a> <a id="24713" class="Symbol">∀{</a><a id="24715" href="/Substitution/#24715" class="Bound">Γ</a> <a id="24717" href="/Substitution/#24717" class="Bound">Δ</a> <a id="24719" href="/Substitution/#24719" class="Bound">Δ′</a><a id="24721" class="Symbol">}{</a><a id="24723" href="/Substitution/#24723" class="Bound">M</a> <a id="24725" class="Symbol">:</a> <a id="24727" href="/Substitution/#24715" class="Bound">Γ</a> <a id="24729" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="24731" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="24732" class="Symbol">}{</a><a id="24734" href="/Substitution/#24734" class="Bound">ρ</a> <a id="24736" class="Symbol">:</a> <a id="24738" href="/Substitution/#2275" class="Function">Rename</a> <a id="24745" href="/Substitution/#24715" class="Bound">Γ</a> <a id="24747" href="/Substitution/#24717" class="Bound">Δ</a><a id="24748" class="Symbol">}{</a><a id="24750" href="/Substitution/#24750" class="Bound">σ</a> <a id="24752" class="Symbol">:</a> <a id="24754" href="/Substitution/#2504" class="Function">Subst</a> <a id="24760" href="/Substitution/#24717" class="Bound">Δ</a> <a id="24762" href="/Substitution/#24719" class="Bound">Δ′</a><a id="24764" class="Symbol">}</a>
             <a id="24779" class="Symbol">→</a> <a id="24781" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="24783" href="/Substitution/#24750" class="Bound">σ</a> <a id="24785" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="24787" class="Symbol">(</a><a id="24788" href="/Untyped/#6171" class="Function">rename</a> <a id="24795" href="/Substitution/#24734" class="Bound">ρ</a> <a id="24797" href="/Substitution/#24723" class="Bound">M</a><a id="24798" class="Symbol">)</a> <a id="24800" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="24802" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="24804" href="/Substitution/#24750" class="Bound">σ</a> <a id="24806" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="24808" href="/Substitution/#24734" class="Bound">ρ</a> <a id="24810" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="24812" href="/Substitution/#24723" class="Bound">M</a>
<a id="24814" href="/Substitution/#24698" class="Function">rename-subst</a> <a id="24827" class="Symbol">{</a><a id="24828" href="/Substitution/#24828" class="Bound">Γ</a><a id="24829" class="Symbol">}{</a><a id="24831" href="/Substitution/#24831" class="Bound">Δ</a><a id="24832" class="Symbol">}{</a><a id="24834" href="/Substitution/#24834" class="Bound">Δ′</a><a id="24836" class="Symbol">}{</a><a id="24838" href="/Substitution/#24838" class="Bound">M</a><a id="24839" class="Symbol">}{</a><a id="24841" href="/Substitution/#24841" class="Bound">ρ</a><a id="24842" class="Symbol">}{</a><a id="24844" href="/Substitution/#24844" class="Bound">σ</a><a id="24845" class="Symbol">}</a> <a id="24847" class="Symbol">=</a>
   <a id="24852" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
     <a id="24863" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="24865" href="/Substitution/#24844" class="Bound">σ</a> <a id="24867" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="24869" class="Symbol">(</a><a id="24870" href="/Untyped/#6171" class="Function">rename</a> <a id="24877" href="/Substitution/#24841" class="Bound">ρ</a> <a id="24879" href="/Substitution/#24838" class="Bound">M</a><a id="24880" class="Symbol">)</a>
   <a id="24885" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="24888" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="24893" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="24895" href="/Substitution/#24844" class="Bound">σ</a> <a id="24897" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="24899" class="Symbol">(</a><a id="24900" href="/Substitution/#14105" class="Function">rename-subst-ren</a><a id="24916" class="Symbol">{</a><a id="24917" class="Argument">M</a> <a id="24919" class="Symbol">=</a> <a id="24921" href="/Substitution/#24838" class="Bound">M</a><a id="24922" class="Symbol">})</a> <a id="24925" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="24932" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="24934" href="/Substitution/#24844" class="Bound">σ</a> <a id="24936" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="24938" class="Symbol">(</a><a id="24939" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="24941" href="/Substitution/#6693" class="Function">ren</a> <a id="24945" href="/Substitution/#24841" class="Bound">ρ</a> <a id="24947" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="24949" href="/Substitution/#24838" class="Bound">M</a><a id="24950" class="Symbol">)</a>
   <a id="24955" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="24958" href="/Substitution/#23666" class="Function">sub-sub</a><a id="24965" class="Symbol">{</a><a id="24966" class="Argument">M</a> <a id="24968" class="Symbol">=</a> <a id="24970" href="/Substitution/#24838" class="Bound">M</a><a id="24971" class="Symbol">}</a> <a id="24973" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="24980" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="24982" href="/Substitution/#6693" class="Function">ren</a> <a id="24986" href="/Substitution/#24841" class="Bound">ρ</a> <a id="24988" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="24990" href="/Substitution/#24844" class="Bound">σ</a> <a id="24992" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="24994" href="/Substitution/#24838" class="Bound">M</a>
   <a id="24999" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
     <a id="25008" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="25010" href="/Substitution/#24844" class="Bound">σ</a> <a id="25012" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="25014" href="/Substitution/#24841" class="Bound">ρ</a> <a id="25016" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="25018" href="/Substitution/#24838" class="Bound">M</a>
   <a id="25023" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="proof-of-sub-assoc">Proof of sub-assoc</h2>

<p>The proof of <code class="highlighter-rouge">sub-assoc</code> follows directly from <code class="highlighter-rouge">sub-sub</code> and the
definition of sequencing.</p>

<pre class="Agda"><a id="sub-assoc"></a><a id="25166" href="/Substitution/#25166" class="Function">sub-assoc</a> <a id="25176" class="Symbol">:</a> <a id="25178" class="Symbol">∀{</a><a id="25180" href="/Substitution/#25180" class="Bound">Γ</a> <a id="25182" href="/Substitution/#25182" class="Bound">Δ</a> <a id="25184" href="/Substitution/#25184" class="Bound">Σ</a> <a id="25186" href="/Substitution/#25186" class="Bound">Ψ</a> <a id="25188" class="Symbol">:</a> <a id="25190" href="/Untyped/#2980" class="Datatype">Context</a><a id="25197" class="Symbol">}</a> <a id="25199" class="Symbol">{</a><a id="25200" href="/Substitution/#25200" class="Bound">σ</a> <a id="25202" class="Symbol">:</a> <a id="25204" href="/Substitution/#2504" class="Function">Subst</a> <a id="25210" href="/Substitution/#25180" class="Bound">Γ</a> <a id="25212" href="/Substitution/#25182" class="Bound">Δ</a><a id="25213" class="Symbol">}</a> <a id="25215" class="Symbol">{</a><a id="25216" href="/Substitution/#25216" class="Bound">τ</a> <a id="25218" class="Symbol">:</a> <a id="25220" href="/Substitution/#2504" class="Function">Subst</a> <a id="25226" href="/Substitution/#25182" class="Bound">Δ</a> <a id="25228" href="/Substitution/#25184" class="Bound">Σ</a><a id="25229" class="Symbol">}</a>
             <a id="25244" class="Symbol">{</a><a id="25245" href="/Substitution/#25245" class="Bound">θ</a> <a id="25247" class="Symbol">:</a> <a id="25249" href="/Substitution/#2504" class="Function">Subst</a> <a id="25255" href="/Substitution/#25184" class="Bound">Σ</a> <a id="25257" href="/Substitution/#25186" class="Bound">Ψ</a><a id="25258" class="Symbol">}</a>
          <a id="25270" class="Symbol">→</a> <a id="25272" class="Symbol">∀{</a><a id="25274" href="/Substitution/#25274" class="Bound">A</a><a id="25275" class="Symbol">}</a> <a id="25277" class="Symbol">→</a> <a id="25279" class="Symbol">(</a><a id="25280" href="/Substitution/#25200" class="Bound">σ</a> <a id="25282" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="25284" href="/Substitution/#25216" class="Bound">τ</a><a id="25285" class="Symbol">)</a> <a id="25287" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="25289" href="/Substitution/#25245" class="Bound">θ</a> <a id="25291" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="25293" class="Symbol">(</a><a id="25294" href="/Substitution/#25200" class="Bound">σ</a> <a id="25296" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="25298" href="/Substitution/#25216" class="Bound">τ</a> <a id="25300" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="25302" href="/Substitution/#25245" class="Bound">θ</a><a id="25303" class="Symbol">)</a> <a id="25305" class="Symbol">{</a><a id="25306" href="/Substitution/#25274" class="Bound">A</a><a id="25307" class="Symbol">}</a>
<a id="25309" href="/Substitution/#25166" class="Function">sub-assoc</a> <a id="25319" class="Symbol">{</a><a id="25320" href="/Substitution/#25320" class="Bound">Γ</a><a id="25321" class="Symbol">}{</a><a id="25323" href="/Substitution/#25323" class="Bound">Δ</a><a id="25324" class="Symbol">}{</a><a id="25326" href="/Substitution/#25326" class="Bound">Σ</a><a id="25327" class="Symbol">}{</a><a id="25329" href="/Substitution/#25329" class="Bound">Ψ</a><a id="25330" class="Symbol">}{</a><a id="25332" href="/Substitution/#25332" class="Bound">σ</a><a id="25333" class="Symbol">}{</a><a id="25335" href="/Substitution/#25335" class="Bound">τ</a><a id="25336" class="Symbol">}{</a><a id="25338" href="/Substitution/#25338" class="Bound">θ</a><a id="25339" class="Symbol">}{</a><a id="25341" href="/Substitution/#25341" class="Bound">A</a><a id="25342" class="Symbol">}</a> <a id="25344" class="Symbol">=</a> <a id="25346" href="/Substitution/#1994" class="Postulate">extensionality</a> <a id="25361" class="Symbol">λ</a> <a id="25363" href="/Substitution/#25363" class="Bound">x</a> <a id="25365" class="Symbol">→</a> <a id="25367" href="/Substitution/#25390" class="Function">lemma</a><a id="25372" class="Symbol">{</a><a id="25373" class="Argument">x</a> <a id="25375" class="Symbol">=</a> <a id="25377" href="/Substitution/#25363" class="Bound">x</a><a id="25378" class="Symbol">}</a>
  <a id="25382" class="Keyword">where</a>
  <a id="25390" href="/Substitution/#25390" class="Function">lemma</a> <a id="25396" class="Symbol">:</a> <a id="25398" class="Symbol">∀</a> <a id="25400" class="Symbol">{</a><a id="25401" href="/Substitution/#25401" class="Bound">x</a> <a id="25403" class="Symbol">:</a> <a id="25405" href="/Substitution/#25320" class="Bound">Γ</a> <a id="25407" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="25409" href="/Substitution/#25341" class="Bound">A</a><a id="25410" class="Symbol">}</a> <a id="25412" class="Symbol">→</a> <a id="25414" class="Symbol">((</a><a id="25416" href="/Substitution/#25332" class="Bound">σ</a> <a id="25418" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="25420" href="/Substitution/#25335" class="Bound">τ</a><a id="25421" class="Symbol">)</a> <a id="25423" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="25425" href="/Substitution/#25338" class="Bound">θ</a><a id="25426" class="Symbol">)</a> <a id="25428" href="/Substitution/#25401" class="Bound">x</a> <a id="25430" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="25432" class="Symbol">(</a><a id="25433" href="/Substitution/#25332" class="Bound">σ</a> <a id="25435" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="25437" href="/Substitution/#25335" class="Bound">τ</a> <a id="25439" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="25441" href="/Substitution/#25338" class="Bound">θ</a><a id="25442" class="Symbol">)</a> <a id="25444" href="/Substitution/#25401" class="Bound">x</a>
  <a id="25448" href="/Substitution/#25390" class="Function">lemma</a> <a id="25454" class="Symbol">{</a><a id="25455" href="/Substitution/#25455" class="Bound">x</a><a id="25456" class="Symbol">}</a> <a id="25458" class="Symbol">=</a>
      <a id="25466" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
        <a id="25480" class="Symbol">((</a><a id="25482" href="/Substitution/#25332" class="Bound">σ</a> <a id="25484" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="25486" href="/Substitution/#25335" class="Bound">τ</a><a id="25487" class="Symbol">)</a> <a id="25489" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="25491" href="/Substitution/#25338" class="Bound">θ</a><a id="25492" class="Symbol">)</a> <a id="25494" href="/Substitution/#25455" class="Bound">x</a>
      <a id="25502" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
        <a id="25514" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="25516" href="/Substitution/#25338" class="Bound">θ</a> <a id="25518" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="25520" class="Symbol">(</a><a id="25521" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="25523" href="/Substitution/#25335" class="Bound">τ</a> <a id="25525" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="25527" class="Symbol">(</a><a id="25528" href="/Substitution/#25332" class="Bound">σ</a> <a id="25530" href="/Substitution/#25455" class="Bound">x</a><a id="25531" class="Symbol">))</a>
      <a id="25540" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="25543" href="/Substitution/#23666" class="Function">sub-sub</a><a id="25550" class="Symbol">{</a><a id="25551" class="Argument">M</a> <a id="25553" class="Symbol">=</a> <a id="25555" href="/Substitution/#25332" class="Bound">σ</a> <a id="25557" href="/Substitution/#25455" class="Bound">x</a><a id="25558" class="Symbol">}</a> <a id="25560" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
        <a id="25570" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="25572" href="/Substitution/#25335" class="Bound">τ</a> <a id="25574" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="25576" href="/Substitution/#25338" class="Bound">θ</a> <a id="25578" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="25580" class="Symbol">(</a><a id="25581" href="/Substitution/#25332" class="Bound">σ</a> <a id="25583" href="/Substitution/#25455" class="Bound">x</a><a id="25584" class="Symbol">)</a>
      <a id="25592" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
        <a id="25604" class="Symbol">(</a><a id="25605" href="/Substitution/#25332" class="Bound">σ</a> <a id="25607" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="25609" href="/Substitution/#25335" class="Bound">τ</a> <a id="25611" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="25613" href="/Substitution/#25338" class="Bound">θ</a><a id="25614" class="Symbol">)</a> <a id="25616" href="/Substitution/#25455" class="Bound">x</a>
      <a id="25624" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="proof-of-subst-zero-exts-cons">Proof of subst-zero-exts-cons</h2>

<p>The last equation we needed to prove <code class="highlighter-rouge">subst-zero-exts-cons</code> was
<code class="highlighter-rouge">sub-assoc</code>, so we can now go ahead with its proof.  We simply apply
the equations for <code class="highlighter-rouge">exts</code> and <code class="highlighter-rouge">subst-zero</code> and then apply the σ algebra
equation to arrive at the normal form <code class="highlighter-rouge">M • σ</code>.</p>

<pre class="Agda"><a id="subst-zero-exts-cons"></a><a id="25937" href="/Substitution/#25937" class="Function">subst-zero-exts-cons</a> <a id="25958" class="Symbol">:</a> <a id="25960" class="Symbol">∀{</a><a id="25962" href="/Substitution/#25962" class="Bound">Γ</a> <a id="25964" href="/Substitution/#25964" class="Bound">Δ</a><a id="25965" class="Symbol">}{</a><a id="25967" href="/Substitution/#25967" class="Bound">σ</a> <a id="25969" class="Symbol">:</a> <a id="25971" href="/Substitution/#2504" class="Function">Subst</a> <a id="25977" href="/Substitution/#25962" class="Bound">Γ</a> <a id="25979" href="/Substitution/#25964" class="Bound">Δ</a><a id="25980" class="Symbol">}{</a><a id="25982" href="/Substitution/#25982" class="Bound">B</a><a id="25983" class="Symbol">}{</a><a id="25985" href="/Substitution/#25985" class="Bound">M</a> <a id="25987" class="Symbol">:</a> <a id="25989" href="/Substitution/#25964" class="Bound">Δ</a> <a id="25991" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="25993" href="/Substitution/#25982" class="Bound">B</a><a id="25994" class="Symbol">}{</a><a id="25996" href="/Substitution/#25996" class="Bound">A</a><a id="25997" class="Symbol">}</a>
                     <a id="26020" class="Symbol">→</a> <a id="26022" href="/Untyped/#6623" class="Function">exts</a> <a id="26027" href="/Substitution/#25967" class="Bound">σ</a> <a id="26029" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="26031" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="26042" href="/Substitution/#25985" class="Bound">M</a> <a id="26044" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="26046" class="Symbol">(</a><a id="26047" href="/Substitution/#25985" class="Bound">M</a> <a id="26049" href="/Substitution/#3590" class="Function Operator">•</a> <a id="26051" href="/Substitution/#25967" class="Bound">σ</a><a id="26052" class="Symbol">)</a> <a id="26054" class="Symbol">{</a><a id="26055" href="/Substitution/#25996" class="Bound">A</a><a id="26056" class="Symbol">}</a>
<a id="26058" href="/Substitution/#25937" class="Function">subst-zero-exts-cons</a> <a id="26079" class="Symbol">{</a><a id="26080" href="/Substitution/#26080" class="Bound">Γ</a><a id="26081" class="Symbol">}{</a><a id="26083" href="/Substitution/#26083" class="Bound">Δ</a><a id="26084" class="Symbol">}{</a><a id="26086" href="/Substitution/#26086" class="Bound">σ</a><a id="26087" class="Symbol">}{</a><a id="26089" href="/Substitution/#26089" class="Bound">B</a><a id="26090" class="Symbol">}{</a><a id="26092" href="/Substitution/#26092" class="Bound">M</a><a id="26093" class="Symbol">}{</a><a id="26095" href="/Substitution/#26095" class="Bound">A</a><a id="26096" class="Symbol">}</a> <a id="26098" class="Symbol">=</a>
    <a id="26104" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
      <a id="26116" href="/Untyped/#6623" class="Function">exts</a> <a id="26121" href="/Substitution/#26086" class="Bound">σ</a> <a id="26123" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="26125" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="26136" href="/Substitution/#26092" class="Bound">M</a>
    <a id="26142" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26145" href="/Substitution/#12675" class="Function">cong-seq</a> <a id="26154" href="/Substitution/#15517" class="Function">exts-cons-shift</a> <a id="26170" href="/Substitution/#16330" class="Function">subst-Z-cons-ids</a> <a id="26187" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="26195" class="Symbol">(</a><a id="26196" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="26198" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="26200" href="/Substitution/#3590" class="Function Operator">•</a> <a id="26202" class="Symbol">(</a><a id="26203" href="/Substitution/#26086" class="Bound">σ</a> <a id="26205" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="26207" href="/Substitution/#3332" class="Function">↑</a><a id="26208" class="Symbol">))</a> <a id="26211" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="26213" class="Symbol">(</a><a id="26214" href="/Substitution/#26092" class="Bound">M</a> <a id="26216" href="/Substitution/#3590" class="Function Operator">•</a> <a id="26218" href="/Substitution/#3177" class="Function">ids</a><a id="26221" class="Symbol">)</a>
    <a id="26227" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26230" href="/Substitution/#9365" class="Function">sub-dist</a> <a id="26239" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="26247" class="Symbol">(</a><a id="26248" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="26250" href="/Substitution/#26092" class="Bound">M</a> <a id="26252" href="/Substitution/#3590" class="Function Operator">•</a> <a id="26254" href="/Substitution/#3177" class="Function">ids</a> <a id="26258" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="26260" class="Symbol">(</a><a id="26261" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="26263" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="26264" class="Symbol">))</a> <a id="26267" href="/Substitution/#3590" class="Function Operator">•</a> <a id="26269" class="Symbol">((</a><a id="26271" href="/Substitution/#26086" class="Bound">σ</a> <a id="26273" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="26275" href="/Substitution/#3332" class="Function">↑</a><a id="26276" class="Symbol">)</a> <a id="26278" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="26280" class="Symbol">(</a><a id="26281" href="/Substitution/#26092" class="Bound">M</a> <a id="26283" href="/Substitution/#3590" class="Function Operator">•</a> <a id="26285" href="/Substitution/#3177" class="Function">ids</a><a id="26288" class="Symbol">))</a>
    <a id="26295" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26298" href="/Substitution/#12314" class="Function">cong-cons</a> <a id="26308" class="Symbol">(</a><a id="26309" href="/Substitution/#8470" class="Function">sub-head</a><a id="26317" class="Symbol">{</a><a id="26318" class="Argument">σ</a> <a id="26320" class="Symbol">=</a> <a id="26322" href="/Substitution/#3177" class="Function">ids</a><a id="26325" class="Symbol">})</a> <a id="26328" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26333" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="26341" href="/Substitution/#26092" class="Bound">M</a> <a id="26343" href="/Substitution/#3590" class="Function Operator">•</a> <a id="26345" class="Symbol">((</a><a id="26347" href="/Substitution/#26086" class="Bound">σ</a> <a id="26349" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="26351" href="/Substitution/#3332" class="Function">↑</a><a id="26352" class="Symbol">)</a> <a id="26354" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="26356" class="Symbol">(</a><a id="26357" href="/Substitution/#26092" class="Bound">M</a> <a id="26359" href="/Substitution/#3590" class="Function Operator">•</a> <a id="26361" href="/Substitution/#3177" class="Function">ids</a><a id="26364" class="Symbol">))</a>
    <a id="26371" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26374" href="/Substitution/#12314" class="Function">cong-cons</a> <a id="26384" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26389" class="Symbol">(</a><a id="26390" href="/Substitution/#25166" class="Function">sub-assoc</a><a id="26399" class="Symbol">{</a><a id="26400" class="Argument">σ</a> <a id="26402" class="Symbol">=</a> <a id="26404" href="/Substitution/#26086" class="Bound">σ</a><a id="26405" class="Symbol">})</a> <a id="26408" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="26416" href="/Substitution/#26092" class="Bound">M</a> <a id="26418" href="/Substitution/#3590" class="Function Operator">•</a> <a id="26420" class="Symbol">(</a><a id="26421" href="/Substitution/#26086" class="Bound">σ</a> <a id="26423" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="26425" class="Symbol">(</a><a id="26426" href="/Substitution/#3332" class="Function">↑</a> <a id="26428" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="26430" class="Symbol">(</a><a id="26431" href="/Substitution/#26092" class="Bound">M</a> <a id="26433" href="/Substitution/#3590" class="Function Operator">•</a> <a id="26435" href="/Substitution/#3177" class="Function">ids</a><a id="26438" class="Symbol">)))</a>
    <a id="26446" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26449" href="/Substitution/#12314" class="Function">cong-cons</a> <a id="26459" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26464" class="Symbol">(</a><a id="26465" href="/Substitution/#12675" class="Function">cong-seq</a><a id="26473" class="Symbol">{</a><a id="26474" class="Argument">σ</a> <a id="26476" class="Symbol">=</a> <a id="26478" href="/Substitution/#26086" class="Bound">σ</a><a id="26479" class="Symbol">}</a> <a id="26481" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26486" class="Symbol">(</a><a id="26487" href="/Substitution/#8592" class="Function">sub-tail</a><a id="26495" class="Symbol">{</a><a id="26496" class="Argument">M</a> <a id="26498" class="Symbol">=</a> <a id="26500" href="/Substitution/#26092" class="Bound">M</a><a id="26501" class="Symbol">}{</a><a id="26503" class="Argument">σ</a> <a id="26505" class="Symbol">=</a> <a id="26507" href="/Substitution/#3177" class="Function">ids</a><a id="26510" class="Symbol">}))</a> <a id="26514" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="26522" href="/Substitution/#26092" class="Bound">M</a> <a id="26524" href="/Substitution/#3590" class="Function Operator">•</a> <a id="26526" class="Symbol">(</a><a id="26527" href="/Substitution/#26086" class="Bound">σ</a> <a id="26529" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="26531" href="/Substitution/#3177" class="Function">ids</a><a id="26534" class="Symbol">)</a>
    <a id="26540" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26543" href="/Substitution/#12314" class="Function">cong-cons</a> <a id="26553" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26558" class="Symbol">(</a><a id="26559" href="/Substitution/#18275" class="Function">sub-idR</a><a id="26566" class="Symbol">{</a><a id="26567" class="Argument">σ</a> <a id="26569" class="Symbol">=</a> <a id="26571" href="/Substitution/#26086" class="Bound">σ</a><a id="26572" class="Symbol">})</a> <a id="26575" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="26583" href="/Substitution/#26092" class="Bound">M</a> <a id="26585" href="/Substitution/#3590" class="Function Operator">•</a> <a id="26587" href="/Substitution/#26086" class="Bound">σ</a>
    <a id="26593" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="proof-of-the-substitution-lemma">Proof of the substitution lemma</h2>

<p>We first prove the generalized form of the substitution lemma, showing
that a substitution <code class="highlighter-rouge">σ</code> commutes with the substitution of <code class="highlighter-rouge">M</code> into
<code class="highlighter-rouge">N</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪ exts σ ⟫ N [ ⟪ σ ⟫ M ] ≡ ⟪ σ ⟫ (N [ M ])
</code></pre></div></div>

<p>This proof is where the σ algebra pays off.  The proof is by direct
equational reasoning. Starting with the left-hand side, we apply σ
algebra equations, oriented left-to-right, until we arrive at the
normal form</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪ ⟪ σ ⟫ M • σ ⟫ N
</code></pre></div></div>

<p>We then do the same with the right-hand side, arriving at the same
normal form.</p>

<pre class="Agda"><a id="subst-commute"></a><a id="27167" href="/Substitution/#27167" class="Function">subst-commute</a> <a id="27181" class="Symbol">:</a> <a id="27183" class="Symbol">∀{</a><a id="27185" href="/Substitution/#27185" class="Bound">Γ</a> <a id="27187" href="/Substitution/#27187" class="Bound">Δ</a><a id="27188" class="Symbol">}{</a><a id="27190" href="/Substitution/#27190" class="Bound">N</a> <a id="27192" class="Symbol">:</a> <a id="27194" href="/Substitution/#27185" class="Bound">Γ</a> <a id="27196" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="27198" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="27200" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="27202" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="27203" class="Symbol">}{</a><a id="27205" href="/Substitution/#27205" class="Bound">M</a> <a id="27207" class="Symbol">:</a> <a id="27209" href="/Substitution/#27185" class="Bound">Γ</a> <a id="27211" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="27213" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="27214" class="Symbol">}{</a><a id="27216" href="/Substitution/#27216" class="Bound">σ</a> <a id="27218" class="Symbol">:</a> <a id="27220" href="/Substitution/#2504" class="Function">Subst</a> <a id="27226" href="/Substitution/#27185" class="Bound">Γ</a> <a id="27228" href="/Substitution/#27187" class="Bound">Δ</a> <a id="27230" class="Symbol">}</a>
    <a id="27236" class="Symbol">→</a> <a id="27238" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27240" href="/Untyped/#6623" class="Function">exts</a> <a id="27245" href="/Substitution/#27216" class="Bound">σ</a> <a id="27247" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27249" href="/Substitution/#27190" class="Bound">N</a> <a id="27251" href="/Untyped/#7475" class="Function Operator">[</a> <a id="27253" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27255" href="/Substitution/#27216" class="Bound">σ</a> <a id="27257" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27259" href="/Substitution/#27205" class="Bound">M</a> <a id="27261" href="/Untyped/#7475" class="Function Operator">]</a> <a id="27263" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="27265" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27267" href="/Substitution/#27216" class="Bound">σ</a> <a id="27269" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27271" class="Symbol">(</a><a id="27272" href="/Substitution/#27190" class="Bound">N</a> <a id="27274" href="/Untyped/#7475" class="Function Operator">[</a> <a id="27276" href="/Substitution/#27205" class="Bound">M</a> <a id="27278" href="/Untyped/#7475" class="Function Operator">]</a><a id="27279" class="Symbol">)</a>
<a id="27281" href="/Substitution/#27167" class="Function">subst-commute</a> <a id="27295" class="Symbol">{</a><a id="27296" href="/Substitution/#27296" class="Bound">Γ</a><a id="27297" class="Symbol">}{</a><a id="27299" href="/Substitution/#27299" class="Bound">Δ</a><a id="27300" class="Symbol">}{</a><a id="27302" href="/Substitution/#27302" class="Bound">N</a><a id="27303" class="Symbol">}{</a><a id="27305" href="/Substitution/#27305" class="Bound">M</a><a id="27306" class="Symbol">}{</a><a id="27308" href="/Substitution/#27308" class="Bound">σ</a><a id="27309" class="Symbol">}</a> <a id="27311" class="Symbol">=</a>
     <a id="27318" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="27331" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27333" href="/Untyped/#6623" class="Function">exts</a> <a id="27338" href="/Substitution/#27308" class="Bound">σ</a> <a id="27340" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27342" href="/Substitution/#27302" class="Bound">N</a> <a id="27344" href="/Untyped/#7475" class="Function Operator">[</a> <a id="27346" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27348" href="/Substitution/#27308" class="Bound">σ</a> <a id="27350" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27352" href="/Substitution/#27305" class="Bound">M</a> <a id="27354" href="/Untyped/#7475" class="Function Operator">]</a>
     <a id="27361" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="27372" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27374" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="27385" class="Symbol">(</a><a id="27386" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27388" href="/Substitution/#27308" class="Bound">σ</a> <a id="27390" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27392" href="/Substitution/#27305" class="Bound">M</a><a id="27393" class="Symbol">)</a> <a id="27395" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27397" class="Symbol">(</a><a id="27398" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27400" href="/Untyped/#6623" class="Function">exts</a> <a id="27405" href="/Substitution/#27308" class="Bound">σ</a> <a id="27407" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27409" href="/Substitution/#27302" class="Bound">N</a><a id="27410" class="Symbol">)</a>
     <a id="27417" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="27420" href="/Substitution/#11543" class="Function">cong-sub</a> <a id="27429" class="Symbol">{</a><a id="27430" class="Argument">M</a> <a id="27432" class="Symbol">=</a> <a id="27434" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27436" href="/Untyped/#6623" class="Function">exts</a> <a id="27441" href="/Substitution/#27308" class="Bound">σ</a> <a id="27443" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27445" href="/Substitution/#27302" class="Bound">N</a><a id="27446" class="Symbol">}</a> <a id="27448" href="/Substitution/#16330" class="Function">subst-Z-cons-ids</a> <a id="27465" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="27470" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="27479" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27481" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27483" href="/Substitution/#27308" class="Bound">σ</a> <a id="27485" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27487" href="/Substitution/#27305" class="Bound">M</a> <a id="27489" href="/Substitution/#3590" class="Function Operator">•</a> <a id="27491" href="/Substitution/#3177" class="Function">ids</a> <a id="27495" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27497" class="Symbol">(</a><a id="27498" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27500" href="/Untyped/#6623" class="Function">exts</a> <a id="27505" href="/Substitution/#27308" class="Bound">σ</a> <a id="27507" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27509" href="/Substitution/#27302" class="Bound">N</a><a id="27510" class="Symbol">)</a>
     <a id="27517" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="27520" href="/Substitution/#23666" class="Function">sub-sub</a> <a id="27528" class="Symbol">{</a><a id="27529" class="Argument">M</a> <a id="27531" class="Symbol">=</a> <a id="27533" href="/Substitution/#27302" class="Bound">N</a><a id="27534" class="Symbol">}</a> <a id="27536" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="27545" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27547" class="Symbol">(</a><a id="27548" href="/Untyped/#6623" class="Function">exts</a> <a id="27553" href="/Substitution/#27308" class="Bound">σ</a><a id="27554" class="Symbol">)</a> <a id="27556" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="27558" class="Symbol">((</a><a id="27560" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27562" href="/Substitution/#27308" class="Bound">σ</a> <a id="27564" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27566" href="/Substitution/#27305" class="Bound">M</a><a id="27567" class="Symbol">)</a> <a id="27569" href="/Substitution/#3590" class="Function Operator">•</a> <a id="27571" href="/Substitution/#3177" class="Function">ids</a><a id="27574" class="Symbol">)</a> <a id="27576" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27578" href="/Substitution/#27302" class="Bound">N</a>
     <a id="27585" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="27588" href="/Substitution/#11543" class="Function">cong-sub</a> <a id="27597" class="Symbol">{</a><a id="27598" class="Argument">M</a> <a id="27600" class="Symbol">=</a> <a id="27602" href="/Substitution/#27302" class="Bound">N</a><a id="27603" class="Symbol">}</a> <a id="27605" class="Symbol">(</a><a id="27606" href="/Substitution/#12675" class="Function">cong-seq</a> <a id="27615" href="/Substitution/#15517" class="Function">exts-cons-shift</a> <a id="27631" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="27635" class="Symbol">)</a> <a id="27637" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="27642" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="27651" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27653" class="Symbol">(</a><a id="27654" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="27656" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="27658" href="/Substitution/#3590" class="Function Operator">•</a> <a id="27660" class="Symbol">(</a><a id="27661" href="/Substitution/#27308" class="Bound">σ</a> <a id="27663" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="27665" href="/Substitution/#3332" class="Function">↑</a><a id="27666" class="Symbol">))</a> <a id="27669" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="27671" class="Symbol">(</a><a id="27672" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27674" href="/Substitution/#27308" class="Bound">σ</a> <a id="27676" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27678" href="/Substitution/#27305" class="Bound">M</a> <a id="27680" href="/Substitution/#3590" class="Function Operator">•</a> <a id="27682" href="/Substitution/#3177" class="Function">ids</a><a id="27685" class="Symbol">)</a> <a id="27687" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27689" href="/Substitution/#27302" class="Bound">N</a>
     <a id="27696" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="27699" href="/Substitution/#11543" class="Function">cong-sub</a> <a id="27708" class="Symbol">{</a><a id="27709" class="Argument">M</a> <a id="27711" class="Symbol">=</a> <a id="27713" href="/Substitution/#27302" class="Bound">N</a><a id="27714" class="Symbol">}</a> <a id="27716" class="Symbol">(</a><a id="27717" href="/Substitution/#9365" class="Function">sub-dist</a> <a id="27726" class="Symbol">{</a><a id="27727" class="Argument">M</a> <a id="27729" class="Symbol">=</a> <a id="27731" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="27733" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="27734" class="Symbol">})</a> <a id="27737" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="27742" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="27751" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27753" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27755" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27757" href="/Substitution/#27308" class="Bound">σ</a> <a id="27759" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27761" href="/Substitution/#27305" class="Bound">M</a> <a id="27763" href="/Substitution/#3590" class="Function Operator">•</a> <a id="27765" href="/Substitution/#3177" class="Function">ids</a> <a id="27769" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27771" class="Symbol">(</a><a id="27772" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="27774" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="27775" class="Symbol">)</a> <a id="27777" href="/Substitution/#3590" class="Function Operator">•</a> <a id="27779" class="Symbol">((</a><a id="27781" href="/Substitution/#27308" class="Bound">σ</a> <a id="27783" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="27785" href="/Substitution/#3332" class="Function">↑</a><a id="27786" class="Symbol">)</a> <a id="27788" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="27790" class="Symbol">(</a><a id="27791" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27793" href="/Substitution/#27308" class="Bound">σ</a> <a id="27795" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27797" href="/Substitution/#27305" class="Bound">M</a> <a id="27799" href="/Substitution/#3590" class="Function Operator">•</a> <a id="27801" href="/Substitution/#3177" class="Function">ids</a><a id="27804" class="Symbol">))</a> <a id="27807" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27809" href="/Substitution/#27302" class="Bound">N</a>
     <a id="27816" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="27827" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27829" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27831" href="/Substitution/#27308" class="Bound">σ</a> <a id="27833" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27835" href="/Substitution/#27305" class="Bound">M</a> <a id="27837" href="/Substitution/#3590" class="Function Operator">•</a> <a id="27839" class="Symbol">((</a><a id="27841" href="/Substitution/#27308" class="Bound">σ</a> <a id="27843" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="27845" href="/Substitution/#3332" class="Function">↑</a><a id="27846" class="Symbol">)</a> <a id="27848" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="27850" class="Symbol">(</a><a id="27851" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27853" href="/Substitution/#27308" class="Bound">σ</a> <a id="27855" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27857" href="/Substitution/#27305" class="Bound">M</a> <a id="27859" href="/Substitution/#3590" class="Function Operator">•</a> <a id="27861" href="/Substitution/#3177" class="Function">ids</a><a id="27864" class="Symbol">))</a> <a id="27867" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27869" href="/Substitution/#27302" class="Bound">N</a>
     <a id="27876" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="27879" href="/Substitution/#11543" class="Function">cong-sub</a><a id="27887" class="Symbol">{</a><a id="27888" class="Argument">M</a> <a id="27890" class="Symbol">=</a> <a id="27892" href="/Substitution/#27302" class="Bound">N</a><a id="27893" class="Symbol">}</a> <a id="27895" class="Symbol">(</a><a id="27896" href="/Substitution/#12314" class="Function">cong-cons</a> <a id="27906" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="27911" class="Symbol">(</a><a id="27912" href="/Substitution/#25166" class="Function">sub-assoc</a><a id="27921" class="Symbol">{</a><a id="27922" class="Argument">σ</a> <a id="27924" class="Symbol">=</a> <a id="27926" href="/Substitution/#27308" class="Bound">σ</a><a id="27927" class="Symbol">}))</a> <a id="27931" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="27936" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="27945" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27947" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27949" href="/Substitution/#27308" class="Bound">σ</a> <a id="27951" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27953" href="/Substitution/#27305" class="Bound">M</a> <a id="27955" href="/Substitution/#3590" class="Function Operator">•</a> <a id="27957" class="Symbol">(</a><a id="27958" href="/Substitution/#27308" class="Bound">σ</a> <a id="27960" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="27962" href="/Substitution/#3332" class="Function">↑</a> <a id="27964" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="27966" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="27968" href="/Substitution/#27308" class="Bound">σ</a> <a id="27970" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27972" href="/Substitution/#27305" class="Bound">M</a> <a id="27974" href="/Substitution/#3590" class="Function Operator">•</a> <a id="27976" href="/Substitution/#3177" class="Function">ids</a><a id="27979" class="Symbol">)</a> <a id="27981" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="27983" href="/Substitution/#27302" class="Bound">N</a>
     <a id="27990" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="27993" href="/Substitution/#11543" class="Function">cong-sub</a><a id="28001" class="Symbol">{</a><a id="28002" class="Argument">M</a> <a id="28004" class="Symbol">=</a> <a id="28006" href="/Substitution/#27302" class="Bound">N</a><a id="28007" class="Symbol">}</a> <a id="28009" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="28014" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="28019" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="28028" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="28030" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="28032" href="/Substitution/#27308" class="Bound">σ</a> <a id="28034" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="28036" href="/Substitution/#27305" class="Bound">M</a> <a id="28038" href="/Substitution/#3590" class="Function Operator">•</a> <a id="28040" class="Symbol">(</a><a id="28041" href="/Substitution/#27308" class="Bound">σ</a> <a id="28043" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="28045" href="/Substitution/#3177" class="Function">ids</a><a id="28048" class="Symbol">)</a> <a id="28050" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="28052" href="/Substitution/#27302" class="Bound">N</a>
     <a id="28059" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="28062" href="/Substitution/#11543" class="Function">cong-sub</a><a id="28070" class="Symbol">{</a><a id="28071" class="Argument">M</a> <a id="28073" class="Symbol">=</a> <a id="28075" href="/Substitution/#27302" class="Bound">N</a><a id="28076" class="Symbol">}</a> <a id="28078" class="Symbol">(</a><a id="28079" href="/Substitution/#12314" class="Function">cong-cons</a> <a id="28089" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="28094" class="Symbol">(</a><a id="28095" href="/Substitution/#18275" class="Function">sub-idR</a><a id="28102" class="Symbol">{</a><a id="28103" class="Argument">σ</a> <a id="28105" class="Symbol">=</a> <a id="28107" href="/Substitution/#27308" class="Bound">σ</a><a id="28108" class="Symbol">}))</a> <a id="28112" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="28117" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="28126" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="28128" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="28130" href="/Substitution/#27308" class="Bound">σ</a> <a id="28132" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="28134" href="/Substitution/#27305" class="Bound">M</a> <a id="28136" href="/Substitution/#3590" class="Function Operator">•</a> <a id="28138" href="/Substitution/#27308" class="Bound">σ</a> <a id="28140" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="28142" href="/Substitution/#27302" class="Bound">N</a>
     <a id="28149" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="28152" href="/Substitution/#11543" class="Function">cong-sub</a><a id="28160" class="Symbol">{</a><a id="28161" class="Argument">M</a> <a id="28163" class="Symbol">=</a> <a id="28165" href="/Substitution/#27302" class="Bound">N</a><a id="28166" class="Symbol">}</a> <a id="28168" class="Symbol">(</a><a id="28169" href="/Substitution/#12314" class="Function">cong-cons</a> <a id="28179" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="28184" class="Symbol">(</a><a id="28185" href="/Substitution/#9242" class="Function">sub-idL</a><a id="28192" class="Symbol">{</a><a id="28193" class="Argument">σ</a> <a id="28195" class="Symbol">=</a> <a id="28197" href="/Substitution/#27308" class="Bound">σ</a><a id="28198" class="Symbol">}))</a> <a id="28202" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="28207" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="28216" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="28218" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="28220" href="/Substitution/#27308" class="Bound">σ</a> <a id="28222" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="28224" href="/Substitution/#27305" class="Bound">M</a> <a id="28226" href="/Substitution/#3590" class="Function Operator">•</a> <a id="28228" class="Symbol">(</a><a id="28229" href="/Substitution/#3177" class="Function">ids</a> <a id="28233" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="28235" href="/Substitution/#27308" class="Bound">σ</a><a id="28236" class="Symbol">)</a> <a id="28238" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="28240" href="/Substitution/#27302" class="Bound">N</a>
     <a id="28247" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="28250" href="/Substitution/#11543" class="Function">cong-sub</a><a id="28258" class="Symbol">{</a><a id="28259" class="Argument">M</a> <a id="28261" class="Symbol">=</a> <a id="28263" href="/Substitution/#27302" class="Bound">N</a><a id="28264" class="Symbol">}</a> <a id="28266" class="Symbol">(</a><a id="28267" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="28271" href="/Substitution/#9365" class="Function">sub-dist</a><a id="28279" class="Symbol">)</a> <a id="28281" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="28286" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="28295" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="28297" href="/Substitution/#27305" class="Bound">M</a> <a id="28299" href="/Substitution/#3590" class="Function Operator">•</a> <a id="28301" href="/Substitution/#3177" class="Function">ids</a> <a id="28305" href="/Substitution/#3939" class="Function Operator">⨟</a> <a id="28307" href="/Substitution/#27308" class="Bound">σ</a> <a id="28309" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="28311" href="/Substitution/#27302" class="Bound">N</a>
     <a id="28318" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="28321" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="28325" class="Symbol">(</a><a id="28326" href="/Substitution/#23666" class="Function">sub-sub</a><a id="28333" class="Symbol">{</a><a id="28334" class="Argument">M</a> <a id="28336" class="Symbol">=</a> <a id="28338" href="/Substitution/#27302" class="Bound">N</a><a id="28339" class="Symbol">})</a> <a id="28342" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="28351" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="28353" href="/Substitution/#27308" class="Bound">σ</a> <a id="28355" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="28357" class="Symbol">(</a><a id="28358" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="28360" href="/Substitution/#27305" class="Bound">M</a> <a id="28362" href="/Substitution/#3590" class="Function Operator">•</a> <a id="28364" href="/Substitution/#3177" class="Function">ids</a> <a id="28368" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="28370" href="/Substitution/#27302" class="Bound">N</a><a id="28371" class="Symbol">)</a>
     <a id="28378" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="28381" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="28386" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="28388" href="/Substitution/#27308" class="Bound">σ</a> <a id="28390" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="28392" class="Symbol">(</a><a id="28393" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="28397" class="Symbol">(</a><a id="28398" href="/Substitution/#11543" class="Function">cong-sub</a><a id="28406" class="Symbol">{</a><a id="28407" class="Argument">M</a> <a id="28409" class="Symbol">=</a> <a id="28411" href="/Substitution/#27302" class="Bound">N</a><a id="28412" class="Symbol">}</a> <a id="28414" href="/Substitution/#16330" class="Function">subst-Z-cons-ids</a> <a id="28431" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="28435" class="Symbol">))</a> <a id="28438" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="28447" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="28449" href="/Substitution/#27308" class="Bound">σ</a> <a id="28451" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="28453" class="Symbol">(</a><a id="28454" href="/Substitution/#27302" class="Bound">N</a> <a id="28456" href="/Untyped/#7475" class="Function Operator">[</a> <a id="28458" href="/Substitution/#27305" class="Bound">M</a> <a id="28460" href="/Untyped/#7475" class="Function Operator">]</a><a id="28461" class="Symbol">)</a>
     <a id="28468" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>A corollary of <code class="highlighter-rouge">subst-commute</code> is that <code class="highlighter-rouge">rename</code> also commutes with
substitution. In the proof below, we first exchange <code class="highlighter-rouge">rename ρ</code> for
the substitution <code class="highlighter-rouge">⟪ ren ρ ⟫</code>, and apply <code class="highlighter-rouge">subst-commute</code>, and
then convert back to <code class="highlighter-rouge">rename ρ</code>.</p>

<pre class="Agda"><a id="rename-subst-commute"></a><a id="28724" href="/Substitution/#28724" class="Function">rename-subst-commute</a> <a id="28745" class="Symbol">:</a> <a id="28747" class="Symbol">∀{</a><a id="28749" href="/Substitution/#28749" class="Bound">Γ</a> <a id="28751" href="/Substitution/#28751" class="Bound">Δ</a><a id="28752" class="Symbol">}{</a><a id="28754" href="/Substitution/#28754" class="Bound">N</a> <a id="28756" class="Symbol">:</a> <a id="28758" href="/Substitution/#28749" class="Bound">Γ</a> <a id="28760" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="28762" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="28764" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="28766" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="28767" class="Symbol">}{</a><a id="28769" href="/Substitution/#28769" class="Bound">M</a> <a id="28771" class="Symbol">:</a> <a id="28773" href="/Substitution/#28749" class="Bound">Γ</a> <a id="28775" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="28777" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="28778" class="Symbol">}{</a><a id="28780" href="/Substitution/#28780" class="Bound">ρ</a> <a id="28782" class="Symbol">:</a> <a id="28784" href="/Substitution/#2275" class="Function">Rename</a> <a id="28791" href="/Substitution/#28749" class="Bound">Γ</a> <a id="28793" href="/Substitution/#28751" class="Bound">Δ</a> <a id="28795" class="Symbol">}</a>
    <a id="28801" class="Symbol">→</a> <a id="28803" class="Symbol">(</a><a id="28804" href="/Untyped/#6171" class="Function">rename</a> <a id="28811" class="Symbol">(</a><a id="28812" href="/Untyped/#5845" class="Function">ext</a> <a id="28816" href="/Substitution/#28780" class="Bound">ρ</a><a id="28817" class="Symbol">)</a> <a id="28819" href="/Substitution/#28754" class="Bound">N</a><a id="28820" class="Symbol">)</a> <a id="28822" href="/Untyped/#7475" class="Function Operator">[</a> <a id="28824" href="/Untyped/#6171" class="Function">rename</a> <a id="28831" href="/Substitution/#28780" class="Bound">ρ</a> <a id="28833" href="/Substitution/#28769" class="Bound">M</a> <a id="28835" href="/Untyped/#7475" class="Function Operator">]</a> <a id="28837" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="28839" href="/Untyped/#6171" class="Function">rename</a> <a id="28846" href="/Substitution/#28780" class="Bound">ρ</a> <a id="28848" class="Symbol">(</a><a id="28849" href="/Substitution/#28754" class="Bound">N</a> <a id="28851" href="/Untyped/#7475" class="Function Operator">[</a> <a id="28853" href="/Substitution/#28769" class="Bound">M</a> <a id="28855" href="/Untyped/#7475" class="Function Operator">]</a><a id="28856" class="Symbol">)</a>
<a id="28858" href="/Substitution/#28724" class="Function">rename-subst-commute</a> <a id="28879" class="Symbol">{</a><a id="28880" href="/Substitution/#28880" class="Bound">Γ</a><a id="28881" class="Symbol">}{</a><a id="28883" href="/Substitution/#28883" class="Bound">Δ</a><a id="28884" class="Symbol">}{</a><a id="28886" href="/Substitution/#28886" class="Bound">N</a><a id="28887" class="Symbol">}{</a><a id="28889" href="/Substitution/#28889" class="Bound">M</a><a id="28890" class="Symbol">}{</a><a id="28892" href="/Substitution/#28892" class="Bound">ρ</a><a id="28893" class="Symbol">}</a> <a id="28895" class="Symbol">=</a>
     <a id="28902" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="28915" class="Symbol">(</a><a id="28916" href="/Untyped/#6171" class="Function">rename</a> <a id="28923" class="Symbol">(</a><a id="28924" href="/Untyped/#5845" class="Function">ext</a> <a id="28928" href="/Substitution/#28892" class="Bound">ρ</a><a id="28929" class="Symbol">)</a> <a id="28931" href="/Substitution/#28886" class="Bound">N</a><a id="28932" class="Symbol">)</a> <a id="28934" href="/Untyped/#7475" class="Function Operator">[</a> <a id="28936" href="/Untyped/#6171" class="Function">rename</a> <a id="28943" href="/Substitution/#28892" class="Bound">ρ</a> <a id="28945" href="/Substitution/#28889" class="Bound">M</a> <a id="28947" href="/Untyped/#7475" class="Function Operator">]</a>
     <a id="28954" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="28957" href="/Substitution/#11543" class="Function">cong-sub</a> <a id="28966" class="Symbol">(</a><a id="28967" href="/Substitution/#12047" class="Function">cong-sub-zero</a> <a id="28981" class="Symbol">(</a><a id="28982" href="/Substitution/#14105" class="Function">rename-subst-ren</a><a id="28998" class="Symbol">{</a><a id="28999" class="Argument">M</a> <a id="29001" class="Symbol">=</a> <a id="29003" href="/Substitution/#28889" class="Bound">M</a><a id="29004" class="Symbol">}))</a>
                 <a id="29025" class="Symbol">(</a><a id="29026" href="/Substitution/#14105" class="Function">rename-subst-ren</a><a id="29042" class="Symbol">{</a><a id="29043" class="Argument">M</a> <a id="29045" class="Symbol">=</a> <a id="29047" href="/Substitution/#28886" class="Bound">N</a><a id="29048" class="Symbol">})</a> <a id="29051" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="29060" class="Symbol">(</a><a id="29061" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="29063" href="/Substitution/#6693" class="Function">ren</a> <a id="29067" class="Symbol">(</a><a id="29068" href="/Untyped/#5845" class="Function">ext</a> <a id="29072" href="/Substitution/#28892" class="Bound">ρ</a><a id="29073" class="Symbol">)</a> <a id="29075" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="29077" href="/Substitution/#28886" class="Bound">N</a><a id="29078" class="Symbol">)</a> <a id="29080" href="/Untyped/#7475" class="Function Operator">[</a> <a id="29082" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="29084" href="/Substitution/#6693" class="Function">ren</a> <a id="29088" href="/Substitution/#28892" class="Bound">ρ</a> <a id="29090" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="29092" href="/Substitution/#28889" class="Bound">M</a> <a id="29094" href="/Untyped/#7475" class="Function Operator">]</a>
     <a id="29101" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="29104" href="/Substitution/#11543" class="Function">cong-sub</a> <a id="29113" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="29118" class="Symbol">(</a><a id="29119" href="/Substitution/#11543" class="Function">cong-sub</a><a id="29127" class="Symbol">{</a><a id="29128" class="Argument">M</a> <a id="29130" class="Symbol">=</a> <a id="29132" href="/Substitution/#28886" class="Bound">N</a><a id="29133" class="Symbol">}</a> <a id="29135" href="/Substitution/#13720" class="Function">ren-ext</a> <a id="29143" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="29147" class="Symbol">)</a> <a id="29149" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="29158" class="Symbol">(</a><a id="29159" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="29161" href="/Untyped/#6623" class="Function">exts</a> <a id="29166" class="Symbol">(</a><a id="29167" href="/Substitution/#6693" class="Function">ren</a> <a id="29171" href="/Substitution/#28892" class="Bound">ρ</a><a id="29172" class="Symbol">)</a> <a id="29174" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="29176" href="/Substitution/#28886" class="Bound">N</a><a id="29177" class="Symbol">)</a> <a id="29179" href="/Untyped/#7475" class="Function Operator">[</a> <a id="29181" href="/Substitution/#2661" class="Function Operator">⟪</a> <a id="29183" href="/Substitution/#6693" class="Function">ren</a> <a id="29187" href="/Substitution/#28892" class="Bound">ρ</a> <a id="29189" href="/Substitution/#2661" class="Function Operator">⟫</a> <a id="29191" href="/Substitution/#28889" class="Bound">M</a> <a id="29193" href="/Untyped/#7475" class="Function Operator">]</a>
     <a id="29200" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="29203" href="/Substitution/#27167" class="Function">subst-commute</a><a id="29216" class="Symbol">{</a><a id="29217" class="Argument">N</a> <a id="29219" class="Symbol">=</a> <a id="29221" href="/Substitution/#28886" class="Bound">N</a><a id="29222" class="Symbol">}</a> <a id="29224" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="29233" href="/Untyped/#6931" class="Function">subst</a> <a id="29239" class="Symbol">(</a><a id="29240" href="/Substitution/#6693" class="Function">ren</a> <a id="29244" href="/Substitution/#28892" class="Bound">ρ</a><a id="29245" class="Symbol">)</a> <a id="29247" class="Symbol">(</a><a id="29248" href="/Substitution/#28886" class="Bound">N</a> <a id="29250" href="/Untyped/#7475" class="Function Operator">[</a> <a id="29252" href="/Substitution/#28889" class="Bound">M</a> <a id="29254" href="/Untyped/#7475" class="Function Operator">]</a><a id="29255" class="Symbol">)</a>
     <a id="29262" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="29265" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="29269" class="Symbol">(</a><a id="29270" href="/Substitution/#14105" class="Function">rename-subst-ren</a><a id="29286" class="Symbol">)</a> <a id="29288" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="29297" href="/Untyped/#6171" class="Function">rename</a> <a id="29304" href="/Substitution/#28892" class="Bound">ρ</a> <a id="29306" class="Symbol">(</a><a id="29307" href="/Substitution/#28886" class="Bound">N</a> <a id="29309" href="/Untyped/#7475" class="Function Operator">[</a> <a id="29311" href="/Substitution/#28889" class="Bound">M</a> <a id="29313" href="/Untyped/#7475" class="Function Operator">]</a><a id="29314" class="Symbol">)</a>
     <a id="29321" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>To present the substitution lemma, we introduce the following notation
for substituting a term <code class="highlighter-rouge">M</code> for index 1 within term <code class="highlighter-rouge">N</code>.</p>

<pre class="Agda"><a id="_〔_〕"></a><a id="29477" href="/Substitution/#29477" class="Function Operator">_〔_〕</a> <a id="29482" class="Symbol">:</a> <a id="29484" class="Symbol">∀</a> <a id="29486" class="Symbol">{</a><a id="29487" href="/Substitution/#29487" class="Bound">Γ</a> <a id="29489" href="/Substitution/#29489" class="Bound">A</a> <a id="29491" href="/Substitution/#29491" class="Bound">B</a> <a id="29493" href="/Substitution/#29493" class="Bound">C</a><a id="29494" class="Symbol">}</a>
        <a id="29504" class="Symbol">→</a> <a id="29506" href="/Substitution/#29487" class="Bound">Γ</a> <a id="29508" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="29510" href="/Substitution/#29491" class="Bound">B</a> <a id="29512" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="29514" href="/Substitution/#29493" class="Bound">C</a> <a id="29516" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="29518" href="/Substitution/#29489" class="Bound">A</a>
        <a id="29528" class="Symbol">→</a> <a id="29530" href="/Substitution/#29487" class="Bound">Γ</a> <a id="29532" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="29534" href="/Substitution/#29491" class="Bound">B</a>
          <a id="29546" class="Comment">---------</a>
        <a id="29564" class="Symbol">→</a> <a id="29566" href="/Substitution/#29487" class="Bound">Γ</a> <a id="29568" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="29570" href="/Substitution/#29493" class="Bound">C</a> <a id="29572" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="29574" href="/Substitution/#29489" class="Bound">A</a>
<a id="29576" href="/Substitution/#29477" class="Function Operator">_〔_〕</a> <a id="29581" class="Symbol">{</a><a id="29582" href="/Substitution/#29582" class="Bound">Γ</a><a id="29583" class="Symbol">}</a> <a id="29585" class="Symbol">{</a><a id="29586" href="/Substitution/#29586" class="Bound">A</a><a id="29587" class="Symbol">}</a> <a id="29589" class="Symbol">{</a><a id="29590" href="/Substitution/#29590" class="Bound">B</a><a id="29591" class="Symbol">}</a> <a id="29593" class="Symbol">{</a><a id="29594" href="/Substitution/#29594" class="Bound">C</a><a id="29595" class="Symbol">}</a> <a id="29597" href="/Substitution/#29597" class="Bound">N</a> <a id="29599" href="/Substitution/#29599" class="Bound">M</a> <a id="29601" class="Symbol">=</a>
   <a id="29606" href="/Untyped/#6931" class="Function">subst</a> <a id="29612" class="Symbol">{</a><a id="29613" href="/Substitution/#29582" class="Bound">Γ</a> <a id="29615" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="29617" href="/Substitution/#29590" class="Bound">B</a> <a id="29619" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="29621" href="/Substitution/#29594" class="Bound">C</a><a id="29622" class="Symbol">}</a> <a id="29624" class="Symbol">{</a><a id="29625" href="/Substitution/#29582" class="Bound">Γ</a> <a id="29627" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="29629" href="/Substitution/#29594" class="Bound">C</a><a id="29630" class="Symbol">}</a> <a id="29632" class="Symbol">(</a><a id="29633" href="/Untyped/#6623" class="Function">exts</a> <a id="29638" class="Symbol">(</a><a id="29639" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="29650" href="/Substitution/#29599" class="Bound">M</a><a id="29651" class="Symbol">))</a> <a id="29654" class="Symbol">{</a><a id="29655" href="/Substitution/#29586" class="Bound">A</a><a id="29656" class="Symbol">}</a> <a id="29658" href="/Substitution/#29597" class="Bound">N</a></pre>

<p>The substitution lemma is stated as follows and proved as a corollary
of the <code class="highlighter-rouge">subst-commute</code> lemma.</p>

<pre class="Agda"><a id="substitution"></a><a id="29786" href="/Substitution/#29786" class="Function">substitution</a> <a id="29799" class="Symbol">:</a> <a id="29801" class="Symbol">∀{</a><a id="29803" href="/Substitution/#29803" class="Bound">Γ</a><a id="29804" class="Symbol">}{</a><a id="29806" href="/Substitution/#29806" class="Bound">M</a> <a id="29808" class="Symbol">:</a> <a id="29810" href="/Substitution/#29803" class="Bound">Γ</a> <a id="29812" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="29814" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="29816" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="29818" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="29820" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="29822" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="29823" class="Symbol">}{</a><a id="29825" href="/Substitution/#29825" class="Bound">N</a> <a id="29827" class="Symbol">:</a> <a id="29829" href="/Substitution/#29803" class="Bound">Γ</a> <a id="29831" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="29833" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="29835" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="29837" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="29838" class="Symbol">}{</a><a id="29840" href="/Substitution/#29840" class="Bound">L</a> <a id="29842" class="Symbol">:</a> <a id="29844" href="/Substitution/#29803" class="Bound">Γ</a> <a id="29846" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="29848" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="29849" class="Symbol">}</a>
    <a id="29855" class="Symbol">→</a> <a id="29857" class="Symbol">(</a><a id="29858" href="/Substitution/#29806" class="Bound">M</a> <a id="29860" href="/Untyped/#7475" class="Function Operator">[</a> <a id="29862" href="/Substitution/#29825" class="Bound">N</a> <a id="29864" href="/Untyped/#7475" class="Function Operator">]</a><a id="29865" class="Symbol">)</a> <a id="29867" href="/Untyped/#7475" class="Function Operator">[</a> <a id="29869" href="/Substitution/#29840" class="Bound">L</a> <a id="29871" href="/Untyped/#7475" class="Function Operator">]</a> <a id="29873" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="29875" class="Symbol">(</a><a id="29876" href="/Substitution/#29806" class="Bound">M</a> <a id="29878" href="/Substitution/#29477" class="Function Operator">〔</a> <a id="29880" href="/Substitution/#29840" class="Bound">L</a> <a id="29882" href="/Substitution/#29477" class="Function Operator">〕</a><a id="29883" class="Symbol">)</a> <a id="29885" href="/Untyped/#7475" class="Function Operator">[</a> <a id="29887" class="Symbol">(</a><a id="29888" href="/Substitution/#29825" class="Bound">N</a> <a id="29890" href="/Untyped/#7475" class="Function Operator">[</a> <a id="29892" href="/Substitution/#29840" class="Bound">L</a> <a id="29894" href="/Untyped/#7475" class="Function Operator">]</a><a id="29895" class="Symbol">)</a> <a id="29897" href="/Untyped/#7475" class="Function Operator">]</a>
<a id="29899" href="/Substitution/#29786" class="Function">substitution</a><a id="29911" class="Symbol">{</a><a id="29912" class="Argument">M</a> <a id="29914" class="Symbol">=</a> <a id="29916" href="/Substitution/#29916" class="Bound">M</a><a id="29917" class="Symbol">}{</a><a id="29919" class="Argument">N</a> <a id="29921" class="Symbol">=</a> <a id="29923" href="/Substitution/#29923" class="Bound">N</a><a id="29924" class="Symbol">}{</a><a id="29926" class="Argument">L</a> <a id="29928" class="Symbol">=</a> <a id="29930" href="/Substitution/#29930" class="Bound">L</a><a id="29931" class="Symbol">}</a> <a id="29933" class="Symbol">=</a>
   <a id="29938" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="29942" class="Symbol">(</a><a id="29943" href="/Substitution/#27167" class="Function">subst-commute</a><a id="29956" class="Symbol">{</a><a id="29957" class="Argument">N</a> <a id="29959" class="Symbol">=</a> <a id="29961" href="/Substitution/#29916" class="Bound">M</a><a id="29962" class="Symbol">}{</a><a id="29964" class="Argument">M</a> <a id="29966" class="Symbol">=</a> <a id="29968" href="/Substitution/#29923" class="Bound">N</a><a id="29969" class="Symbol">}{</a><a id="29971" class="Argument">σ</a> <a id="29973" class="Symbol">=</a> <a id="29975" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="29986" href="/Substitution/#29930" class="Bound">L</a><a id="29987" class="Symbol">})</a></pre>

<h2 id="notes">Notes</h2>

<p>Most of the properties and proofs in this file are based on the paper
<em>Autosubst: Reasoning with de Bruijn Terms and Parallel Substitution</em>
by Schafer, Tebbi, and Smolka (ITP 2015). That paper, in turn, is
based on the paper of Abadi, Cardelli, Curien, and Levy (1991) that
defines the σ algebra.</p>

<h2 id="unicode">Unicode</h2>

<p>This chapter uses the following unicode:
    ⟪  U+27EA  MATHEMATICAL LEFT DOUBLE ANGLE BRACKET (&lt;&lt;)
    ⟫  U+27EA  MATHEMATICAL RIGHT DOUBLE ANGLE BRACKET (&gt;&gt;)
    ↑  U+2191  UPWARDS ARROW (\u)
    •  U+2022  BULLET (\bub)
    ⨟  U+2A1F  Z NOTATION SCHEMA COMPOSITION (C-x 8 RET Z NOTATION SCHEMA COMPOSITION)
    〔  U+3014  LEFT TORTOISE SHELL BRACKET (( option 9 on page 2)
    〕  U+3015  RIGHT TORTOISE SHELL BRACKET () option 9 on page 2)</p>


  </div>

  <p style="text-align:center;">
    
    <a alt="Previous chapter" href="/Untyped/">Prev</a>
    &bullet;
    
    
    <a alt="Source code" href="https://github.com/plfa/plfa.github.io/blob/dev/src/plfa/Substitution.lagda">Source</a>
    
    
    &bullet;
    <a alt="Next chapter" href="/LambdaReduction/">Next</a>
    
</p>


</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Programming Language Foundations in Agda
</h2><div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Philip Wadler</li>
          <li><a class="u-email" href="mailto:wadler@inf.ed.ac.uk">wadler@inf.ed.ac.uk</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wadler"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wadler</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3"></div>
    </div><div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Wen Kokke</li>
          <li><a class="u-email" href="mailto:wen.kokke@ed.ac.uk">wen.kokke@ed.ac.uk</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wenkokke"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wenkokke</span></a></li><li><a href="https://www.twitter.com/wenkokke"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">wenkokke</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3"></div>
    </div>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
  </div>
</footer>
<!-- Import jQuery -->
<script type="text/javascript" src="/assets/jquery.js"></script>

<!-- Script which allows for foldable code blocks -->
<script type="text/javascript">
 $('div.foldable pre').each(function(){
     var autoHeight = $(this).height();
     var lineHeight = parseFloat($(this).css('line-height'));

     var plus    = $("<div></div>");
     var horLine = $("<div></div>");
     var verLine = $("<div></div>");
     $(this).prepend(plus);
     plus.css({
         'position'         : 'relative',
         'float'            : 'right',
         'right'            : '-' + (0.5 * lineHeight - 1.5) + 'px',
         'width'            : lineHeight,
         'height'           : lineHeight});
     verLine.css({
         'position'         : 'relative',
         'height'           : lineHeight,
         'width'            : '3px',
         'background-color' : '#C1E0FF'});
     horLine.css({
         'position'         : 'relative',
         'top'              : '-' + (0.5 * lineHeight + 1.5) + 'px',
         'left'             : '-' + (0.5 * lineHeight - 1.5) + 'px',
         'height'           : '3px',
         'width'            : lineHeight,
         'background-color' : '#C1E0FF'});
     plus.append(verLine);
     plus.append(horLine);

     $(this).height(2.0 * lineHeight);
     $(this).css('overflow','hidden');

     $(this).click(function(){
         if ($(this).height() == autoHeight) {
             $(this).height(2.0 * lineHeight);
             plus.show();
         }
         else {
             $(this).height('auto');
             plus.hide();
         }
     });
 });
</script>

<!-- Import KaTeX -->
<script type="text/javascript" src="/assets/katex.js"></script>

<!-- Script which renders TeX using KaTeX -->
<script type="text/javascript">
 $("script[type='math/tex']").replaceWith(
     function(){
         var tex = $(this).text();
         return "<span class=\"inline-equation\">" +
                katex.renderToString(tex) +
                "</span>";
     });
 $("script[type='math/tex; mode=display']").replaceWith(
     function(){
         var tex = $(this).text().replace(/%.*?(\n|$)/g,"");
         return "<div class=\"equation\">" +
                katex.renderToString("\\displaystyle "+tex) +
                "</div>";
     });
</script>
</body>

</html>
